{"version":3,"sources":["css/pairings.module.css","css/fullscreen.module.css","css/components.module.css","css/profile.module.css","assets/icons/watch.svg","assets/icons/twitch.svg","assets/icons/youtube.svg","assets/icons/chessCom.svg","assets/icons/lichess.svg","assets/icons/ecf.svg","assets/icons/fide.svg","assets/icons/zoom.svg","css/nav.module.css","css/home.module.css","css/streams.module.css","css/results.module.css","pages/css/community.module.css","css/chesscom.module.css","css/header.module.css","css/crosstable.module.css","user/css/user.module.css","css/stats.module.css","utils/cookies.ts","utils/regexes.ts","utils/auth.ts","utils/requests.ts","utils/prototype.ts","components/Switcher.tsx","models/Player.ts","tournament/Standings/Players.tsx","resources/columns.tsx","resources/tiebreaks.ts","Contexts.ts","tournament/Standings/index.tsx","components/FullScreen.tsx","tournament/Stats.tsx","404.tsx","components/react-pgn-viewer/constants.js","components/react-pgn-viewer/BoardHeader.js","components/react-pgn-viewer/Footer/Download.js","components/react-pgn-viewer/Footer/PreviousMove.js","components/react-pgn-viewer/Footer/NextMove.js","components/react-pgn-viewer/Footer/LastMove.js","components/react-pgn-viewer/Footer/Reset.js","components/react-pgn-viewer/Footer/Flip.js","components/react-pgn-viewer/Footer/Play.js","components/react-pgn-viewer/Footer/BoardFooter.js","components/react-pgn-viewer/Moves/Move.js","components/react-pgn-viewer/Moves/MoveList.js","components/react-pgn-viewer/baseStyles.js","components/react-pgn-viewer/helpers.js","components/react-pgn-viewer/Viewer.js","components/react-pgn-viewer/index.js","utils/hooks.ts","chess/ChessCom.tsx","components/AutoComplete.tsx","tournament/PieChart.tsx","models/Match.ts","tournament/Pairings.tsx","tournament/Streams.tsx","components/DraggableSticky.tsx","components/Image.tsx","tournament/Results.tsx","Tournament.tsx","utils/plugins.tsx","resources/contact.tsx","components/NotifBox.tsx","Home.tsx","pages/Community.tsx","components/Header.tsx","tournament/Login.tsx","components/SectionBreak.tsx","resources/settings.ts","user/hooks.tsx","user/Tournaments.tsx","user/callbacks/ChessCom.tsx","user/Info.tsx","user/Verify.tsx","user/User.tsx","user/Teams.tsx","user/Play.tsx","user/Team.tsx","components/ToggleSwitch.tsx","user/callbacks/Lichess.tsx","user/callbacks/Facebook.tsx","user/Accounts.tsx","user/Settings.tsx","App.tsx","serviceWorker.ts","index.tsx","user/css/tournaments.module.css","css/login.module.css"],"names":["module","exports","windowCookies","universalCookies","Cookies","c","getAll","Promise","resolve","name","get","value","options","path","maxAge","set","remove","chessCom","dark","streamLink","link","lowerCase","mobile","username","isMobile","str","navigator","userAgent","vendor","regexes","test","substr","errorCallback","console","log","process","server","prodServer","lichess","config","prodDomain","lichessCallback","axios","defaults","baseURL","cookies","GET","Object","assign","method","then","res","data","catch","e","error","POST","headers","response","status","statusText","url","split","pop","FORM","preventDefault","persist","form","target","constructor","parentElement","Error","Array","from","reduce","acc","curr","type","Number","action","interceptors","request","use","a","JSON","stringify","Authorization","socket","io","reconnection","reconnectionDelay","reconnectionDelayMax","reconnectionAttempts","capitalise","slice","toUpperCase","toLowerCase","compare","_myName","_pulledName","myName","trim","pulledName","length","startsWith","endsWith","leven","UserSwitcher","props","className","styles","modeSwitcher","classNames","switcher","join","entries","sections","map","i","k","s","hide","loaded","to","key","section","icon","ModeSwitcher","loggedIn","useContext","LoginContext","useState","shouldRedirect","redirectTo","handleJoin","useCallback","all","round","id","settings","streamURL","src","watch","alt","allowRegistration","onClick","RoundSwitcher","roundTimes","setRoundTimes","fetchRoundTimes","useEffect","rounds","totalRounds","Infinity","date","Date","toString","push","pairingRound","roundSelected","nullRound","substring","active","templateD","score","gamePoints","played","gamesPlayed","gameDifference","expectedScore","expectedGameScore","whiteTotal","wins","draws","losses","matchPercentage","gamePercentage","ratingDifference","Player","m","tournamentId","firstName","lastName","rating","nationality","isPlaying","performanceRating","histories","bonuses","clashList","contact","meta","teamId","createdAt","updatedAt","_netGamePoint","_progressiveScore","_oppRatingSum","proxied","keys","prop","includes","defineProperty","this","compute","filter","b","d","h","match","lossReward","drawReward","winReward","game","expected","colour","MP","GP","configurable","scores","undefined","some","competitors","matchPoints","forEach","prog","sum","oppRating","def","usePlayers","hasLoaded","load","setBonuses","reducePlayers","state","players","p","PlayerData","setRound","index","findIndex","useReducer","updatePlayers","updateBonuses","finally","columns","pre","rank","sort","postConvert","v","convert","flags","replace","show","showRatings","roundColumn","w","vanityURL","bonus","output","nb","parseFloat","parseInt","aN","bN","post","Math","floor","toFixed","brief","entry","expectedDifference","TieBreaks","h2h","func","scoreAgainst","gamePoint","gamePointDiff","netGamePoint","whites","progScore","progressiveScore","gameh2h","gameScoreAgainst","perfRating","oppRatingSum","aHistories","bHistories","aSorted","x","y","bSorted","shift","aNext","bNext","aAv","bAv","alphabetical","TiebreakContext","createContext","DisplayNameContext","NotifContext","AlertContext","Standings","useMemo","roundHeaders","setSortHeader","sortBy","tiebreaks","renderRows","rowsData","pres","_rounds","j","rowData","sortFunc","sortMeta","sortCol","indexOf","allTb","useTb","tr","display","cell","headerCell","direction","table","scope","th","colSpan","footer","FullScreen","full","setF","fullScreen","setFullScreen","fullScreenChart","createRef","onClose","container","ref","fullScreenHeader","title","document","fullscreenElement","current","requestFullscreen","exitFullscreen","role","viewBox","stage","children","Chart","size","setSize","gamePointTotal","labels","setLabels","_labels","player","row","detailed","setDetailed","highPerf","setPerf","order","rotated","ids","ranks","setKey","setOrder","lastColumn","setLastColumn","defGraph","setGraph","GraphOptions","pairingStyles","OrderOptions","tooltipFnc","orderedChart","ranked","half","ceil","diff","arrow","abs","tooltip","ChartistMain","plugins","ctAxisTitle","series","fullWidth","divisor","axisY","offset","onlyInteger","labelInterpolationFnc","width","window","innerWidth","height","innerHeight","axisX","axisTitle","axisClass","textAnchor","css","min","max","text","charCodeAt","random","String","fromCharCode","repeat","description","ReactSlider","slider","thumbClassName","thumb","trackClassName","track","step","disabled","onChange","n","renderThumb","valueNow","checked","style","visibility","gridTemplateRows","left","fontSize","marginTop","fsChart","header","subtitle","NotFound","flexDirection","alignItems","alignSelf","href","rel","months","BoardHeader","headerInfo","Link","whiteName","White","blackName","Black","whiteTeam","WhiteTeam","blackTeam","BlackTeam","blackElo","BlackElo","whiteElo","WhiteElo","Round","Game","result","Result","event","Event","site","Site","textDate","eventInfo","gameInfo","nameStyles","fontWeight","marginBottom","detailStyles","padding","React","Component","Download","_handleDownload","onDownload","iconStyles","PreviousMove","_handlePreviousMove","onPreviousMove","NextMove","_handleNextMove","onNextMove","LastMove","_handleLastMove","onLastMove","Reset","_handleReset","onReset","Flip","_handleFlipBoard","onFlipBoard","flipIconStyles","parse","Play","_handlePlay","onPlay","BoardFooter","fenMove","footerStyles","cursor","justifyContent","paddingTop","paddingBottom","paddingLeft","Move","_handleChangeMove","onChangeMove","moveIndex","move","currentIndex","isWhiteMove","whiteMoveNumber","moveStyles","color","MoveList","moveList","prevProps","moves","prevMoves","scrollTop","scrollHeight","startAtMove","endAtMove","baseStyles","base","wrapper","background","setStyle","stylesToModify","styleClone","area","stylePair","Viewer","_updateDimensions","setState","windowWidth","_makeIncreasingMoves","numberOfMoves","reset","chess","undo","moveDifference","orientation","element","createElement","fileContent","fen","pgnInformation","fileFormat","file","Blob","whiteLastName","blackLastName","URL","createObjectURL","download","click","isLoaded","Chess","pgnString","pgnArray","line","load_pgn","headerArr","history","StartAtMove","EndAtMove","Fen","fenMoveNumber","startAtLatest","addEventListener","timeoutID","setTimeout","clearTimeout","removeEventListener","blackSquareColor","whiteSquareColor","defaultWidth","backgroundColor","showCoordinates","params","isScreenMobile","wrapperStyles","getBaseStyles","activeSquare","getActiveSquare","onWheel","stopPropagation","blackSquareColour","border","whiteSquareColour","PgnViewer","makeViewer","createInnerHtml","__html","additionalHTMLModification","nodeToModify","nodeModification","nodes","ReactDOM","findDOMNode","querySelectorAll","setPgn","pgns","render","innerHTML","dangerouslySetInnerHTML","defaultProps","useMemoWithLabel","factory","deps","useDebugValue","ChessWebAPI","queue","getChessComProfile","rej","dispatch","getPlayer","body","getChessComTeam","getClub","loadChessComGames","board","getTeamLiveMatchBoard","loadChessComMatch","getTeamLiveMatch","ChessCom","boards","setBoards","enforceBoards","arr","boardScores","games","setGame","setID","teamDict","dict","teams","t","matchFinished","isFinished","boardsFinished","setFinished","gamesLength","setGamesLength","fetchMatch","matches","teamID","values","reverse","start_time","now","setMatch","bodyStatus","startTime","endTime","end_time","reject","Teams","bTeams","find","registrationTime","valueOf","metaStatus","aborted","expanded","loadData","ping","fetchedGames","board_scores","lastGame","sendGameData","bcrypt","hash","pgn","idW","idB","fetched","isConfirmed","setInterval","clearInterval","summaryRows","white","black","opp","focused","setFocused","gridTemplateColumns","results","g","pairing","GameViewer","loading","currIndex","setIndex","gameRef","useRef","rendered","SingleGame","_scores","dispatchEvent","buttons","div","handleKeyPress","ev","deltaY","button","keyCode","scrollIntoView","behavior","handleClick","boardLabel","pan","null","r","gameViewWrapper","flip","AutoComplete","firstInput","currChoice","setCurrChoice","focus","handleSubmit","onSubmit","handleKeyDown","handleInput","nativeEvent","input","choices","firstChoice","autofill","select","setSelectionRange","scoreSection","required","placeholder","onInput","onKeyDown","autoComplete","pending","scheduled","registered","live","finished","confirmed","PercentageCompleted","percentages","totals","total","myChart","donut","donutSolid","donutWidth","startAngle","ignoreEmptyValues","showLabel","labelPosition","listener","draw","pathLength","_node","getTotalLength","animationDefinition","dur","easing","Svg","Easing","easeOutQuint","fill","begin","attr","animate","Match","linkSource","linkType","scored","debugStatus","isLive","isRegistered","Pairings","pairings","setPairings","list","splice","decodeURIComponent","location","setExpanded","hasFetched","matchDict","setChoices","csv","setCSV","populatematchDict","playerDict","linkKey","clearQueue","getDisplayName","chooseMatch","found","every","rows","_csv","displayTime","Row","hidden","scrolled","setScrolled","elem","getElementById","handleDownload","tourName","CompletedChart","subheader","searchBar","hasExpanded","cache","flag","inner","whiteSpace","isScheduled","watchLive","pushState","pathname","search","icons","TV","popped","domain","channel","component","twitchPlayer","autoplay","handlePop","streamHeader","streamContainer","twitchChat","chat","youtubePlayer","frameBorder","allow","allowFullScreen","youtubeChat","Draggable","bottom","right","draggable","Img","viewerIsOpen","setViewerIsOpen","views","source","Results","Description","fireworksSection","resultsScreen","place","position","teamName","standingsButton","Tournament","obj","setLoaded","setSettings","setStatus","rawPlayers","setPlayers","poppedComponent","Map","concat","bye","showScroll","toggleScroll","updateScroll","scrollY","floatContainer","setFloat","tieBreaks","getDisplayname","profilePicture","preload","logoURL","defaultProfilePicture","nameContainer","linkButtons","profileURL","website","rulesURL","rules","user","infoBox","pairingSystem","tieBreakLink","prizes","timeControl","rProps","isNaN","tieBreakSection","tieBreakContainer","visible","tieBreakTitle","exact","Provider","setDisplayPlayer","margin","scrollTo","outerHTML","processNodeDefinitions","HtmlToReact","ProcessNodeDefinitions","parseHtml","htmlParser","isValidNode","node","processingInstructions","shouldProcessNode","processNode","processDefaultNode","RouterLink","contactFields","authMessage","canLink","idLink","zoom","skype","facebook","phone","email","permanent","getLogo","brand","AlertBox","setAlert","setMessage","message","toggleError","prompt","allowNull","validate","shade","lightBoxTitle","iconLink","lightBoxContent","spellCheck","autoFocus","defaultValue","errorMessage","dateTime","NotifBox","notif","content","escapeHtml","astPlugins","renderers","connected","Home","tournaments","setTournaments","notifications","setNotifications","updateTournaments","updateNotifications","on","count","announcements","tableAnnounce","sectionHeader","notificationRow","notifContent","expando","sizer","tourn","dateStarted","rowLink","tournamentLink","disconnected","new","Community","users","setUsers","updateUsers","setTeams","updateTeams","userTable","u","isLicensed","profile","Header","pathDict","mobileMenu","setMenu","setDisplay","showNotifs","toggleNotifs","selected","currentPath","mobileIgnore","native","checkIfFullScreen","screen","checkKeyPress","setHeight","updateHeight","logoWrapper","logo","menuButton","buttonContainer","headerButton","opacity","top","maxHeight","Crown","staticLogo","Login","mode","setMode","triggerError","setSession","login","sessionID","ForgottenContainer","forgottenContainer","forgotten","PasswordForm","setName","code","sid","password","passwordRepeat","submit","resetForm","back","reminderForm","loginForm","registerForm","minLength","requestSubmit","crownBuild","loginSection","initialiseButton","loginButton","foreground","registerForeground","loginForeground","registerButton","column","frame","messageBar","SectionBreak","toggle","divRef","nextElementSibling","overflow","transition","removeAttribute","divide","collapsed","booleanConvert","defaultSettings","enum","level","pullResults","highlight","allowSelfLinks","lockOnInit","allowSelfSubmissions","locked","onInit","fetchNames","sorted","promises","names","renderTournament","playerNames","tournament","setting","shouldFetch","last","next","box","currRound","nextRound","showGame","displayPoints","resultsRow","small","playerName","fieldBox","renderTeam","teamStage","RenderMatch","isAuthed","update","swap","l","handleAdd","W","B","userStyles","upcomingBattle","reversed","gridArea","vs","clickButton","Tournaments","managed","setManaged","updateManaged","inactive","setPlayerNames","setFetch","activeTournaments","inactiveTournaments","public","useLink","handleHref","country","updateProfile","setWindow","useClub","setFetched","useVerify","chessComToken","setChessComToken","getChessComToken","verified","Info","notes","Notes","fetchClub","chessComClub","getName","isLoggedIn","fields","emailMeta","createTrigger","handleCreate","someAuth","auth","userF","canAuth","admin","account","cloneElement","redirect","setRedirect","close","info","details","claim","countries","founder","endSession","logout","members","accounts","Verify","setVerified","User","setProfile","uniqueID","Accounts","Members","admins","setAdmins","setMembers","team","addUser","upcoming","setUpcoming","past","setPast","populateGames","opponents","opps","currGame","Team","setPlayer","permissions","ToggleSwitch","main","off","sub","onSwitch","response_type","client_id","redirect_uri","win","handleClose","myWin","closed","handleSync","useFacebook","userID","accessToken","setAccounts","updateAccount","setPending","available","setAvailable","linkLichess","callbacks","linkChessCom","linkFacebook","links","verifyChessCom","verify","force","sync","accountSection","optionsContainer","inline","newState","accountButton","pendingContainer","sent","availableContainer","renderProps","open","appId","cssClass","facebookLink","callback","toggleTheme","theme","updateBackground","backgroundURL","darkMode","lastTime","slide","handleEnter","referrer","findPageIndex","emit","time","_from","_to","nFrom","nTo","App","session","root","backgroundImage","timeout","checkSession","alertProps","basename","Boolean","hostname","StrictMode","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.f633bcde.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"score\":\"pairings_score__1_XJ4\",\"confirmed\":\"pairings_confirmed__1Bc3F\",\"finished\":\"pairings_finished__2hyLH\",\"live\":\"pairings_live__2HfIn\",\"watchLive\":\"pairings_watchLive__2-X0p\",\"registered\":\"pairings_registered__u3Dxj\",\"scheduled\":\"pairings_scheduled__3O0RX\",\"pending\":\"pairings_pending__dZRvQ\",\"aborted\":\"pairings_aborted__dGBv3\",\"pairingRound\":\"pairings_pairingRound__2yWvy\",\"roundSelected\":\"pairings_roundSelected__2-WH_\",\"nullRound\":\"pairings_nullRound__x4Kar\",\"inner\":\"pairings_inner__26iQp\",\"subheader\":\"pairings_subheader__3LMDi\",\"searchBar\":\"pairings_searchBar__AlIJB\",\"description\":\"pairings_description__8aoIW\",\"buttonList\":\"pairings_buttonList__3EBcp\",\"modeSwitcher\":\"pairings_modeSwitcher__2mDrw\",\"flag\":\"pairings_flag__1bKPy\",\"join\":\"pairings_join__3TvOD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"fullscreen_container__2o3cX\",\"fullScreenHeader\":\"fullscreen_fullScreenHeader__8hyCZ\",\"stage\":\"fullscreen_stage__2cH6J\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"draggable\":\"components_draggable__6I6m8\",\"move-to-corner\":\"components_move-to-corner__2IMAP\",\"shade\":\"components_shade__3PndK\",\"section\":\"components_section__2oPYC\",\"vertical-split\":\"components_vertical-split__17qtW\",\"lightBoxContent\":\"components_lightBoxContent__1phCW\",\"lightBoxTitle\":\"components_lightBoxTitle__b48fv\",\"error\":\"components_error__3Plio\",\"dateTime\":\"components_dateTime__2VtC6\",\"footer\":\"components_footer__27uos\",\"resolve\":\"components_resolve__1X_KN\",\"reject\":\"components_reject__3ymMO\",\"divide\":\"components_divide__37rpK\",\"collapsed\":\"components_collapsed__1YIKM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"profile_container__1K7NH\",\"title\":\"profile_title__2BZxm\",\"grid\":\"profile_grid__3AVqG\",\"details\":\"profile_details__T2CsB\",\"flag\":\"profile_flag__3RCpw\",\"info\":\"profile_info__3FtOw\",\"contact\":\"profile_contact__3SQSq\",\"notes\":\"profile_notes__1GtWG\",\"background\":\"profile_background__2pk8i\",\"stage\":\"profile_stage__2kP0B\",\"teamStage\":\"profile_teamStage__2cDka\",\"box\":\"profile_box__2QL9b\",\"name\":\"profile_name__bRkcf\",\"history\":\"profile_history__22CVZ\",\"resultsRow\":\"profile_resultsRow__4zleX\",\"small\":\"profile_small__10h6z\",\"fieldBox\":\"profile_fieldBox__1gEdr\",\"subtitle\":\"profile_subtitle__2fxvS\",\"scores\":\"profile_scores__ByD8u\",\"row\":\"profile_row__aUfgI\",\"key\":\"profile_key__mRxor\",\"value\":\"profile_value__vcPiH\",\"currRound\":\"profile_currRound__3lnGQ\",\"nextRound\":\"profile_nextRound__1PoJ-\",\"action\":\"profile_action__2ARI5\"};","module.exports = __webpack_public_path__ + \"static/media/watch.ddf443c3.svg\";","module.exports = __webpack_public_path__ + \"static/media/twitch.e1f7813a.svg\";","module.exports = __webpack_public_path__ + \"static/media/youtube.46bc6904.svg\";","module.exports = __webpack_public_path__ + \"static/media/chessCom.228db28e.svg\";","module.exports = __webpack_public_path__ + \"static/media/lichess.9ff6e305.svg\";","module.exports = __webpack_public_path__ + \"static/media/ecf.68e0df94.svg\";","module.exports = __webpack_public_path__ + \"static/media/fide.03cb669d.svg\";","module.exports = __webpack_public_path__ + \"static/media/zoom.83081771.svg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"stage\":\"nav_stage__3GKOi\",\"profilePicture\":\"nav_profilePicture__PVvqr\",\"nameContainer\":\"nav_nameContainer__17v30\",\"name\":\"nav_name__1A6FS\",\"infoBox\":\"nav_infoBox__22EbU\",\"preload\":\"nav_preload__vbtMr\",\"buttonContainer\":\"nav_buttonContainer__2BU-r\",\"linkButtons\":\"nav_linkButtons__2ee5L\",\"website\":\"nav_website__3Z3po\",\"rules\":\"nav_rules__3Fitx\",\"defaultProfilePicture\":\"nav_defaultProfilePicture__3cROn\",\"tieBreakLink\":\"nav_tieBreakLink__1UyPD\",\"tieBreakSection\":\"nav_tieBreakSection__2Qbwx\",\"tieBreakContainer\":\"nav_tieBreakContainer__2hPD_\",\"visible\":\"nav_visible__1OKR0\",\"tieBreakTitle\":\"nav_tieBreakTitle__1guQ_\",\"tieBreaks\":\"nav_tieBreaks__qpKIN\",\"slide-in-from-left\":\"nav_slide-in-from-left__1m3c0\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"home_container__1NmmU\",\"section\":\"home_section__1f6qq\",\"title\":\"home_title__3SdOf\",\"announcements\":\"home_announcements__1DjwT\",\"tableAnnounce\":\"home_tableAnnounce__1Bh-O\",\"yourTournaments\":\"home_yourTournaments__2Ry_N\",\"tournaments\":\"home_tournaments__XV3YO\",\"sectionHeader\":\"home_sectionHeader__XNvqo\",\"sizer\":\"home_sizer__Q6S_m\",\"notificationRow\":\"home_notificationRow__3ZqbH\",\"expando\":\"home_expando__29AuU\",\"rowLink\":\"home_rowLink__9zHr3\",\"tournamentLink\":\"home_tournamentLink__1rYhD\",\"iconLink\":\"home_iconLink__3HiPn\",\"connected\":\"home_connected__1iSK_\",\"disconnected\":\"home_disconnected__25W62\",\"logout\":\"home_logout__2vhB9\",\"info\":\"home_info__jK8rT\",\"buttons\":\"home_buttons__3Gmmv\",\"row\":\"home_row__2ymjS\",\"details\":\"home_details__1HR57\",\"account\":\"home_account__sYL1z\",\"sync\":\"home_sync__3VLPl\",\"new\":\"home_new__wObsO\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"streams_container__3OSGu\",\"streamHeader\":\"streams_streamHeader__2u9wC\",\"streamContainer\":\"streams_streamContainer__28Cw5\",\"player\":\"streams_player__1u4zp\",\"twitchChat\":\"streams_twitchChat__2j9X5\",\"move-to-corner\":\"streams_move-to-corner__1zn6f\",\"chat\":\"streams_chat__3ysIe\",\"footer\":\"streams_footer__NYfmO\",\"twitchPlayer\":\"streams_twitchPlayer__ZwLdZ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"fireworksSection\":\"results_fireworksSection__2qvrE\",\"resultsScreen\":\"results_resultsScreen__KIKHg\",\"place\":\"results_place__3ZhVh\",\"position\":\"results_position__3Onk_\",\"teamName\":\"results_teamName__2Pxe5\",\"table\":\"results_table__1keWa\",\"key\":\"results_key__3XFuQ\",\"standingsButton\":\"results_standingsButton__36hZx\",\"value\":\"results_value__3Qasx\",\"flag\":\"results_flag__2-WYI\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"community_container__2qOrW\",\"userTable\":\"community_userTable__NudmB\",\"status\":\"community_status__3r8a4\",\"profile\":\"community_profile__3bNmQ\",\"title\":\"community_title__26thm\",\"searchBar\":\"community_searchBar__3vw3G\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"chesscom_container__AGg5n\",\"results\":\"chesscom_results__xtTqO\",\"score\":\"chesscom_score__wGavR\",\"wrapper\":\"chesscom_wrapper__3vwwR\",\"boardlabel\":\"chesscom_boardlabel__E2EmQ\",\"boardLabel\":\"chesscom_boardLabel__1N2Qy\",\"gameViewWrapper\":\"chesscom_gameViewWrapper__T9V4M\",\"board\":\"chesscom_board__3LGEQ\",\"fade-in\":\"chesscom_fade-in__15-gn\",\"row\":\"chesscom_row__17flm\",\"square\":\"chesscom_square___JdY5\",\"W\":\"chesscom_W__1Kbfl\",\"B\":\"chesscom_B__misXA\",\"null\":\"chesscom_null__13qcL\",\"active\":\"chesscom_active__1tUDT\",\"loading\":\"chesscom_loading__2Ayrk\",\"spin\":\"chesscom_spin__1lrfp\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"header_header__3AnVH\",\"buttonContainer\":\"header_buttonContainer__2NGSo\",\"button\":\"header_button__3Dvcf\",\"nameWrapper\":\"header_nameWrapper__3xkIw\",\"logoWrapper\":\"header_logoWrapper__1SDiB\",\"headerButton\":\"header_headerButton__nbL-0\",\"selected\":\"header_selected__3ZcvA\",\"installer\":\"header_installer__3SXUE\",\"icons\":\"header_icons__2zG98\",\"native\":\"header_native__2zjQ6\",\"notifications\":\"header_notifications__27OsP\",\"mobileMenu\":\"header_mobileMenu__1JasY\",\"menuButton\":\"header_menuButton__1iKql\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"th\":\"crosstable_th__Gp7TR\",\"round\":\"crosstable_round__2RGZ-\",\"headerCell\":\"crosstable_headerCell__2zS_u\",\"tr\":\"crosstable_tr__2Bw-x\",\"footer\":\"crosstable_footer__1O1OA\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"user_container__1dvTh\",\"section\":\"user_section__3uWp7\",\"title\":\"user_title__1_x29\",\"sectionHeader\":\"user_sectionHeader__Hie3r\",\"expando\":\"user_expando__1WrtI\",\"info\":\"user_info__iwDFt\",\"buttons\":\"user_buttons__2RHQ3\",\"row\":\"user_row__3ro1x\",\"details\":\"user_details__1SQEQ\",\"flag\":\"user_flag__2UYEA\",\"accountSection\":\"user_accountSection__1v38f\",\"optionsContainer\":\"user_optionsContainer__1_GSb\",\"pendingContainer\":\"user_pendingContainer__1Bwh8\",\"account\":\"user_account__2Ssme\",\"claim\":\"user_claim__3tI48\",\"inline\":\"user_inline__3OXtN\",\"icon\":\"user_icon__1Gghq\",\"active\":\"user_active__2mhNB\",\"facebookLink\":\"user_facebookLink__2btxv\",\"accountButton\":\"user_accountButton__3oyQ8\",\"remove\":\"user_remove__fI5h_\",\"notes\":\"user_notes__2esV_\",\"sync\":\"user_sync__1JFkv\",\"auth\":\"user_auth__2yfjQ\",\"null\":\"user_null__3Qrr2\",\"authMessage\":\"user_authMessage__390Sk\",\"upcomingBattle\":\"user_upcomingBattle__3pUGX\",\"stage\":\"user_stage__3ss_y\",\"reversed\":\"user_reversed__2kR16\",\"name\":\"user_name__3j1p-\",\"vs\":\"user_vs__1kBgF\",\"join\":\"user_join__3BJv3\",\"infoBox\":\"user_infoBox__3E8hT\",\"clickButton\":\"user_clickButton__1FCsS\",\"darkMode\":\"user_darkMode__71Cw8\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"fsChart\":\"stats_fsChart__3pHze\",\"title\":\"stats_title__XSaLS\",\"subtitle\":\"stats_subtitle__24ox6\",\"name\":\"stats_name__178sR\",\"url\":\"stats_url__1r9Nj\",\"header\":\"stats_header__3zy0s\"};","import universalCookies, { CookieSetOptions } from 'universal-cookie';\r\n\r\nconst windowCookies = new universalCookies();\r\n\r\nexport default class Cookies {\r\n\r\n\tgetAll(): Promise<{[key: string]: string}> {\r\n\t\tlet c = windowCookies.getAll();\r\n\t\treturn Promise.resolve(c);\r\n\t}\r\n\r\n\tget(name: string): Promise<string> {\r\n\t\treturn Promise.resolve(windowCookies.get(name) || '');\r\n\t}\r\n\r\n\tset(name: string, value: any, options: CookieSetOptions = { path: '/', maxAge: 604800 }): Promise<void> {\r\n\t\treturn Promise.resolve(windowCookies.set(name, value, options));\r\n\t}\r\n\r\n\tremove(name: string, options: CookieSetOptions = { path: '/' }): Promise<void> {\r\n\t\treturn Promise.resolve(windowCookies.remove(name, options));\r\n\t}\r\n}","export const chessCom = /chess\\.com\\/(?:live#tm=|club\\/matches\\/live\\/(?:[a-z-]+\\/)?)([0-9]+)/;\n\nexport const dark = /dark/gi\n\nexport const streamLink = /(?:https:\\/\\/)?(?:www.)?(?:(twitch.tv|youtube.com))\\/(.*)/;\n\nexport const link = /(?:https:\\/\\/)?(?:www.)?([a-z.]*)\\/?(?:.*)?/;\n\nexport const lowerCase = /[a-z0-9]*/gi;\n\nexport const mobile = [\n\t/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,\n\t/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i\n];\n\n\n/* eslint-disable-next-line no-control-regex */\nexport const email = /^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])$/i;\n\nexport const username = /^[a-z0-9][\\w-]{0,28}[a-z0-9]$/i;","import * as regexes from './regexes';\n\nexport function isMobile(): boolean {\n\tlet str: string = navigator.userAgent || navigator.vendor || '';\n\tif (regexes.mobile[0].test(str)) return true;\n\tif (regexes.mobile[1].test(str.substr(0, 4))) return true;\n\treturn false;\n}","import { Dispatch, SetStateAction } from 'react';\nimport axios, { AxiosRequestConfig, AxiosResponse, AxiosError } from 'axios';\nimport config, { useProd, prodServer, server as configServer } from '../config.json';\nimport Cookies from './cookies';\n\nimport io from 'socket.io-client';\nimport { isMobile } from './auth';\n\nlet errorCallback: (header: string, message: string) => void = () => {};\n\nexport const dev = process.env.NODE_ENV === 'development'; //detects a react dev build\nexport const isDev = dev && !useProd\nconsole.log('isDev', dev);\nexport const server = !isDev ? prodServer : configServer;\nexport const domain = !isDev ? config.prodDomain : undefined;\nexport const lichess = !isDev ? config.lichess : config.lichessBeta;\nexport const lichessCallback = !isDev ? config.lichessCallback : config.lichessCallbackBeta;\n\naxios.defaults.baseURL = server;\nexport const resultsServer = '';\nexport const saltRounds = 10;\nexport let cookies = new Cookies();\n\n// alter all requests to use cookies only from AsyncStorageCookieStore\nif (!isMobile()) axios.interceptors.request.use(async (c) => {\n\n\t// the device will have it's own cookie store, and attempt to\n\t// send cookies itself.\n\t// this has been documented to be unreliable, so we wipe these cookies\n\t// and implement the cookie store ourselves.\n\t//await AsyncStorage.clear()\n\treturn Object.assign(c, {\n\t\theaders: Object.assign(c.headers, {\n\t\t\tAuthorization: JSON.stringify(await cookies.getAll())\n\t\t})\n\t});\n\n});\n\nexport function GET(options: AxiosRequestConfig): Promise<any> {\n\toptions = Object.assign(options, {\n\t\tmethod: 'GET'\n\t});\n\treturn axios(options)\n\t\t.then((res: AxiosResponse<any>) => res.data)\n\t\t.catch((e: AxiosError) => {\n\t\t\tconsole.error(e);\n\t\t\t//if (e.response) errorCallback(`${e.response.status} ${e.response.statusText}: /${e.response.config.url?.split('/').pop()}`, e.response.data);\n\t\t\tthrow e;\n\t\t});\n}\n\nexport function POST(options: AxiosRequestConfig): Promise<any> {\n\toptions = Object.assign(options, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json'\n\t\t}\n\t});\n\treturn axios(options)\n\t\t.then((res: AxiosResponse<any>) => res.data)\n\t\t.catch((e) => {\n\t\t\tif (e.response) {\n\t\t\t\tif (e.response.status === 400) {\n\t\t\t\t\terrorCallback('Error:', e.response.data);\n\t\t\t\t} else {\n\t\t\t\t\terrorCallback(`${e.response.status} ${e.response.statusText}: /${e.response.config.url.split('/').pop()}`, e.response.data);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthrow e;\n\t\t});\n}\n\nexport function FORM(e: React.FormEvent<HTMLFormElement>): Promise<any> {\n\tif (e.preventDefault) e.preventDefault();\n\tif (e.persist) e.persist();\n\tlet form = e.target as HTMLFormElement;\n\twhile (form.constructor.name !== 'HTMLFormElement' && form.parentElement) {\n\t\tform = form.parentElement as HTMLFormElement;\n\t}\n\tif (form.constructor.name !== 'HTMLFormElement') throw new Error('Couldn\\'t find valid form');\n\tlet inputs = Array.from(form) as HTMLInputElement[];\n\tlet data = inputs.reduce((acc, curr) => {\n\t\tif (!curr.name) return acc;\n\t\tif (curr.name === 'submit') return acc;\n\t\tif (curr.type === 'number') acc[curr.name] = Number(curr.value);\n\t\telse acc[curr.name] = curr.value;\n\t\treturn acc;\n\t}, {} as {[key: string]: any});\n\tlet options = {\n\t\tdata,\n\t\turl: form.action\n\t} as AxiosRequestConfig;\n\treturn POST(options);\n}\n\nexport function setErrorCallback(c: (header: string, message: string) => void) {\n\terrorCallback = c;\n}\n\nexport const socket = io(server, {\n\treconnection: true,\n    reconnectionDelay: 1000,\n    reconnectionDelayMax : 100000,\n    reconnectionAttempts: 5\n});\n\nexport function connect(setConnected: Dispatch<SetStateAction<boolean>>): void {\n\n\tsetConnected(socket.connected);\n\n\tsocket.on('connect', () => {\n\t\tsetConnected(true);\n\t});\n\tsocket.on('connect_error', (e: Error) => {\n\t\tconsole.error(e);\n\t\tsetConnected(false);\n\t});\n\tsocket.on('connect_timeout', (e: Error) => {\n\t\tconsole.error(e);\n\t\tsetConnected(false);\n\t});\n}\n\nexport function emit(event: string, ...args: any[]): void {\n\n    socket.emit(event, ...args);\n}\n\n/**\n * \n\n    startRequests: async function() {\n        try {\n            while (this._requests.length > 0) {\n                if (!this._running) this._running = true;\n                let request = this.dequeue();\n                let method = request.method;\n                let callback = request.callback;\n                let error = null;\n                let response = await method(...request.parameters, request.options)\n                    .catch((e) => error = e);\n                callback(response, error, ...request.callbackParamerters);\n            }\n            this._running = false;\n        } catch(error) {\n            throw error;\n        }\n    },\n */","import leven from 'leven';\n\nexport function capitalise(str: string): string {\n\tif (!str) return str;\n\treturn str.slice(0, 1).toUpperCase() + str.slice(1).toLowerCase();\n}\n\nexport function randBetween(min: number, max: number): number {\n\treturn Math.floor(Math.random() * (max - min + 1) + min);\n}\n\nexport function compare(_myName: string, _pulledName: string): number {\n\tlet myName = _myName.toLowerCase().trim();\n\tlet pulledName = _pulledName.toLowerCase().trim();\n\tif (!myName || !pulledName) return 1;\n\tif (myName === pulledName) return 0;\n\tif (myName.length > 10) {\n\t\tif (pulledName.startsWith(myName)) return 0;\n\t\tif (pulledName.endsWith(myName)) return 0;\n\t}\n\treturn leven(myName, pulledName) / myName.length;\n}","import React, { ReactElement, useCallback, useEffect, useState, useContext} from 'react';\nimport { Redirect, Link } from 'react-router-dom';\nimport { PairingsProps } from '../tournament/Pairings';\nimport styles from '../css/pairings.module.css';\nimport { GET } from '../utils/requests';\nimport { TournamentSettings } from '../resources/settings';\nimport { FaAngleDoubleRight, FaPlusCircle } from 'react-icons/fa';\nimport { AiOutlineTable } from 'react-icons/ai';\nimport { IoIosStats } from 'react-icons/io';\nimport { watch } from '../assets/icons';\nimport { LoginContext } from '../App';\nimport { capitalise } from '../utils/prototype';\n\n\nexport function UserSwitcher(props: {\n\tsection: String\n\tloaded: boolean\n\tclassNames?: {[key: string]: string}\n\tsections: {\n\t\t[key: string]: {\n\t\t\tname?: string\n\t\t\tlink: string\n\t\t\ticon: JSX.Element\n\t\t\thide?: boolean\n\t\t}\n\t}\n}): ReactElement {\n\n\treturn <>\n\t\t<div className={[styles.modeSwitcher, props.classNames?.switcher].join(' ')}>\n\t\t\t{Object.entries(props.sections).map(([k, s], i) => {\n\t\t\t\tif (s.hide) return null;\n\t\t\t\tif (!props.loaded) {\n\t\t\t\t\treturn <div className={['header-button'].join(' ')} key={['header-button', i].join(' ')}>\n\t\t\t\t\t\t{'\\u200b'}\n\t\t\t\t\t</div>;\n\t\t\t\t} else {\n\t\t\t\t\treturn <Link to={s.link} key={['header-button', i].join('.')} className={['header-button', props.section === k ? 'selected' : ''].join(' ')}>\n\t\t\t\t\t\t<div>{s.icon}{s.name || capitalise(k)}</div>\n\t\t\t\t\t</Link>;\n\t\t\t\t}\n\t\t\t})}\n\t\t</div>\n\t</>;\n}\n\nexport function ModeSwitcher(props: {\n\tid: string,\n\tsection: 'pairings' | 'standings' | 'stats' | 'tv'\n\tsettings: TournamentSettings\n\tround: number\n\tloaded: {[key: string]: boolean}\n}): ReactElement {\n\n\tconst loggedIn = useContext(LoginContext);\n\tconst [shouldRedirect, redirectTo] = useState('');\n\n\tconst handleJoin = useCallback(() => {\n\t\tif (!loggedIn) return redirectTo('/login');\n\t\treturn null;\n\t}, [loggedIn, redirectTo]);\n\n\tif (shouldRedirect) return <Redirect to={shouldRedirect} />;\n\n\treturn <>\n\t\t<div className={[styles.modeSwitcher].join(' ')}>\n\t\t\t{props.loaded.all ?\n\t\t\t\tprops.round ? <Link to={`/${props.id}/pairings`} className={['header-button', props.section === 'pairings' ? 'selected' : ''].join(' ')}>\n\t\t\t\t\t<div><FaAngleDoubleRight />Pairings</div>\n\t\t\t\t</Link> : null :\n\t\t\t<div className='header-button'>{'\\u200b'}</div>}\n\t\t\t{props.loaded.all ?\n\t\t\t\t<Link to={`/${props.id}/standings`} className={['header-button', props.section === 'standings' ? 'selected' : ''].join(' ')}>\n\t\t\t\t\t<div><AiOutlineTable /> Standings</div>\n\t\t\t\t</Link> :\n\t\t\t<div className='header-button'>{'\\u200b'}</div>}\n\t\t\t{props.loaded.all ?\n\t\t\t\t<Link to={`/${props.id}/stats`} className={['header-button', props.section === 'stats' ? 'selected' : ''].join(' ')}>\n\t\t\t\t\t<div><IoIosStats /> Stats</div>\n\t\t\t\t</Link> :\n\t\t\t<div className='header-button'>{'\\u200b'}</div>}\n\t\t\t{props.loaded.all ?\n\t\t\t\tprops.settings.streamURL ?\n\t\t\t\t\t<Link to={`/${props.id}/tv`} className={['header-button', 'stream-link', props.section === 'stats' ? 'selected' : '', 'twitch-link'].join(' ')}>\n\t\t\t\t\t\t<div><img src={watch} alt='tv'/> TV</div>\n\t\t\t\t\t</Link>\n\t\t\t\t: null :\n\t\t\t<div className={['header-button', 'stream-link', 'twitch-link'].join(' ')}>{'\\u200b'}</div>}\n\t\t</div>\n\t\t{props.settings.allowRegistration && props.settings.allowRegistration !== 'closed' ? <div className={['header-button', styles.join].join(' ')} onClick={handleJoin}>\n\t\t\t<div><FaPlusCircle />Join this tournament</div>\n\t\t</div> : null}\n\t</>;\n}\n\nexport function RoundSwitcher(props: PairingsProps & {\n\tsection: 'pairings' | 'standings' | 'stats' | 'tv',\n\tround: number\n\tloaded: {[key: string]: boolean}\n}): ReactElement {\n\n\tconst [roundTimes, setRoundTimes] = useState([]);\n\tconst fetchRoundTimes = useCallback(() => GET({ url: `tournament/${props.id}/fetchRounds` })\n\t\t.then(setRoundTimes), [props.id, setRoundTimes]);\n\tuseEffect(() => {\n\t\tfetchRoundTimes();\n\t}, [fetchRoundTimes]);\n\n\tlet rounds = [];\n\tlet totalRounds = props.settings.totalRounds === Infinity || props.settings.totalRounds === 'Infinity' ? 1 : props.settings.totalRounds;\n\tfor (let i = 1; i < totalRounds + 1; i++) {\n\t\tlet date = roundTimes[i] ? new Date(roundTimes[i]).toString() : '';\n\t\trounds.push(\n\t\t\t<Link\n\t\t\t\tclassName={['header-button', styles.pairingRound, props.round === i ? styles.roundSelected : '', i > props.status.round ? styles.nullRound : ''].join(' ')}\n\t\t\t\tto={`/${props.id}/${props.section}/${i}`}\n\t\t\t\tkey={['round', i].join('.')}\n\t\t\t>\n\t\t\t<div className='full-text'>\n\t\t\t\t{props.loaded.all ?\n\t\t\t\t\t<>\n\t\t\t\t\t\t<h4>Round {i}</h4>\n\t\t\t\t\t\t{roundTimes[i] ? \n\t\t\t\t\t\t\t<h5>{date.substring(0, 11) + date.substring(16, 21)}</h5> :\n\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t}\n\t\t\t\t\t</>\n\t\t\t\t: '\\u200b'}\n\t\t\t\t</div>\n\t\t\t</Link>\n\t\t);\n\t}\n\tif (props.loaded.status && props.section === 'pairings' && props.round && !props.status.active) rounds.push(\n\t\t<Link\n\t\t\tclassName={['header-button', styles.pairingRound, props.round === totalRounds + 1 ? styles.roundSelected : ''].join(' ')}\n\t\t\tto={`/${props.id}/${props.section}/results`}\n\t\t>\n\t\t\t<div className='full-text'>\n\t\t\t\t<h4>Results</h4>\n\t\t\t\t{roundTimes[totalRounds + 1] ? <h5>{new Date(roundTimes[totalRounds + 1]).toString().substring(0, 11) + new Date(roundTimes[totalRounds + 1]).toString().substring(16, 21)}</h5> : null}\n\t\t\t</div>\t\t\t\t\n\t\t</Link>\n\t)\n\n\treturn (\n\t\t<div className={['container', 'bodyContainer'].join(' ')}>\n\t\t\t{rounds.length ?\n\t\t\t\t<div className='button-list'>\n\t\t\t\t\t{rounds}\n\t\t\t\t</div> :\n\t\t\tnull}\n\t\t</div>\n\t);\n}","import { History, Bonus, TournamentSettings } from '../interfaces';\n\nconst templateD = {\n\tscore: 0,\n\tgamePoints: 0,\n\tplayed: 0,\n\tgamesPlayed: 0,\n\tgameDifference: 0,\n\texpectedScore: 0,\n\texpectedGameScore: 0,\n\twhiteTotal: 0,\n\twins: 0,\n\tdraws: 0,\n\tlosses: 0,\n\tmatchPercentage: 0,\n\tgamePercentage: 0,\n\tratingDifference: 0\n}\nexport default class Player {\n\tconstructor(m: {[key: string]: any}, private round: number, public settings: TournamentSettings) {\n\t\tlet proxied = Object.keys(templateD);\n\t\tfor (let prop of Object.keys(m)) {\n\t\t\tif (!proxied.includes(prop)) {\n\t\t\t\tObject.defineProperty(this, prop, {\n\t\t\t\t\tvalue: m[prop]\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tif (this.id === 'bye') return;\n\t\tthis.compute(round, settings);\n\t}\n\n\tpublic static bye(tournamentId: string, round: number, settings: TournamentSettings): Player {\n\t\treturn new Player({\n\t\t\tid: 'bye',\n\t\t\ttournamentId,\n\t\t\trating: 0,\n\t\t\tfirstName: '',\n\t\t\tlastName: '',\n\t\t\thistories: []\n\t\t}, round, settings);\n\t}\n\n\tsetRound(round: number) {\n\t\tthis.round = round;\n\t\tthis.compute(round, this.settings);\n\t}\n\tsetSettings(settings: TournamentSettings) {\n\t\tthis.settings = settings;\n\t\tthis.compute(this.round, settings);\n\t}\n\tsetBonuses(bonuses: Bonus[]) {\n\t\tthis.bonuses = bonuses.filter(b => b.id === this.id);\n\t\tthis.compute(this.round, this.settings);\n\t}\n\n\tcompute(round: number, settings: TournamentSettings) {\n\t\tlet d = Object.assign({}, templateD) as {[key: string]: number};\n\t\tfor (let i = 1; i < round + 1; i++) {\n\t\t\tlet h = this.histories[i];\n            if (!h) continue;\n\t\t\tif (h.match !== null) {\n\t\t\t\tif (h.id !== 'bye') {\n\t\t\t\t\td.played++;\n\t\t\t\t\tif (h.played) d.gamesPlayed += h.played;\n\t\t\t\t}\n\t\t\t\tif (h.match === 0) {\n\t\t\t\t\td.score += settings.lossReward;\n\t\t\t\t\td.losses++;\n\t\t\t\t} else\n\t\t\t\tif (h.match === 0.5) {\n\t\t\t\t\td.score += settings.drawReward;\n\t\t\t\t\td.draws++;\n\t\t\t\t} else\n\t\t\t\tif (h.match === 1) {\n\t\t\t\t\td.score += settings.winReward;\n\t\t\t\t\td.wins++;\n\t\t\t\t}\n\t\t\t\tif (h.game) d.gamePoints += h.game;\n\t\t\t\td.expectedScore += h.expected;\n\t\t\t\td.expectedGameScore += h.expected * h.played;\n\t\t\t}\n\t\t\tif (h.colour === 'W') d.whiteTotal++;\n\t\t};\n\t\tObject.assign(d, {\n\t\t\tgameDifference: d.gamePoints * 2 - d.gamesPlayed,\n\t\t\tmatchPercentage: d.played ? d.score * 100 / d.played : -1,\n\t\t\tgamePercentage: d.gamesPlayed ? d.gamePoints * 100 / d.gamesPlayed : -1,\n\t\t\tratingDifference: this.performanceRating - this.rating\n\t\t});\n\t\tif (this.bonuses) {\n\t\t\tfor (let b of this.bonuses) {\n\t\t\t\tif (b.round > round) continue;\n\t\t\t\tif (b.MP) d.score += b.MP;\n\t\t\t\tif (b.GP) d.gamePoints += b.GP;\n\t\t\t}\n\t\t}\n\t\tfor (let prop of Object.keys(d)) {\n\t\t\tObject.defineProperty(this, prop, {\n\t\t\t\tvalue: d[prop],\n\t\t\t\tconfigurable: true\n\t\t\t});\n\t\t}\n\n\n\t\tlet scores = [''] as string[];\n\t\tfor (let i = 1; i < this.histories.length; i++) {\n\t\t\tif (i > round || !this.histories[i]) {\n\t\t\t\tscores[i] = '';\n\t\t\t\tcontinue;\n\t\t\t};\n\t\t\tif (this.histories[i].match === null || this.histories[i].match === undefined) scores[i] = '*';\n\t\t\telse scores[i] = (this.histories[i].match as number).toString();\n\t\t\tif (this.histories[i].id === 'bye') scores[i] += 'b';\n\t\t}\n\t\tthis.rounds = scores.slice(1);\n\n\t\treturn this;\n\t}\n\tpublic rounds!: string[]\n\n\tpublic tournamentId!: string;\n\tpublic id!: string\n\tpublic firstName!: string\n\tpublic lastName!: string\n\tpublic rating!: number\n\tpublic nationality!: string\n\n\tpublic score!: number\n\tpublic gamePoints!: number\n\tpublic played!: number\n\tpublic expectedScore!: number\n\tpublic expectedGameScore!: number\n\tpublic whiteTotal!: 0\n\tpublic isPlaying!: string | null;\n\tpublic active!: boolean;\n\tpublic performanceRating!: number;\n\n    public histories!: History[]\n    public bonuses!: Bonus[]\n\tpublic clashList!: string[]\n\tpublic contact?: {\n\t\temail?: string\n\t\tzoom?: string\n\t\tskype?: string\n\t\tfacebook?: string\n\t\tphone?: string\n\t}\n\tpublic lichess!: string\n\tpublic chessCom!: string\n\tpublic meta?: {\n\t\t[key: string]: any\n\t}\n\tpublic teamId?: string\n\n\t// timestamps!\n\tpublic readonly createdAt!: Date;\n\tpublic readonly updatedAt!: Date;\n\n\tget rank(): number {\n\t\treturn 0;\n\t}\n\tget name(): string {\n\t\treturn this.settings.competitors === 'individual' ? [this.firstName, this.lastName].join(' ') : this.firstName;\n\t}\n\n    hasPlayed(id: string): boolean {\n        if (!this.histories) return false;\n        return this.histories.some(h => h.id && h.id === id);\n    }\n\t\n\tscoreAgainst(id: string): number {\n\t\tif (!this.histories) return 0;\n\t\treturn this.histories.reduce((acc, curr) => curr && curr.id === id && curr.match ? acc += curr.match : acc, 0);\n\t}\n\t\n\tgameScoreAgainst(id: string): number {\n\t\tif (!this.histories) return 0;\n\t\treturn this.histories.reduce((acc, curr) => curr && curr.id === id && curr.game ? acc += curr.game : acc, 0);\n\t}\n\n    private _netGamePoint!: number;\n    get netGamePoint(): number {\n        if (this._netGamePoint) return this._netGamePoint;\n        if (!this.histories) return 0;\n\t\tlet matchPoints = 0;\n\t\tlet played = 0;\n\t\tthis.histories.forEach((curr) => {\n\t\t\tif (!curr) return;\n\t\t\tmatchPoints += curr.game || 0;\n\t\t\tplayed += curr.played\n\t\t});\n\t\treturn this._netGamePoint = matchPoints * 2 - played;\n    }\n\n    private _progressiveScore!: number;\n    get progressiveScore(): number {\n        if (this._progressiveScore) return this._progressiveScore;\n        if (!this.histories) return 0;\n        let prog = 0;\n        for (let h of this.histories) {\n            if (!h) continue;\n            if (h.match) prog += h.match;\n        }\n        return this._progressiveScore = prog;\n    }\n\n    private _oppRatingSum!: number;\n    get oppRatingSum(): number {\n        if (this._oppRatingSum) return this._oppRatingSum;\n        if (!this.histories) return 0;\n        let sum = 0;\n        for (let h of this.histories) {\n            if (!h) continue;\n            sum += h.oppRating;\n        }\n        return this._oppRatingSum = sum;\n    }\n}","import { useState, useCallback, useEffect, useReducer } from 'react';\nimport PlayerData from '../../models/Player';\nimport { Bonus, Player, TournamentStatus, TournamentSettings } from '../../interfaces';\nimport { GET, server } from '../../utils/requests';\nimport url from 'url';\n\ninterface Props {\n\tstatus: TournamentStatus\n\tplayers: Player[]\n\tsettings: TournamentSettings\n\tround: number\n}\n\nconst def = [] as PlayerData[];\n\nexport default function usePlayers(props: Props): PlayerData[] {\n\n\tconst [hasLoaded, load] = useState(false);\n\tconst [bonuses, setBonuses] = useState([] as Bonus[]);\n\tconst reducePlayers = useCallback((state: PlayerData[], action: 'props' | 'round' | 'settings' | 'bonuses'): PlayerData[] => {\n\t\tswitch (action) {\n\t\t\tcase 'props': {\n\t\t\t\tif (!props.players.length) return state;\n\t\t\t\treturn props.players.map(p => new PlayerData(p, props.round, props.settings));\n\t\t\t}\n\t\t\tcase 'round': {\n\t\t\t\tif (!props.round) return state;\n\t\t\t\tif (!state.length) return state;\n\t\t\t\tlet players = state.slice(0);\n\t\t\t\tfor (let p of players) {\n\t\t\t\t\tp.setRound(props.round);\n\t\t\t\t}\n\t\t\t\treturn players;\n\t\t\t}\n\t\t\tcase 'settings': {\n\t\t\t\tif (!props.settings.winReward) return state;\n\t\t\t\treturn props.players.map(p => new PlayerData(p, props.round, props.settings));\n\t\t\t}\n\t\t\tcase 'bonuses': {\n\t\t\t\tif (!bonuses.length) return state;\n\t\t\t\tif (!state.length) return state;\n\t\t\t\tlet set = false;\n\t\t\t\tlet players = state.slice(0);\n\t\t\t\tfor (let b of bonuses) {\n\t\t\t\t\tlet index  = players.findIndex(p => p.id === b.id);\n\t\t\t\t\tif (index < 0) continue;\n\t\t\t\t\tif (!players[index].bonuses) {\n\t\t\t\t\t\tplayers[index].setBonuses(bonuses);\n\t\t\t\t\t\tset = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (set) return players;\n\t\t\t\telse return state;\n\t\t\t}\n\t\t\tdefault: {\n\t\t\t\treturn state;\n\t\t\t}\n\t\t}\n\t}, [props.players, props.round, props.settings, bonuses]);\n\tconst [players, updatePlayers] = useReducer(reducePlayers, def);\n\n\tuseEffect(() => {\n\t\tupdatePlayers('props')\n\t}, [updatePlayers, props.players]);\n\tuseEffect(() => {\n\t\tupdatePlayers('settings')\n\t}, [updatePlayers, props.settings]);\n\tuseEffect(() => {\n\t\tupdatePlayers('round')\n\t}, [updatePlayers, props.round]);\n\tuseEffect(() => {\n\t\tif (!bonuses.length) return;\n\t\tupdatePlayers('bonuses')\n\t}, [updatePlayers, bonuses]);\n\n\tconst updateBonuses = useCallback(() =>  props.status.id && !hasLoaded ? GET({ url: url.resolve(server, ['tournament', props.status.id, 'fetchBonuses'].join('/'))})\n\t\t.then(setBonuses).finally(() => load(true)) : null, [props.status.id, setBonuses, load, hasLoaded]);\n\tuseEffect(() => {\n\t\tif (hasLoaded) return;\n\t\tupdateBonuses();\n\t}, [updateBonuses, hasLoaded, load]);\n\n\tif (!hasLoaded) return def;\n\treturn players;\n\n}","import React from 'react';\r\nimport { Player as PlayerData } from '../models';\r\nimport { TournamentSettings } from '../interfaces';\r\nimport { flags } from '../config.json';\r\n\r\nexport interface ColumnData {\r\n\tid?: (entry: PlayerData, i: number, s: TournamentSettings) => string\r\n\tname: string | ((key: string, i: number) => string)\r\n\tclassName: 'blank' | 'playerName' | 'flag' | 'locked' | 'rating' | 'unset' | 'edit' | ((v: string, i: number, settings: TournamentSettings) => string),\r\n\tsort?: false | ((a: any, b: any) => number),\r\n\tshow?: (entry: PlayerData, i: number, settings: TournamentSettings, h?: string) => boolean\r\n\tconvert?: (v: any, p: PlayerData, s: TournamentSettings, h: string) => string | JSX.Element\r\n\tpostConvert?: (v: string, i: number) => string\r\n\tmobile?: string\r\n\tbrief?: string\r\n}\r\n\r\nexport const columns = {\r\n\tpre: {\r\n\t\trank: {\r\n\t\t\tmobile: 'Rank',\r\n\t\t\tname: '',\r\n\t\t\tclassName: 'blank',\r\n\t\t\tsort: false,\r\n\t\t\tpostConvert: (v: string, i: number): string => (1 + i).toString()\r\n\t\t},\r\n\t\tname: {\r\n\t\t\tname: 'Name',\r\n\t\t\tclassName: 'playerName',\r\n\t\t\tid: (p: PlayerData, i: number, s: TournamentSettings): string => ['', s.competitors === 'individual' ? 'player' : 'team', p.id].join('/'),\r\n\t\t\tsort: (a: string, b: string) => {\r\n\t\t\t\tif (a > b) return 1;\r\n\t\t\t\tif (a < b) return -1;\r\n\t\t\t\treturn 0;\r\n\t\t\t},\r\n\t\t},\r\n\t\tnationality: {\r\n\t\t\tname: 'Fed',\r\n\t\t\tmobile: 'Federation',\r\n\t\t\tclassName: 'flag',\r\n\t\t\tconvert: (v: string) => v ? <img src={flags.replace('|', v)} alt={v} /> : null\r\n\t\t},\r\n\t\trating: {\r\n\t\t\tname: 'Rating',\r\n\t\t\tclassName: 'locked',\r\n\t\t\tshow: (e: PlayerData, i: number, s: TournamentSettings) => s.showRatings\r\n\t\t}\r\n\t},\r\n\troundColumn: {\r\n\t\tname: (key: string, i: number): string => key.slice(-1),\r\n\t\tid: (p: PlayerData, i: number, s: TournamentSettings): string => {\r\n\t\t\tif (!p.histories || !p.histories[i] || p.histories[i].match === null) return '';\r\n\t\t\tlet h = p.histories[i];\r\n\t\t\tlet { colour } = h;\r\n\t\t\tlet w = colour === 'W' ? p.id : h.id;\r\n\t\t\tlet b = colour === 'W' ? h.id : p.id;\r\n\t\t\treturn [\r\n\t\t\t\t'',\r\n\t\t\t\ts.vanityURL || p.tournamentId,\r\n\t\t\t\t'pairings',\r\n\t\t\t\ti\r\n\t\t\t].join('/') + '#' + [w, b].join('.')\r\n\t\t},\r\n\t\tclassName: (v: string, i: number, s: TournamentSettings) => {\r\n\t\t\tif (v === '*') return 'edit';\r\n\t\t\tif (v === '') return 'unset';\r\n\t\t\telse return 'playerName';\r\n\t\t},\r\n\t\tconvert: (v: string, p: PlayerData, s: TournamentSettings, h: string) => {\r\n\t\t\tif (v === '') return '';\r\n\t\t\telse if (v === '*') return '*';\r\n\t\t\tlet bonus = false;\r\n\t\t\tlet round = Number(h.slice(-1));\r\n\t\t\tif (p.bonuses) for (let b of p.bonuses) if (b.round === round) { v += b.MP; bonus = true };\r\n\t\t\tlet nb = parseFloat(v);\r\n\t\t\tlet output: string;\r\n\t\t\tif (nb === 0.5) output = '';\r\n\t\t\telse output = nb.toString();\r\n\t\t\tif (v.endsWith('b')) output += 'b';\r\n\t\t\tif (bonus) output += '*';\r\n\t\t\treturn output;\r\n\t\t},\r\n\t\tsort: (a: string, b: string): number => {\r\n\t\t\tif (a === b) return 0;\r\n\t\t\tif (a === '') return 1;\r\n\t\t\telse if (b === '') return -1;\r\n\t\t\tif (a === '*') return 1;\r\n\t\t\telse if (b === '*') return -1;\r\n\t\t\tlet [aN, bN] = [parseInt(a), parseInt(b)];\r\n\t\t\tif (a.toString().endsWith('b')) aN -= 0.001;\r\n\t\t\tif (b.toString().endsWith('b')) bN -= 0.001;\r\n\t\t\treturn bN - aN;\r\n\t\t}\r\n\t},\r\n\tpost: {\r\n\t\tscore: {\r\n\t\t\tmobile: 'Match Points',\r\n\t\t\tname: 'MP',\r\n\t\t\tclassName: 'locked',\r\n\t\t\tconvert: (v: number, p: PlayerData): string => Math.floor(v) === v ? v.toFixed() : v === 0.5 ? '' : Math.floor(v).toFixed() + ''\r\n\t\t},\r\n\t\tgamePoints: {\r\n\t\t\tmobile: 'Game Points',\r\n\t\t\tname: 'GP',\r\n\t\t\tclassName: 'locked',\r\n\t\t\tconvert: (v: number): string => v.toFixed(1)\r\n\t\t},\r\n\t\tgameDifference: {\r\n\t\t\tmobile: 'Game Point Difference',\r\n\t\t\tbrief: 'Game Point +/-',\r\n\t\t\tname: 'G. +/-',\r\n\t\t\tclassName: 'locked',\r\n\t\t\tconvert: (v: number): string => {\r\n\t\t\t\tif (!v) return '';\r\n\t\t\t\tif (v > 0) return '+' + v.toFixed(1);\r\n\t\t\t\telse return v.toFixed(1)\r\n\t\t\t},\r\n\t\t},\r\n\t\tgamesPlayed: {\r\n\t\t\tmobile: 'Games Played',\r\n\t\t\tname: 'P',\r\n\t\t\tclassName: 'locked',\r\n\t\t\tconvert: (v: number): string => v.toString()\r\n\t\t},\r\n\t\tmatchPercentage: {\r\n\t\t\tmobile: 'Match Point Percentage',\r\n\t\t\tbrief: 'Match Point +/-',\r\n\t\t\tname: 'M. %',\r\n\t\t\tclassName: 'rating',\r\n\t\t\tconvert: (v: number): string => v.toFixed()\r\n\t\t},\r\n\t\tgamePercentage: {\r\n\t\t\tmobile: 'Game Point Percentage',\r\n\t\t\tbrief: 'Game Point %',\r\n\t\t\tname: 'G. %',\r\n\t\t\tclassName: 'rating',\r\n\t\t\tconvert: (v: number): string => v.toFixed()\r\n\t\t},\r\n\t\tperformanceRating: {\r\n\t\t\tmobile: 'Performance Rating',\r\n\t\t\tbrief: 'Perf. Rating',\r\n\t\t\tname: 'Perf',\r\n\t\t\tclassName: 'rating',\r\n\t\t\tconvert: (v: number): string => v.toFixed(),\r\n\t\t\tshow: (entry: PlayerData, i: number, s: TournamentSettings) => s.showRatings\r\n\t\t},\r\n\t\tratingDifference: {\r\n\t\t\tmobile: 'Performance Rating Difference',\r\n\t\t\tbrief: 'Perf. Rating +/-',\r\n\t\t\tname: 'P. +/-',\r\n\t\t\tclassName: 'rating',\r\n\t\t\tconvert: (v: number): string => {\r\n\t\t\t\tif (!v) return '';\r\n\t\t\t\tif (v > 0) return '+' + v.toString();\r\n\t\t\t\telse return v.toString()\r\n\t\t\t},\r\n\t\t\tshow: (entry: PlayerData, i: number, s: TournamentSettings) => s.showRatings\r\n\t\t},\r\n\t\texpectedScore: {\r\n\t\t\tmobile: 'Expected Score',\r\n\t\t\tname: 'Expected',\r\n\t\t\tclassName: 'rating',\r\n\t\t\tconvert: (v: number, p: PlayerData): string => v.toFixed(1) + ' / ' + p.played,\r\n\t\t\tshow: (entry: PlayerData, i: number, s: TournamentSettings) => s.showRatings\r\n\t\t},\r\n\t\texpectedDifference: {\r\n\t\t\tmobile: 'Score to Expected',\r\n\t\t\tbrief: 'Expected +/-',\r\n\t\t\tname: 'E. +/-',\r\n\t\t\tclassName: 'rating',\r\n\t\t\tconvert: (v: number): string => {\r\n\t\t\t\tif (typeof v === 'undefined') return '';\r\n\t\t\t\tif (v > 0) return '+' + v.toFixed(2);\r\n\t\t\t\telse return v.toFixed(2)\r\n\t\t\t},\r\n\t\t\tshow: (entry: PlayerData, i: number, s: TournamentSettings) => s.showRatings\r\n\t\t},\r\n\t\twins: {\r\n\t\t\tmobile: 'Wins',\r\n\t\t\tname: 'W',\r\n\t\t\tclassName: 'locked',\r\n\t\t\tshow: (e, i, s, p: string) => p !== 'results',\r\n\t\t\tconvert: (v: number): string => v.toString()\r\n\t\t},\r\n\t\tdraws: {\r\n\t\t\tmobile: 'Draws',\r\n\t\t\tname: 'D',\r\n\t\t\tclassName: 'locked',\r\n\t\t\tshow: (e, i, s, p: string) => p !== 'results',\r\n\t\t\tconvert: (v: number): string => v.toString()\r\n\t\t},\r\n\t\tlosses: {\r\n\t\t\tmobile: 'Losses',\r\n\t\t\tname: 'L',\r\n\t\t\tclassName: 'locked',\r\n\t\t\tshow: (e, i, s, p: string) => p !== 'results',\r\n\t\t\tconvert: (v: number): string => v.toString()\r\n\t\t},\r\n\t\tplayed: {\r\n\t\t\tmobile: 'Played',\r\n\t\t\tname: 'P',\r\n\t\t\tclassName: 'locked',\r\n\t\t\tshow: (e, i, s, p: string) => p !== 'results',\r\n\t\t\tconvert: (v: number): string => v.toString()\r\n\t\t}\r\n\t}\r\n} as {\r\n\tpre: {\r\n\t\t[key: string]: ColumnData\r\n\t},\r\n\troundColumn: ColumnData\r\n\tpost: {\r\n\t\t[key: string]: ColumnData\r\n\t}\r\n\r\n}","import { History, Player } from '../models';\n\nexport const TieBreaks = {\n\th2h: {\n\t\tname: 'By head-to-head score',\n\t\tfunc: (a: Player, b: Player): number => {\n\t\t\treturn b.scoreAgainst(a.id) - a.scoreAgainst(a.id);\n\t\t}\n\t},\n\tgamePoint: {\n\t\tname: 'By game point total',\n\t\tfunc: (a: Player, b: Player): number => {\n\t\t\treturn b.gamePoints - a.gamePoints;\n\t\t}\n\t},\n\tgamePointDiff: {\n\t\tname: 'By net game points',\n\t\tfunc: (a: Player, b: Player): number => {\n\t\t\treturn b.netGamePoint - a.netGamePoint;\n\t\t}\n\t},\n\twhites: {\n\t\tname: 'By times played black',\n\t\tfunc: (a: Player, b: Player): number => {\n\t\t\treturn a.whiteTotal - b.whiteTotal;\n\t\t}\n\t},\n\tprogScore: {\n\t\tname: 'By progressive score',\n\t\tfunc: (a: Player, b: Player): number => {\n\t\t\treturn b.progressiveScore - a.progressiveScore;\n\t\t}\n\t},\n\twins: {\n\t\tname: 'By most wins',\n\t\tfunc: (a: Player, b: Player): number => {\n\t\t\tif (!b.histories || !a.histories) return 0;\n\t\t\treturn (b.histories as History[]).filter(h => h && h.match === 1).length - (a.histories as History[]).filter(h => h && h.match === 1).length;\n\t\t}\n\t},\n\tgameh2h: {\n\t\tname: 'By head-to-head of game points',\n\t\tfunc: (a: Player, b: Player): number => {\n\t\t\treturn b.gameScoreAgainst(a.id) - a.gameScoreAgainst(a.id);\n\t\t}\n\t},\n\tperfRating: {\n\t\tname: 'By performance rating',\n\t\tfunc: (a: Player, b: Player): number => {\n\t\t\treturn b.performanceRating - a.performanceRating;\n\t\t}\n\t},\n\trating: {\n\t\tname: 'By rating',\n\t\tfunc: (a: Player, b: Player): number => {\n\t\t\treturn b.rating - a.rating;\n\t\t}\n\t},\n\toppRating: {\n\t\tname: 'By average rating cut',\n\t\tfunc: (a: Player, b: Player): number => {\n\t\t\tif (b.oppRatingSum !== a.oppRatingSum) return b.oppRatingSum - a.oppRatingSum;\n\t\t\tlet [aHistories, bHistories] = [a.histories?.filter((h: History) => h), b.histories?.filter((h: History) => h)];\n\t\t\tif (!aHistories || !bHistories || !aHistories.length || !bHistories.length) return 0;\n\t\t\tlet aSorted = (aHistories as History[]).sort((x, y) => x.oppRating - y.oppRating);\n\t\t\tlet bSorted = (bHistories as History[]).sort((x, y) => x.oppRating - y.oppRating);\n\t\t\twhile (true) {\n\t\t\t\tlet [aNext, bNext] = [aSorted.shift(), bSorted.shift()];\n\t\t\t\tif (aNext === undefined || bNext === undefined) break;\n\t\t\t\tif (!aNext && !bNext) continue;\n\t\t\t\tlet [aAv, bAv] = [aSorted.reduce((acc, curr) => curr ? acc += curr.oppRating : acc, 0) / aSorted.length, bSorted.reduce((acc, curr) => curr ? acc += curr.oppRating : acc, 0) / bSorted.length];\n\t\t\t\tif (aAv !== bAv) return bAv - aAv;\t\t\t\t\n\t\t\t}\n\t\t\treturn 0;\n\t\t}\n\t},\n\talphabetical: {\n\t\tname: 'Alphabetical',\n\t\tfunc: (a: Player, b: Player): number => {\n\t\t\tif (b.firstName > a.firstName) return -1;\n\t\t\telse if (a.firstName > b.firstName) return 1;\n\t\t\treturn 0;\n\t\t}\n\t}\n}\n","import { createContext, Dispatch, SetStateAction } from 'react';\nimport { TieBreaks } from './resources/tiebreaks';\nimport { Player, Notif } from './interfaces';\nimport { AlertProps } from './components/NotifBox';\n\nexport const TiebreakContext = createContext(Object.entries(TieBreaks));\nexport const DisplayNameContext = createContext((() => '') as (id: string | Player) => string);\nexport const NotifContext = createContext((() => null) as Dispatch<SetStateAction<Notif>>);\nexport const AlertContext = createContext(((props: AlertProps) => {}));","import React, { ReactElement, useMemo, useCallback, useReducer, useContext } from 'react';\nimport { Link } from 'react-router-dom';\nimport { TournamentStatus, Player, TournamentSettings } from '../../interfaces';\nimport PlayerData from '../../models/Player';\nimport usePlayers from './Players';\n\nimport styles from '../../css/crosstable.module.css';\nimport { columns, ColumnData } from '../../resources/columns';\nimport { TiebreakContext } from '../../Contexts';\n\nexport interface StandingProps {\n\tdirection: string\n\tsetDisplayPlayer: (id: string) => void\n\tshow: () => void\n\tstatus: TournamentStatus\n\tplayers: Player[]\n\tsettings: TournamentSettings\n\tround: number\n\tstate: string[]\n}\n\nexport default function Standings(props: StandingProps): ReactElement {\n\n\tconst players: PlayerData[] = usePlayers(props);\n\n\tconst totalRounds = useMemo((): number => {\n\t\tlet totalRounds: number;\n\t\tif (props.status.round > props.settings.totalRounds) totalRounds = props.status.round;\n\t\telse if (props.settings.totalRounds === 'Infinity' || props.settings.totalRounds === Infinity) totalRounds = props.status.round;\n\t\telse totalRounds = props.settings.totalRounds;\n\t\treturn totalRounds;\n\t}, [props.status.round, props.settings.totalRounds]);\n\n\tconst roundHeaders = useMemo(() => {\n\t\tlet h = [] as string[];\n\t\tfor (let i = 1; i <= totalRounds; i++) {\n\t\t\th.push('round.' + i.toString());\n\t\t}\n\t\treturn h;\n\t}, [totalRounds]);\n\n\tconst headers: string[] = useMemo(() => [...Object.keys(columns.pre), ...roundHeaders, ...Object.keys(columns.post)], [roundHeaders])\n\t\t.filter((key, i) => {\n\t\t\tlet meta = columns.pre[key] || columns.post[key];\n\t\t\tif (!meta) return true;\n\t\t\tif (meta.show && !meta.show(null as any as PlayerData, i, props.settings)) return false;\n\t\t\treturn true;\n\t\t});\n\n\tconst setSortHeader = useCallback((state: [string, number], action: string): [string, number] => {\n\t\tif (!headers.includes(action)) return ['', 0];\n\t\tif (state[0] !== action) return [action, 0];\n\t\telse return [action, state[1] + 1];\n\t}, [headers]);\n\tconst [sort, sortBy] = useReducer(setSortHeader, ['score', 0]);\n\n\tconst tiebreaks = useContext(TiebreakContext);\n\n\tconst renderRows: JSX.Element[] = useMemo(() => {\n\t\tif (!players.length) return [];\n\t\tlet rowsData = [] as [number, ColumnData, PlayerData][][];\n\t\tfor (let i = 0; i < players.length; i++) {\n\t\t\tlet p = players[i];\n\t\t\tif (p.id === 'bye') continue;\n\t\t\tlet pres = [] as [number, ColumnData, PlayerData][];\n\t\t\tfor (let [k, meta] of Object.entries(columns.pre)) {\n\t\t\t\tif (meta.show && !meta.show(p, i, props.settings)) continue;\n\t\t\t\tpres.push([p[k as keyof Player] as number, meta, p]);\n\t\t\t}\n\t\t\tlet _rounds = p.rounds\n\t\t\tfor (let j = _rounds.length + 1; j <= totalRounds; j++) _rounds.push('')\n\t\t\tlet rounds = _rounds.map(entry => [entry as any as number, columns.roundColumn, p]) as [number, ColumnData, PlayerData][];\n\t\t\tlet post = [] as [number, ColumnData, PlayerData][];\n\t\t\tfor (let [k, meta] of Object.entries(columns.post)) {\n\t\t\t\tif (meta.show && !meta.show(p, i, props.settings)) continue;\n\t\t\t\tpost.push([p[k as keyof Player] as number, meta, p]);\n\t\t\t}\n\t\t\tlet rowData = [...pres, ...rounds, ...post];\n\t\t\trowsData.push(rowData);\n\t\t}\n\n\t\tlet sortFunc = (a: number, b: number): number => b - a;\n\t\tlet sortMeta = sort[0].startsWith('round') ? columns.roundColumn : (columns.pre[sort[0]] || columns.post[sort[0]]);\n\t\tif (sortMeta && sortMeta.sort !== false) {\n\t\t\tif (sortMeta.sort) sortFunc = sortMeta.sort;\n\t\t\tlet sortCol = headers.indexOf(sort[0]);\n\t\t\tif (sortCol !== -1)\n\t\t\trowsData = rowsData.sort((a, b): number => {\n\t\t\t\tlet x: number;\n\t\t\t\tif (sort[1] % 2) x = sortFunc(b[sortCol][0], a[sortCol][0]);\n\t\t\t\telse x = sortFunc(a[sortCol][0], b[sortCol][0]);\n\t\t\t\tif (x) return x;\n\t\t\t\tif (props.round === totalRounds) return props.state.indexOf(a[sortCol][2].id) -  props.state.indexOf(b[sortCol][2].id)\n\t\t\t\tlet allTb = tiebreaks.slice(0);\n\t\t\t\tlet useTb = allTb.shift();\n\n\t\t\t\twhile (useTb) {\n\t\t\t\t\tlet res = useTb[1].func(a[sortCol][2], b[sortCol][2]);\n\t\t\t\t\tif (res) return res;\n\t\t\t\t\tuseTb = allTb.shift();\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t});\n\t\t}\n\n\t\tlet rows = rowsData.map((rowData, i) => {\n\t\t\tlet x = (\n\t\t\t\t<tr key={'row.' + i} className={styles.tr}>\n\t\t\t\t\t{rowData.map(([value, meta, p]: [number, ColumnData, PlayerData], j: number) => {\n\t\t\t\t\t\tlet display: string | JSX.Element = value ? value.toString() : '';\n\t\t\t\t\t\tif (meta.convert) display = meta.convert(value, p, props.settings, headers[j]);\n\t\t\t\t\t\telse if (meta.postConvert) display = meta.postConvert(display, i);\n\t\t\t\t\t\tif (typeof display === 'undefined' || display === '') display = '\\u200b';\n\t\t\t\t\t\tlet className = typeof meta.className === 'function' ? meta.className(typeof display === 'string' ? display : '', j, props.settings) : meta.className;\n\t\t\t\t\t\tlet name = typeof meta.name === 'function' ? meta.name((headers[j] || '').toString(), j) : meta.name;\n\t\t\t\t\t\tlet link = meta.id ? meta.id(p, parseInt(name), props.settings) : '';\n\t\t\t\t\t\treturn <>\n\t\t\t\t\t\t\t<th className={[styles.cell, styles.headerCell].join(' ')} key={['cellHeader', j].join('.')}>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t{meta.mobile ? meta.mobile : name}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t<th key={['cellBody', j].join('.')}>\n\t\t\t\t\t\t\t\t{link ?\n\t\t\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\t\t\tto={link}\n\t\t\t\t\t\t\t\t\t\tclassName={[styles.cell, className, styles[className]].join(' ')}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{display}\n\t\t\t\t\t\t\t\t\t</Link> :\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tkey={[value, j].join('.')}\n\t\t\t\t\t\t\t\t\t\tclassName={[styles.cell, className, styles[className]].join(' ')}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{display}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t</>;\n\t\t\t\t\t})}\n\t\t\t\t</tr>\n\t\t\t);\n\t\t\treturn x;\n\t\t})\n\t\treturn rows;\n\t}, [players, sort, headers, props.round, props.state, totalRounds, props.settings, tiebreaks]);\n\t\t\n\treturn <>\n\t\t<section className={'animated-' + props.direction} key='standings.1'>\n\t\t\t<table className={['download-table full-width', styles.table, 'standings'].join(' ')}>\n\t\t\t\t<thead className={styles.headers}>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t{headers.map((key, i) => {\n\t\t\t\t\t\t\tlet meta = key.startsWith('round') ? columns.roundColumn : (columns.pre[key] || columns.post[key]);\n\t\t\t\t\t\t\treturn <th\n\t\t\t\t\t\t\t\tscope='column'\n\t\t\t\t\t\t\t\tkey={['column', i].join('.')}\n\t\t\t\t\t\t\t\tclassName={[styles.th, key.startsWith('round') ? styles.round : ''].join(' ')}\n\t\t\t\t\t\t\t\tid={key}\n\t\t\t\t\t\t\t\tonClick={() => sortBy(key)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div className={[styles.cell, styles.headerCell].join(' ')}>\n\t\t\t\t\t\t\t\t\t{typeof meta.name === 'function' ? meta.name(key, i) : meta.name}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</th>;\n\t\t\t\t\t\t})}\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\t\t\t\t\n\t\t\t\t\t{\n\t\t\t\t\t\trenderRows.length ?\n\t\t\t\t\t\trenderRows :\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<th colSpan={42}>\n\t\t\t\t\t\t\t\tNo players entered yet\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t}\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t</section>\n\t\t<section className={'animated-' + props.direction} key='footer.1'>\n\t\t\t<div className={styles.footer}>\n\t\t\t\t* denotes bonuses or requested byes granted.\n\t\t\t</div>\n\t\t</section>\n\t</>;\n}","import React, { ReactElement, createRef, RefObject, useState, Dispatch, SetStateAction } from 'react';\nimport { ModalGateway, Modal } from 'react-images';\nimport styles from '../css/fullscreen.module.css'\nimport 'react-responsive-carousel/lib/styles/carousel.min.css';\nimport '../css/chart.css';\n\ninterface FSProps {\n\tchildren: ReactElement | (ReactElement | null)[]\n\tclassName?: string\n\tuseState?: [boolean, Dispatch<SetStateAction<boolean>>]\n}\n\nexport default function FullScreen(props: FSProps) {\n\n\tconst [full, setF] = useState(false);\n\tlet [fullScreen, setFullScreen] = props.useState || [full, setF];\n\tconst fullScreenChart = createRef() as RefObject<HTMLDivElement>;\n\n\tif (!fullScreen) return null;\n\treturn (\n\t\t<ModalGateway>\n\t\t\t<Modal onClose={() => setFullScreen(false)}>\n\t\t\t\t<div className={['chartContainer', 'rankings', styles.container, props.className].join(' ')} ref={fullScreenChart}>\n\t\t\t\t\t<div className={[styles.fullScreenHeader, 'header--isModal css-111ute9 css-1ycyyax'].join(' ')}>\n\t\t\t\t\t\t<span />\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t<button type=\"button\" title=\"Enter fullscreen (f)\" className=\"header_button __header_button--fullscreen css-m6j0xf css-1ycyyax\" onClick={() => !document.fullscreenElement && fullScreenChart.current ? (fullScreenChart.current as HTMLElement).requestFullscreen() : document.exitFullscreen()}>\n\t\t\t\t\t\t\t\t<svg role=\"presentation\" viewBox=\"0 0 24 24\" className=\"css-1rkjyjh\">\n\t\t\t\t\t\t\t\t\t<path d=\"M14.016 5.016h4.969v4.969h-1.969v-3h-3v-1.969zM17.016 17.016v-3h1.969v4.969h-4.969v-1.969h3zM5.016 9.984v-4.969h4.969v1.969h-3v3h-1.969zM6.984 14.016v3h3v1.969h-4.969v-4.969h1.969z\" />\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type=\"button\" title=\"Close (esc)\" className=\"react-images__header_button react-images__header_button--close css-m6j0xf css-1ycyyax\" onClick={() => setFullScreen(false)}>\n\t\t\t\t\t\t\t\t<svg role=\"presentation\" viewBox=\"0 0 24 24\" className=\"css-1rkjyjh\">\n\t\t\t\t\t\t\t\t\t<path d=\"M18.984 6.422l-5.578 5.578 5.578 5.578-1.406 1.406-5.578-5.578-5.578 5.578-1.406-1.406 5.578-5.578-5.578-5.578 1.406-1.406 5.578 5.578 5.578-5.578z\" />\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={styles.stage}>\n\t\t\t\t\t\t{props.children}\n\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Modal>\n\t\t</ModalGateway>\n\t)\n}","import React, { ReactElement, useMemo, useCallback, useState, useContext, createRef, RefObject } from 'react';\nimport { TournamentStatus, Player as PlayerInterface, TournamentSettings } from '../interfaces';\nimport Chartist from 'react-chartist';\nimport ChartistMain, { ILineChartOptions } from 'chartist';\nimport tooltip from 'chartist-plugin-tooltips-updated';\nimport ctAxisTitle from 'chartist-plugin-axistitle';\nimport '../css/chart.css';\nimport pairingStyles from '../css/pairings.module.css';\nimport styles from '../css/stats.module.css';\nimport { randBetween } from '../utils/prototype';\nimport { FaCaretDown, FaCaretUp, FaMinus, FaAngleUp, FaAngleDoubleLeft, FaAngleDoubleDown, FaAngleDown } from 'react-icons/fa';\nimport { TiebreakContext } from '../Contexts';\nimport usePlayers from './Standings/Players';\nimport Player from '../models/Player';\nimport ReactSlider from 'react-slider';\nimport { isMobile } from '../utils/auth';\nimport FullScreen from '../components/FullScreen';\n\ninterface TableProps {\n\tdirection: string\n\tstatus: TournamentStatus\n\tplayers: PlayerInterface[]\n\tsettings: TournamentSettings\n\tround: number\n}\n\nexport default function Chart(props: TableProps): ReactElement {\n\n\tconst [size, setSize] = useState(15);\n\tconst players = usePlayers(props);\n\n\tconst columns = useMemo((): {[key: string]: {mobile: string, name: string, value: (p: Player, round: number) => number, show?: (s: TournamentSettings) => boolean}} => {\n\t\treturn {\n\t\t\trating: {\n\t\t\t\tmobile: 'Rating',\n\t\t\t\tname: 'Rating',\n\t\t\t\tvalue: (p: Player): number => p.rating,\n\t\t\t\tshow: (s: TournamentSettings) => false\n\t\t\t},\n\t\t\tscore: {\n\t\t\t\tmobile: 'Match Points',\n\t\t\t\tname: 'MP',\n\t\t\t\tvalue: (p: Player, round: number) => p.histories.slice(1, round + 1).reduce((acc, curr) => (curr && typeof curr.match === 'number') ? acc += curr.match || 0 : acc, 0 as number)\n\t\t\t},\n\t\t\tgamePoints: {\n\t\t\t\tmobile: 'Game Points',\n\t\t\t\tname: 'GP',\n\t\t\t\tvalue: (p: Player, round: number) => p.histories.slice(1, round + 1).reduce((acc, curr) => (curr && typeof curr.match === 'number') ? acc += curr.game || 0 : acc, 0 as number),\n\t\t\t\tshow: (s: TournamentSettings) => s.gamePointTotal !== 1\n\t\t\t},\n\t\t\tgameDifference: {\n\t\t\t\tmobile: 'Game Point Difference',\n\t\t\t\tname: 'G. +/-',\n\t\t\t\tvalue: (p: Player, round: number) => {\n\t\t\t\t\tlet matchPoints = 0;\n\t\t\t\t\tlet played = 0;\n\t\t\t\t\tp.histories.slice(1, round + 1).forEach((curr) => {\n\t\t\t\t\t\tif (!curr) return;\n\t\t\t\t\t\tmatchPoints += curr.game || 0;\n\t\t\t\t\t\tplayed += matchPoints !== null ? curr.played : 0;\n\t\t\t\t\t});\n\t\t\t\t\treturn matchPoints * 2 - played;\n\t\t\t\t},\n\t\t\t\tshow: (s: TournamentSettings) => s.gamePointTotal !== 1\n\t\t\t},\n\t\t\tmatchPercentage: {\n\t\t\t\tmobile: 'Match Point Percentage',\n\t\t\t\tname: 'M. %',\n\t\t\t\tvalue: (p: Player, round: number) => {\n\t\t\t\t\tlet matchPoints = 0;\n\t\t\t\t\tlet played = 0;\n\t\t\t\t\tp.histories.slice(1, round + 1).forEach((curr) => {\n\t\t\t\t\t\tif (!curr) return;\n\t\t\t\t\t\tmatchPoints += curr.match || 0;\n\t\t\t\t\t\tplayed += 1 || 0;\n\t\t\t\t\t});\n\t\t\t\t\tif (played === 0) return -1;\n\t\t\t\t\treturn matchPoints * 100 / played;\n\t\t\t\t}\n\t\t\t},\n\t\t\tgamePercentage: {\n\t\t\t\tmobile: 'Game Point Percentage',\n\t\t\t\tname: 'G. %',\n\t\t\t\tvalue: (p: Player, round: number) => {\n\t\t\t\t\tlet gamePoints = 0;\n\t\t\t\t\tlet played = 0;\n\t\t\t\t\tp.histories.slice(1, round + 1).forEach((curr) => {\n\t\t\t\t\t\tif (!curr) return;\n\t\t\t\t\t\tgamePoints += curr.game || 0;\n\t\t\t\t\t\tplayed += curr.played || 0;\n\t\t\t\t\t});\n\t\t\t\t\tif (played === 0) return -1;\n\t\t\t\t\treturn gamePoints * 100 / played;\n\t\t\t\t},\n\t\t\t\tshow: (s: TournamentSettings) => s.gamePointTotal !== 1\n\t\t\t},\n\t\t\tperformanceRating: {\n\t\t\t\tmobile: 'Performance Rating',\n\t\t\t\tname: 'Perf',\n\t\t\t\tvalue: (p: Player) => p.performanceRating,\n\t\t\t\tshow: (s: TournamentSettings) => false\n\t\t\t},\n\t\t\tratingDifference: {\n\t\t\t\tmobile: 'Performance Rating Difference',\n\t\t\t\tname: 'P. +/-',\n\t\t\t\tvalue: (p: Player): number => {\n\t\t\t\t\tif (!p.performanceRating) return 0;\n\t\t\t\t\treturn p.performanceRating - p.rating;\n\t\t\t\t},\n\t\t\t\tshow: (s: TournamentSettings) => false\n\t\t\t},\n\t\t\texpectedScore: {\n\t\t\t\tmobile: 'Expected Score',\n\t\t\t\tname: 'Expected',\n\t\t\t\tvalue: (p: Player, round: number): number => p.histories.slice(1, round + 1).reduce((acc, curr) => (curr && typeof curr.expected === 'number') ? acc += curr.expected || 0 : acc, 0 as number),\n\t\t\t\tshow: (s: TournamentSettings) => false\n\t\t\t},\n\t\t\texpectedDifference: {\n\t\t\t\tmobile: 'Score to Expected',\n\t\t\t\tname: 'E. +/-',\n\t\t\t\tvalue: (p: Player, round: number): number => p.histories.slice(1, round + 1).reduce((acc, curr) => (curr && typeof curr.expected === 'number' && typeof curr.match === 'number') ? acc += (curr.match - curr.expected) || 0 : acc, 0 as number),\n\t\t\t\tshow: (s: TournamentSettings) => s.showRatings\n\t\t\t}\n\t\t}\n\t}, []);\n\n\tconst totalRounds = useMemo((): number => {\n\t\tlet totalRounds: number;\n\t\tif (props.status.round > props.settings.totalRounds) totalRounds = props.status.round;\n\t\telse if (props.settings.totalRounds === 'Infinity') totalRounds = props.status.round;\n\t\telse totalRounds = props.settings.totalRounds;\n\t\treturn totalRounds;\n\t}, [props.status.round, props.settings.totalRounds]);\n\t\n\tconst [labels, setLabels] = useState([] as string[]);\n\tconst table = useMemo((): {[key: string]: (number | undefined)[][]} => {\n\t\tlet res = {} as {[key: string]: (number | undefined)[][]};\n\t\tlet _labels = labels.slice(0);\n\t\tlet p = players.filter(p => p.id !== 'bye');\n\t\tfor (let i = 0; i < p.length; i++) {\n\t\t\tlet player = p[i];\n\t\t\tfor (let [k, meta] of Object.entries(columns)) {\n\t\t\t\tif (!res[k]) res[k] = [];\n\t\t\t\tlet row = [];\n\t\t\t\tfor (let j = 1; j < totalRounds + 1; j++) {\n\t\t\t\t\t_labels[j - 1] = j.toString();\t\t\t\t//label them assuming starting at round at the start of the array\n\t\t\t\t\tif (j >= player.histories.length) row.push(undefined);\n\t\t\t\t\telse row[j] = meta.value(player, j);\n\t\t\t\t}\n\t\t\t\tres[k][i] = row;\n\t\t\t}\n\t\t}\n\t\tsetLabels(_labels);\n\t\treturn res;\n\t}, [players, columns, totalRounds]);\n\n\tconst tiebreaks = useContext(TiebreakContext);\n\tconst [detailed, setDetailed] = useState(true);\n\tconst [highPerf, setPerf] = useState(true);\n\tconst [fullScreen, setFullScreen] = useState(false);\n\n\tconst rank = useCallback((table: (number | undefined)[][], order: boolean): {meta: string, value: (number | undefined)}[][] => {\n\t\tlet length = table[0].length;\n\t\tlet rotated = [] as {meta: Player, value: number | undefined}[][];\n\t\tlet ids = [] as [string, number | undefined][][];\n\t\tfor (let j = 1; j < length; j++) {\n\t\t\trotated[j] = [];\n\t\t\tfor (let i = 0; i < table.length; i++) {\n\t\t\t\trotated[j][i] = {\n\t\t\t\t\tmeta: players[i],\n\t\t\t\t\tvalue: table[i][j]\n\t\t\t\t}\n\t\t\t}\n\t\t\trotated[j] = rotated[j].sort((a, b) => {\n\t\t\t\tif (a.value === undefined) return 1;\n\t\t\t\telse if (b.value === undefined) return -1;\n\t\t\t\tif (a.value !== b.value) return b.value - a.value;\n\t\t\t\tlet allTb = tiebreaks.slice(0);\n\t\t\t\tlet useTb = allTb.shift();\n\t\t\t\twhile (useTb) {\n\t\t\t\t\tlet res = useTb[1].func(a.meta, b.meta);\n\t\t\t\t\tif (res) return res;\n\t\t\t\t\tuseTb = allTb.shift();\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t});\n\t\t\tids[j] = rotated[j].map(c => c.value !== undefined ? [c.meta.id, c.value] : ['', undefined]);\n\t\t}\n\t\tlet ranks = [] as {meta: string, value: (number | undefined)}[][];\n\t\tfor (let i = 0; i < table.length; i++) {\n\t\t\tranks[i] = [];\n\t\t\tfor (let j = 1; j < length; j++) {\n\t\t\t\tlet p = players[i];\n\t\t\t\tlet index = ids[j].findIndex(id => id[0] === p.id);\n\t\t\t\tranks[i][j - 1] = {\t\t\t// move the final row conversion back one column\n\t\t\t\t\tmeta: p.firstName + ' ' + p.lastName,\n\t\t\t\t\tvalue: (p.histories[j] && typeof p.histories[j].match === 'number' && index >= 0) ?\n\t\t\t\t\t\t(order ? -index - 1 : ids[j][index][1]) :\n\t\t\t\t\t\tundefined\n\t\t\t\t\t\t\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\treturn ranks;\n\t}, [players, columns]);\n\n\tconst [key, setKey] = useState([] as JSX.Element[]);\n\tconst [order, setOrder] = useState(true);\n\tconst [lastColumn, setLastColumn] = useState(1);\n\tconst [defGraph, setGraph] = useState('score');\n\n\tconst GraphOptions = useMemo(() => {\n\t\treturn Object.entries(columns).map(([k, meta], i) => {\n\t\t\tif (meta.show && !meta.show(props.settings)) return null;\n\t\t\treturn (\n\t\t\t\t<div\n\t\t\t\t\tclassName={['header-button', pairingStyles.pairingRound, defGraph === k ? pairingStyles.roundSelected : ''].join(' ')}\n\t\t\t\t\tonClick={() => setGraph(k)}\n\t\t\t\t\tkey={['round', i].join('.')}\n\t\t\t\t>\n\t\t\t\t\t<div className='full-text'><h4>{meta.mobile}</h4></div>\n\t\t\t\t</div>\n\t\t\t)\n\t\t})\n\t}, [columns, defGraph, setGraph, props.settings]);\n\n\n\tconst OrderOptions = useMemo(() => {\n\t\treturn <>\n\t\t\t<div\n\t\t\t\tclassName={['header-button', pairingStyles.pairingRound, order ? pairingStyles.roundSelected : ''].join(' ')}\n\t\t\t\tonClick={() => setOrder(true)}\n\t\t\t\tkey={['round', 'order'].join('.')}\n\t\t\t>\n\t\t\t\t<div className='full-text'><h4>Ranking</h4></div>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclassName={['header-button', pairingStyles.pairingRound, !order ? pairingStyles.roundSelected : ''].join(' ')}\n\t\t\t\tonClick={() => setOrder(false)}\n\t\t\t\tkey={['round', 'unorder'].join('.')}\n\t\t\t>\n\t\t\t\t<div className='full-text'><h4>Points</h4></div>\n\t\t\t</div>\n\t\t</>\n\t}, [order, setOrder]);\n\n\tconst tooltipFnc = useCallback((meta: string, value: number) => {\n\t\treturn [\n\t\t\tmeta,\n\t\t\torder ? ('#' + (-Number(value)).toString()) : ''\n\t\t].join('\\n');\n\t}, [order]);\n\n\tconst orderedChart = useMemo(() => {\n\t\tlet k = defGraph;\n\t\tif (!table[k]) return null;\n\n\t\tlet ranked = rank(table[k], order);\n\n\t\tlet half = Math.ceil(ranked.length /  2);\n\t\tfor (let j = totalRounds; j >= 0; j--) {\n\t\t\tif (ranked.reduce((acc, curr, i) => {\n\t\t\t\tif (j < props.status.round && typeof curr[j - 1]?.value !== 'number') {\n\t\t\t\t\t//if (curr[j - 1]) curr[j - 1].value = -(i + 1);\n\t\t\t\t}\n\t\t\t\treturn typeof curr[j]?.value === 'number' ? acc += 1 : acc\n\t\t\t}, 0) > half) {\n\t\t\t\tsetLastColumn(j);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tlet sorted = ranked.sort((a, b) => {\n\t\t\treturn (b[lastColumn]?.value || -Infinity) - (a[lastColumn]?.value || -Infinity)\n\t\t})\n\t\tlet keys = sorted.map((c, i): ReactElement => {\n\t\t\tif (!order) return <>{c[lastColumn]?.meta}</>;\n\t\t\tif (!lastColumn) return <>{c[lastColumn]?.meta}</>;\n\t\t\tif (lastColumn === props.status.round) return <>#{i} {c[lastColumn]?.meta}</>;\n\t\t\tif (c[lastColumn]?.value === undefined || c[lastColumn]?.value === undefined) return <>\n\t\t\t\t<span className={['chartArrow'].join(' ')}>\n\t\t\t\t\t<div>{'\\u200b'}</div>\n\t\t\t\t\t<div>{'\\u200b'}</div>\n\t\t\t\t</span>\t\t\t\t\t\n\t\t\t\t{c[lastColumn]?.meta}\n\t\t\t</>;\n\t\t\tlet diff = (c[lastColumn]?.value as number) - (c[lastColumn - 1]?.value as number);\n\t\t\tlet arrow = diff > 0 ?\n\t\t\t\t<FaCaretUp /> :\n\t\t\t\tdiff < 0 ?\n\t\t\t\t<FaCaretDown /> :\n\t\t\t\t<FaMinus />\n\t\t\treturn (\n\t\t\t\t<>\n\t\t\t\t\t<span className={['chartArrow', diff > 0 ? 'chartPositive' : diff < 0 ? 'chartNegative' : 'chartNeutral'].join(' ')}>\n\t\t\t\t\t\t<div>{Math.abs(diff) || '\\u200b'}</div>\n\t\t\t\t\t\t{arrow}\n\t\t\t\t\t</span>\t\t\t\t\t\n\t\t\t\t\t{c[lastColumn]?.meta}\n\t\t\t\t</>\n\t\t\t);\n\t\t});\n\t\tsetKey(keys);\n\n\t\tif (order) ranked.push([{\n\t\t\tmeta: 'placeholder',\n\t\t\tvalue: -ranked.length\n\t\t}])\n\n\t\ttooltip({\n\t\t\ttooltipFnc\n\t\t});\n\t\tChartistMain.plugins.tooltip({ tooltipFnc });\n\n\t\tctAxisTitle();\n\t\treturn (\n\t\t\t<Chartist\n\t\t\t\tdata={{\n\t\t\t\t\tlabels,\n\t\t\t\t\tseries: ranked\n\t\t\t\t}}\n\t\t\t\toptions={{\n\t\t\t\t\tfullWidth: true,\n\t\t\t\t\tdivisor: 0.5,\n\t\t\t\t\t// As this is axis specific we need to tell Chartist to use whole numbers only on the concerned axis\n\t\t\t\t\taxisY: {\n\t\t\t\t\t\toffset: 25,\n\t\t\t\t\t\tonlyInteger: order,\n\t\t\t\t\t\tlabelInterpolationFnc: (value: number) => order ? value ? '#' + (-value).toString() : '' : value,\n\t\t\t\t\t},\n\t\t\t\t\twidth: fullScreen ? window.innerWidth * 0.8 : '100%',\n\t\t\t\t\theight: fullScreen ? window.innerHeight - 150 :\n\t\t\t\t\t\torder && detailed ? size * (table[k].length + (size < 21.7 ? 4.2 : 0)):\n\t\t\t\t\twindow.innerHeight * 0.8,\n\t\t\t\t\tplugins: [\n\t\t\t\t\t\tChartistMain.plugins.tooltip({\n\t\t\t\t\t\t\ttooltipFnc\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tChartistMain.plugins.ctAxisTitle({\n\t\t\t\t\t\t\taxisX: {\n\t\t\t\t\t\t\t\taxisTitle: 'Round',\n\t\t\t\t\t\t\t\taxisClass: 'ct-axis-title',\n\t\t\t\t\t\t\t\ttextAnchor: 'middle'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t} as ILineChartOptions}\n\t\t\t\ttype='Line'\n\t\t\t/>\n\t\t);\n\t}, [table, defGraph, lastColumn, rank, labels, totalRounds, order, tooltipFnc, props.status.round, size, detailed, fullScreen]);\n\n\tconst css = useMemo(() => {\n\t\tlet text = '';\n\t\tfor (let i = 'p'.charCodeAt(0); i < 'z'.charCodeAt(0) + 1; i++) {\n\t\t\tlet colour = randBetween(0, 65536).toString(16);\n\t\t\ttext += `.ct-series.ct-series-${String.fromCharCode(i)} {\n\t\t\t\tstroke: #${'0'.repeat(6 - colour.length)}${colour};\n\t\t\t}`;\n\t\t\ttext += `.ct-series.ct-series-${String.fromCharCode(i)} > path {\n\t\t\t\tstroke: #${'0'.repeat(6 - colour.length)}${colour};\n\t\t\t}`;\n\t\t}\n\t\treturn text;\n\t}, []);\n\t\n\treturn (\n\t\t<>\n\t\t\t<div className={['container', 'bodyContainer', 'animated-' + props.direction].join(' ')}>\n\t\t\t\t<div className='button-list'>\n\t\t\t\t\t{GraphOptions}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className={['container', 'bodyContainer', 'animated-' + props.direction].join(' ')}>\n\t\t\t\t<div className='button-list'>\n\t\t\t\t\t{OrderOptions}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<section className={'animated-' + props.direction}>\n\t\t\t\t<style>\n\t\t\t\t\t{css}\n\t\t\t\t</style>\n\t\t\t\t<div className={pairingStyles.description}>\n\t\t\t\t\tThis chart shows the rankings for each team throughout the rounds, beginning with round 1 on the left.<br />\n\t\t\t\t\tSwitch to 'Points' above to see each team's points progression.<br />\n\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t\t<div className={'sliderContainer container'}>\n\t\t\t\t\t<div>Size</div>\n\t\t\t\t\t<ReactSlider\n\t\t\t\t\t\tclassName={pairingStyles.slider}\n\t\t\t\t\t\tthumbClassName={pairingStyles.thumb}\n\t\t\t\t\t\ttrackClassName={pairingStyles.track}\n\t\t\t\t\t\tmin={5}\n\t\t\t\t\t\tmax={!detailed || !order ? undefined : Math.max(30, window.innerHeight / players.length)}\n\t\t\t\t\t\tstep={highPerf ? 0.5 : 5}\n\t\t\t\t\t\tvalue={!detailed || !order ? window.innerHeight * 0.8 / players.length : size}\n\t\t\t\t\t\tdisabled={!detailed || !order}\n\t\t\t\t\t\tonChange={(n) => typeof n === 'number' ? setSize(n) : null}\n\t\t\t\t\t\trenderThumb={(p, s) => <div {...p}>{s.valueNow}</div>}\n\t\t\t\t\t/>\n\t\t\t\t\t<div className='increment' onClick={() => size >= 6 ? setSize(size - 1) : null}><FaAngleDown /></div>\n\t\t\t\t\t<div className='increment'  onClick={() => size <= 29 ? setSize(size + 1) : null}><FaAngleUp /></div>\n\t\t\t\t</div>\n\t\t\t\t<div className={'optionsContainer container'}>\n\t\t\t\t\t<div className={['header-button', pairingStyles.pairingRound, 'switchContainer'].join(' ')}>\n\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t<div>{detailed && order ? 'Detailed' : 'Fit'}</div>\n\t\t\t\t\t\t\t<div>{detailed && order ? 'Switch off to view on one screen' : order ? 'Switch to view player names' : 'Detailed view is only available with Ranking'}</div>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<div className='toggleSwitch' onClick={() => setDetailed(!detailed)}>\n\t\t\t\t\t\t\t<input type='checkbox' className='check' checked={detailed && order}/>\n\t\t\t\t\t\t\t<div className='toggleSlider round' />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={['header-button', pairingStyles.pairingRound, 'switchContainer'].join(' ')}>\n\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t<div>{highPerf ? 'High' : 'Low'} Performance</div>\n\t\t\t\t\t\t\t<div>Switch off if slow on Size change</div>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<div className='toggleSwitch' onClick={() => setPerf(!highPerf)}>\n\t\t\t\t\t\t\t<input type='checkbox' className='check' checked={highPerf}/>\n\t\t\t\t\t\t\t<div className='toggleSlider round' />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={['header-button', pairingStyles.pairingRound, 'switchContainer'].join(' ')}>\n\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t<div>Full Screen</div>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<div className='toggleSwitch' onClick={() => setFullScreen(!fullScreen)}>\n\t\t\t\t\t\t\t<input type='checkbox' className='check' checked={fullScreen}/>\n\t\t\t\t\t\t\t<div className='toggleSlider round' />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className={pairingStyles.description}>Hover to view team names.</div>\n\t\t\t\t<div className={['chartContainer', 'rankings'].join(' ')}>\n\t\t\t\t\t{orderedChart}\n\t\t\t\t\t{order && detailed ? <div className='chartKey' style={isMobile() ? {} : {\n\t\t\t\t\t\tvisibility: size < 10 ? 'hidden' : 'visible',\n\t\t\t\t\t\tgridTemplateRows: `repeat(${key.length}, ${size}px)`,\n\t\t\t\t\t\tleft: `calc(${(lastColumn + 0) / (totalRounds - 1) } * 100%)`,\n\t\t\t\t\t\tfontSize: (Math.min(size, 25) - 3) + 'px',\n\t\t\t\t\t\tmarginTop: size > 21.7 ? '2px' : (size + 6) + 'px'\n\t\t\t\t\t}}>\n\t\t\t\t\t\t{key.map((meta: ReactElement, i: number) => {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<div key={['id', i].join('.')} className='playerLabel'>\n\t\t\t\t\t\t\t\t\t<hr style={{\n\t\t\t\t\t\t\t\t\t\tdisplay: isMobile() || lastColumn >= totalRounds - 1 ? 'none' : 'block',\n\t\t\t\t\t\t\t\t\t\twidth: 0.8 / (totalRounds + 2) * (window.innerWidth - 60)\n\t\t\t\t\t\t\t\t\t}}/>\n\t\t\t\t\t\t\t\t\t<div>{meta}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div> : null}\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t\t<FullScreen className={styles.fsChart} useState={[fullScreen, setFullScreen]}>\n\t\t\t\t<div className={styles.header}>\n\t\t\t\t\t<div className={styles.title}>\n\t\t\t\t\t\t{props.status.name}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={styles.subtitle}>\n\t\t\t\t\t\t{columns[defGraph].mobile}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{orderedChart}\n\t\t\t\t{order && detailed && size > 15 ? <div className='chartKey' style={isMobile() ? {} : {\n\t\t\t\t\tvisibility: size < 10 ? 'hidden' : 'visible',\n\t\t\t\t\tgridTemplateRows: `repeat(${key.length}, ${size}px)`,\n\t\t\t\t\tleft: `calc(${(lastColumn + 0) / (totalRounds - 1) } * 100%)`,\n\t\t\t\t\tfontSize: (Math.min(size, 25) - 3) + 'px',\n\t\t\t\t\tmarginTop: size > 21.7 ? '2px' : (size + 6) + 'px'\n\t\t\t\t}}>\n\t\t\t\t\t{key.map((meta: ReactElement, i: number) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div key={['id', i].join('.')} className='playerLabel'>\n\t\t\t\t\t\t\t\t<hr style={{\n\t\t\t\t\t\t\t\t\tdisplay: isMobile() || lastColumn >= totalRounds - 1 ? 'none' : 'block',\n\t\t\t\t\t\t\t\t\twidth: 0.8 / (totalRounds + 2) * (window.innerWidth - 60)\n\t\t\t\t\t\t\t\t}}/>\n\t\t\t\t\t\t\t\t<div>{meta}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)\n\t\t\t\t\t})}\n\t\t\t\t</div> : null}\n\t\t\t\t<div className={styles.name}>\n\t\t\t\t\tResults by ScorchChess\n\t\t\t\t</div>\n\t\t\t\t<div className={styles.url}>\n\t\t\t\t\thttps://scorchapp.co.uk\n\t\t\t\t</div>\n\t\t\t</FullScreen>\n\t\t</>\n\t);\n}","import React, { ReactElement } from 'react';\nimport './App.scss';\n\n\nfunction NotFound(): ReactElement {\n\treturn <div id='main'>\n\t\t<div className='container' style={{\n\t\t\tdisplay: 'flex',\n\t\t\tflexDirection: 'column',\n\t\t\talignItems: 'center',\n\t\t\twidth: 'max-content',\n\t\t\talignSelf: 'center'\n\t\t}}>\n\t\t\t<img src={process.env.PUBLIC_URL + '/logo512.png'} style={{width: 256, height: 256}} alt='Not-Found'/>\n\t\t\t<div>PAGE NOT FOUND</div>\n\t\t</div>\n\t\t<div className='container'>\n\t\t\tThink this is a mistake? Check out our <a href='https://twitter.com/scorchchess' rel='noopener noreferrer' target='_blank'>Twitter page</a> for the latest maintenance notices. Tweet <a href='https://twitter.com/scorchchess' rel='noopener noreferrer' target='_blank'>@scorchchess</a> if you think there's an error.\n\t\t</div>\n\t</div>;\n}\n\nexport default NotFound;\n","export const months = ['January', 'Febuary', 'March', 'April', 'May', 'June', 'July',\n                      'August', 'September', 'October', 'November', 'December']\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { months } from './constants'\n\nclass BoardHeader extends React.Component {\n  render() {\n    const { headerInfo } = this.props\n\n    if (!headerInfo) return null\n\n\tconst link = headerInfo.Link;\n    const whiteName = headerInfo.White\n    const blackName = headerInfo.Black\n    const whiteTeam = headerInfo.WhiteTeam\n    const blackTeam = headerInfo.BlackTeam\n    const blackElo = headerInfo.BlackElo\n    const whiteElo = headerInfo.WhiteElo\n\tconst round = headerInfo.Round\n\tconst game = headerInfo.Game\n    const result = headerInfo.Result\n    const event = headerInfo.Event\n    const site = headerInfo.Site\n    const date = headerInfo.Date.split('.')\n    const textDate = date && `${date[2]} ${months[new Number(date[1]) - 1]} ${date[0]}`\n    const eventInfo = event && site ? ` ${event} | ${site} | ${result} ` : null\n    const gameInfo = textDate && round && game ? ` ${textDate} | Round ${round} | Game ${game} ` : null\n\n    const pgnHeaderStyles = {\n      padding: '5px',\n    }\n\n    const nameStyles = {\n      fontWeight: 'bold',\n      marginBottom: '0.25rem'\n    }\n\n    const detailStyles = {\n      fontSize: '14px'\n    }\n\n    return (\n      <div className=\"pgnHeader\" style={pgnHeaderStyles}>\n        {link ? \n\t\t\t<a href={link} rel='noopener noreferrer' target='_blank' style={nameStyles}>{whiteName} ({whiteElo}) vs. {blackName} ({blackElo})</a> :\n\t\t\t<div style={nameStyles}>{whiteName} ({whiteElo}) vs. {blackName} ({blackElo})</div>\n\t\t}\n        {whiteTeam || blackTeam ? <div style={nameStyles}>{whiteTeam} vs. {blackTeam}</div> : null}\n        <div style={detailStyles}>{eventInfo}</div>\n        <div style={detailStyles}>{gameInfo}</div>\n      </div>\n    )\n  }\n}\n\nBoardHeader.propTypes = {\n  headerInfo: PropTypes.object.isRequired\n}\n\n\nexport default BoardHeader\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { FaDownload } from 'react-icons/fa'\n\nclass Download extends React.Component {\n\n  _handleDownload = () => {\n    const { onDownload } = this.props\n\n    if(typeof onDownload !== 'function') return\n\n    onDownload()\n  }\n\n  render() {\n    return (\n      <div onClick={this._handleDownload} style={this.props.iconStyles}>\n        <FaDownload />\n      </div>\n    )\n  }\n}\n\nDownload.propTypes = {\n  onDownload: PropTypes.func.isRequired,\n  iconStyles: PropTypes.object.isRequired\n}\n\nexport default Download\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { FaAngleLeft } from 'react-icons/fa'\n\nclass PreviousMove extends React.Component {\n\n  _handlePreviousMove = () => {\n    const { onPreviousMove } = this.props\n\n    if(typeof onPreviousMove !== 'function') return\n\n    onPreviousMove()\n  }\n\n  render() {\n    return (\n      <div onClick={this._handlePreviousMove} style={this.props.iconStyles}>\n        <FaAngleLeft />\n      </div>\n    )\n  }\n}\n\nPreviousMove.propTypes = {\n  onPreviousMove: PropTypes.func.isRequired,\n  iconStyles: PropTypes.object.isRequired\n}\n\nexport default PreviousMove\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { FaAngleRight } from 'react-icons/fa'\n\nclass NextMove extends React.Component {\n\n  _handleNextMove = () => {\n    const { onNextMove } = this.props\n\n    if(typeof onNextMove !== 'function') return\n\n    onNextMove()\n  }\n\n  render() {\n    return (\n      <div onClick={this._handleNextMove} style={this.props.iconStyles}>\n\t\t  <FaAngleRight />\n      </div>\n    )\n  }\n}\n\nNextMove.propTypes = {\n  onNextMove: PropTypes.func.isRequired,\n  iconStyles: PropTypes.object.isRequired\n}\n\nexport default NextMove\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { FaStepForward } from 'react-icons/fa'\n\nclass LastMove extends React.Component {\n\n  _handleLastMove = () => {\n    const { onLastMove } = this.props\n\n    if(typeof onLastMove !== 'function') return\n\n    onLastMove()\n  }\n\n  render() {\n    return (\n      <div onClick={this._handleLastMove} style={this.props.iconStyles}>\n        <FaStepForward />\n      </div>\n    )\n  }\n}\n\nLastMove.propTypes = {\n  onLastMove: PropTypes.func.isRequired,\n  iconStyles: PropTypes.object.isRequired\n}\n\nexport default LastMove\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { FaStepBackward } from 'react-icons/fa'\n\nclass Reset extends React.Component {\n\n  _handleReset = () => {\n    const { onReset } = this.props\n\n    if(typeof onReset !== 'function') return\n\n    onReset()\n  }\n\n  render() {\n    return (\n      <div onClick={this._handleReset} style={this.props.iconStyles}>\n        <FaStepBackward />\n      </div>\n    )\n  }\n}\n\nReset.propTypes = {\n  onReset: PropTypes.func.isRequired,\n  iconStyles: PropTypes.object.isRequired\n}\n\nexport default Reset\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { FaUndo } from 'react-icons/fa'\n\nclass Flip extends React.Component {\n\n  _handleFlipBoard = () => {\n    const { onFlipBoard } = this.props\n\n    if(typeof onFlipBoard !== 'function') return\n\n    onFlipBoard()\n  }\n\n  render() {\n    const { iconStyles } = this.props\n    const flipIconStyles = JSON.parse(JSON.stringify(iconStyles))\n\n    return (\n      <div onClick={this._handleFlipBoard} style={flipIconStyles}>\n\t\t  <FaUndo />\n      </div>\n    )\n  }\n}\n\nFlip.propTypes = {\n  onFlipBoard: PropTypes.func.isRequired,\n  iconStyles: PropTypes.object.isRequired\n}\n\nexport default Flip\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { FaPause, FaPlay } from 'react-icons/fa'\n\nclass Play extends React.Component {\n\n  _handlePlay = () => {\n    const { onPlay } = this.props\n\n    if(typeof onPlay !== 'function') return\n\n    onPlay()\n  }\n\n  render() {\n\n    return (\n      <div onClick={this._handlePlay} style={this.props.iconStyles}>\n        {this.props.isPlaying ? <FaPause /> : <FaPlay />}\n      </div>\n    )\n  }\n}\n\nPlay.propTypes = {\n  onPlay: PropTypes.func.isRequired,\n  isPlaying: PropTypes.bool,\n  iconStyles: PropTypes.object.isRequired\n}\n\nexport default Play\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Download from './Download'\nimport PreviousMove from './PreviousMove'\nimport NextMove from './NextMove'\nimport LastMove from './LastMove'\nimport Reset from './Reset'\nimport Flip from './Flip'\nimport Play from './Play'\n\nclass BoardFooter extends React.Component {\n\n  render() {\n    const {\n      onDownload,\n      onNextMove,\n      onPreviousMove,\n      onReset,\n      onFlipBoard,\n      width,\n      onLastMove,\n      onPlay,\n      isPlaying,\n      fenMove,\n    } = this.props\n\n    const footerStyles = {\n      cursor: 'pointer',\n      display: 'flex',\n      flexDirection: 'row',\n      justifyContent: 'center',\n      alignItems: 'center',\n      width: width,\n      paddingTop: '10px',\n      paddingBottom: '5px'\n    }\n\n    const iconStyles = {\n      paddingLeft: '20px',\n    }\n\n    return (\n      <div className='pgnViewerFooter' style={footerStyles}>\n        {!fenMove && <Reset onReset={onReset} iconStyles={iconStyles} />}\n        {!fenMove && <PreviousMove onPreviousMove={onPreviousMove} iconStyles={iconStyles} />}\n        {!fenMove && <NextMove onNextMove={onNextMove} iconStyles={iconStyles} />}\n        {!fenMove && <LastMove onLastMove={onLastMove} iconStyles={iconStyles} />}\n        {!fenMove && <Play onPlay={onPlay} iconStyles={iconStyles} isPlaying={isPlaying} />}\n        <Flip onFlipBoard={onFlipBoard} iconStyles={iconStyles} />\n        <Download onDownload={onDownload} iconStyles={iconStyles} />\n      </div>\n    )\n  }\n}\n\nBoardFooter.propTypes = {\n  fenMove: PropTypes.number,\n  onDownload: PropTypes.func.isRequired,\n  onNextMove: PropTypes.func.isRequired,\n  onPreviousMove: PropTypes.func.isRequired,\n  onPlay: PropTypes.func.isRequired,\n  onReset: PropTypes.func.isRequired,\n  onFlipBoard: PropTypes.func.isRequired,\n  onLastMove: PropTypes.func.isRequired,\n  onPlay: PropTypes.func.isRequired,\n  width: PropTypes.oneOfType([PropTypes.number, PropTypes.string])\n}\n\nexport default BoardFooter\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nclass Move extends React.Component {\n\n  _handleChangeMove = () => {\n    const { onChangeMove, moveIndex } = this.props\n\n    if(typeof onChangeMove !== 'function') return\n\n    onChangeMove(moveIndex)\n  }\n\n  render() {\n    const { move, moveIndex, currentIndex } = this.props\n    const isWhiteMove = moveIndex % 2 !== 0\n    const whiteMoveNumber = Math.ceil(moveIndex/2) + '.'\n\n    const moveStyles = {\n      cursor: 'pointer',\n      color: 'black',\n      display: 'inline-block',\n    }\n\n    if (currentIndex === moveIndex) {\n      moveStyles.fontWeight = 700\n    }\n\n    return (\n      <span onClick={this._handleChangeMove} style={moveStyles}>\n        {isWhiteMove && whiteMoveNumber}&nbsp;{move}&nbsp;\n      </span>\n    )\n  }\n}\n\nMove.propTypes = {\n  currentIndex: PropTypes.number,\n  moveIndex: PropTypes.number,\n  move: PropTypes.string,\n  onChangeMove: PropTypes.func.isRequired\n}\n\nexport default Move\n","import React, { createRef } from 'react'\nimport PropTypes from 'prop-types'\nimport Move from './Move'\n\nclass MoveList extends React.Component {\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis.moveList = createRef();\n\t}\n\n\tcomponentDidUpdate(prevProps) {\n\t\tif (!this.props.moves) return;\n\t\tlet prevMoves = prevProps.moves || [];\n\t\tif (this.props.moves.length === prevMoves.length) return;\n\t\tif (this.moveList && this.moveList.current) {\n\t\t\tthis.moveList.current.scrollTop = this.moveList.current.scrollHeight;\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tif (this.moveList && this.moveList.current) {\n\t\t\tthis.moveList.current.scrollTop = this.moveList.current.scrollHeight;\n\t\t}\n\t}\n\n  render() {\n    const { result, moves, currentIndex, onChangeMove, startAtMove, endAtMove, fenMove } = this.props\n\n\tif (!moves) return null;\n    return (\n      <div className=\"pgnViewerMoveList\" ref={this.moveList}>\n        {!fenMove &&\n          moves.map((move, index) => {\n            if(index < startAtMove - 1 || index > endAtMove - 1) {\n              return null\n            } else {\n              return (\n                <Move\n                  onChangeMove={onChangeMove}\n                  key={index}\n                  currentIndex={currentIndex}\n                  move={move}\n                  moveIndex={index+1}\n                />\n              )\n            }\n          })\n        }\n        {fenMove &&\n          <div>{fenMove % 2 === 0 ? 'White' : 'Black'} to move</div>\n        }\n\t\t{<span className='bold'>{result}</span>}\n      </div>\n    )\n  }\n}\n\nMoveList.propTypes = {\n  currentIndex: PropTypes.number,\n  moves: PropTypes.array,\n  onChangeMove: PropTypes.func.isRequired,\n  fenMove: PropTypes.number,\n  startAtMove: PropTypes.number,\n  endAtMove: PropTypes.number,\n  width: PropTypes.oneOfType([PropTypes.number, PropTypes.string])\n}\n\nexport default MoveList\n","const baseStyles = {\n  base: {\n    display: 'flex',\n    justifyContent: 'center',\n    flexDirection: 'row',\n  },\n\n  wrapper: {\n    width: 500,\n    background: 'white',\n  }\n}\n\nexport default baseStyles\n","import baseStyles from './baseStyles'\n\nconst getActiveSquare = (moves, index) => {\n  const isWhiteMove = (index-1) % 2 === 0\n  let activeSquare = null\n\n  if(moves && index) {\n    switch (moves[index-1]) {\n      case 'O-O':\n        activeSquare = isWhiteMove ? 'g1' : 'g8'\n        break\n      case 'O-O-O':\n        activeSquare = isWhiteMove ? 'c1' : 'c8'\n        break\n      default:\n        activeSquare = moves[index-1].match(/[a-z][1-8]/gm)[0]\n    }\n  }\n\n  return activeSquare\n}\n\nconst getBaseStyles = (params) => {\n  const { windowWidth, backgroundColor, defaultWidth } = params\n  const isScreenMobile = windowWidth && windowWidth < 768\n  const width = isScreenMobile ? '100%' : defaultWidth\n  const flexDirection = isScreenMobile ? 'column' : 'row'\n  const stylesToModify = []\n\n  stylesToModify.push({ area: 'base', 'stylePair': ['width', width] })\n  stylesToModify.push({ area: 'base', 'stylePair': ['flexDirection', flexDirection] })\n  stylesToModify.push({ area: 'wrapper', 'stylePair': ['width', width] })\n  stylesToModify.push({ area: 'wrapper', 'stylePair': ['background', backgroundColor] })\n\n  const styles = setStyle(stylesToModify)\n\n  return { width, isMobile: isScreenMobile, baseStyles: styles.base, wrapperStyles: styles.wrapper }\n}\n\nconst setStyle = (stylesToModify) => {\n  const styleClone = JSON.parse(JSON.stringify(baseStyles))\n\n  for (const style of stylesToModify) {\n    styleClone[style.area][style.stylePair[0]] = style.stylePair[1]\n  }\n\n  return styleClone\n}\n\nexport { getActiveSquare, getBaseStyles }\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Chess from 'chess.js'\nimport Chessboard from 'reactjs-chessboard'\nimport BoardHeader from './BoardHeader'\nimport BoardFooter from './Footer/BoardFooter'\nimport MoveList from './Moves/MoveList'\nimport { getActiveSquare, getBaseStyles } from './helpers'\n\nclass Viewer extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      chess: null,\n      moves: null,\n      index: null,\n      headerInfo: null,\n      isPlaying: null,\n      isLoaded: null,\n      startAtMove: null,\n      fenMove: null,\n      endAtMove: null,\n      windowWidth: window && window.innerWidth,\n      orientation: this.props.orientation\n    }\n  }\n\n  _updateDimensions = () => {\n    this.setState({ windowWidth: window && window.innerWidth })\n  }\n\n  _makeIncreasingMoves = ({ numberOfMoves, reset }) => {\n    const { chess, moves, index: currentIndex } = this.state\n    let index = reset ? 0 : new Number(currentIndex)\n\n    for(let i=0;i < numberOfMoves;i++) {\n      chess.move(moves[index])\n      index++\n    }\n\n    this.setState({ chess: chess, index: index })\n  }\n\n  _handleNextMove = () => {\n    const { moves, chess, index: currentIndex, endAtMove } = this.state\n    let index = new Number(currentIndex);\n\n    if(index >= moves.length || currentIndex === endAtMove) return this._handleReset();\n\n    chess.move(moves[index])\n    index++\n\n    this.setState({ chess: chess, index: index })\n  }\n\n  _handlePreviousMove = () => {\n    const { chess, index: currentIndex, startAtMove } = this.state\n    let index = new Number(currentIndex)\n\n    if(index <= 0 || currentIndex === startAtMove) return \n\n    chess.undo()\n    index--\n\n    this.setState({ chess: chess, index: index })\n  }\n\n  _handleReset = () => {\n    const { chess, startAtMove } = this.state\n    const index = 0\n\n    chess.reset()\n\n    if(startAtMove) {\n      this._makeIncreasingMoves({ numberOfMoves: startAtMove, reset: true })\n    } else {\n      this.setState({ chess: chess, index: index })\n    }\n  }\n\n  _handleLastMove = () => {\n    const { moves, index, endAtMove } = this.state\n\n    if(index >= moves.length || index === endAtMove) return\n\n    const moveDifference = endAtMove ? endAtMove - index : moves.length - index\n    this._makeIncreasingMoves({ numberOfMoves: moveDifference })\n  }\n\n  _handleFlipBoard = () => {\n    this.setState({ orientation: this.state.orientation === 'w' ? 'b': 'w' })\n  }\n\n  _handlePlay = () => {\n    const { moves, chess, index, isPlaying } = this.state\n\n    if(!isPlaying) {\n\t\tif (index >= moves.length) {\n\t\t\tthis._handleReset();\n\t\t}\n\t\tthis._handleNextMove();\n\t}\n\n    this.setState({ isPlaying: !isPlaying })\n  }\n\n  _handleChangeMove = (moveIndex) => {\n    const { chess, index } = this.state\n\n    if (moveIndex === index) return\n\n    if (moveIndex < index) {\n      for (let i=0;i < (index - moveIndex);i++) {\n        chess.undo()\n      }\n\n      this.setState({ chess: chess, index: moveIndex })\n    } else {\n      const moveDifference = moveIndex - index\n\n      this._makeIncreasingMoves({ numberOfMoves: moveDifference})\n    }\n  }\n\n  _handleDownload = () => {\n\tconst { headerInfo, fenMove, chess } = this.state;\n    const element = document.createElement('a')\n    const fileContent = fenMove ? chess.fen() : this.props.pgnInformation\n    const fileFormat = fenMove ? 'txt' : 'pgn'\n    const file = new Blob([fileContent], {type: 'text/plain'})\n    const whiteLastName = headerInfo.White.split(' ').pop();\n    const blackLastName = headerInfo.Black.split(' ').pop();\n\n    element.href = URL.createObjectURL(file)\n    element.download = `${whiteLastName}_vs_${blackLastName}_${headerInfo.Date}.${fileFormat}`\n    element.click()\n  }\n\n  componentDidMount() {\n    const { pgnInformation } = this.props\n    const chess = new Chess();\n    let index = 0\n\t\n\n    const pgnString = pgnInformation.trim().replace(/\\[/g, '')\n    if(!pgnString) return null\n\tconst pgnArray = pgnString.split(']').map(line => line.trim());\n\tchess.load_pgn(pgnInformation);\n\t//chess.load_pgn(pgnArray[pgnArray.length - 1]);\n\n    for (let i=0;i < pgnArray.length - 2;i++) {\n\t  const headerArr = pgnArray[i].split(' \"');\n\t  if (!headerArr[1]) chess.header((headerArr[0]).replace(/\\\"/g, ''));\n      else chess.header((headerArr[0]).replace(/\\\"/g, ''), (headerArr[1]).replace(/\\\"/g, ''))\n    }\n\n    const headerInfo = chess.header()\n    const moves = chess.history()\n    chess.reset()\n\n    const startAtMove = (headerInfo.StartAtMove * 2) - 1\n    const endAtMove = headerInfo.EndAtMove * 2\n    const fen = headerInfo.Fen && headerInfo.Fen.split('')\n    const isWhiteMove = fen && fen.pop() === 'b'\n    const fenMoveNumber = fen && fen.join('')\n\tconst fenMove = isWhiteMove ? fenMoveNumber * 2 : (fenMoveNumber * 2) - 1\n\n    if(startAtMove) {\n      for (let i=0;i < startAtMove;i++) {\n        chess.move(moves[index])\n        index++\n      }\n    } else if(fen) {\n      for (let i=0;i < fenMove;i++) {\n        chess.move(moves[index])\n        index++\n      }\n\t}\n\t\n\tif(this.props.startAtLatest) {\n\t\tfor (let i = 0; i < moves.length; i++) {\n\t\t\tchess.move(moves[index]);\n\t\t\tindex++;\n\t\t}\n\t}\n\n    this.setState({\n      chess: chess,\n      moves: moves,\n      index: index,\n      startAtMove: startAtMove,\n      endAtMove: endAtMove,\n      fenMove: fen ? fenMove : null,\n      headerInfo: headerInfo,\n    })\n\tthis._updateDimensions();\n    window.addEventListener('resize', this._updateDimensions)\n    window.addEventListener('load', this._updateDimensions)\n    window.addEventListener('orientationchange', this._updateDimensions)\n\t//this._updateDimensions();\n  }\n\n  componentDidUpdate() {\n    if(this.state.isPlaying) {\n      this.timeoutID = setTimeout(() => this._handleNextMove(), 1000)\n    } else {\n      clearTimeout(this.timeoutID)\n    }\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this._updateDimensions)\n    window.removeEventListener('load', this._updateDimensions)\n    window.removeEventListener('orientationchange', this._updateDimensions)\n  }\n\n  render() {\n    const { blackSquareColor, whiteSquareColor, width: defaultWidth, backgroundColor, showCoordinates } = this.props\n    const {\n      chess,\n      moves,\n      index,\n      headerInfo,\n      orientation,\n      isPlaying,\n      windowWidth,\n      startAtMove,\n      endAtMove,\n      fenMove,\n    } = this.state\n    const { baseStyles, wrapperStyles, isMobile, width } = getBaseStyles({ windowWidth, backgroundColor, defaultWidth })\n\tconst activeSquare = getActiveSquare(moves, index);\n\t\n    return (\n      <div className=\"pgnWrapper\" style={wrapperStyles}>\n        {headerInfo && <BoardHeader headerInfo={headerInfo} width={width} />}\n        <div className=\"pgnViewerMain\" onWheel={(e) => {\n\t\t\te.stopPropagation();\n\t\t}}>\n          <Chessboard\n            blackSquareColour={blackSquareColor}\n            fen={chess && chess.fen() || 'start'}\n            orientation={orientation}\n            showCoordinates={showCoordinates}\n            activeSquare={activeSquare}\n            style={{\n              border: '2px solid lightgrey',\n            }}\n            whiteSquareColour={whiteSquareColor}\n            width={isMobile ? width : (2/3)*width}\n            height={isMobile ? width : (2/3)*width}\n          />\n          {!isMobile &&\n            <MoveList\n              onChangeMove={this._handleChangeMove}\n              currentIndex={index}\n              moves={moves}\n              width={(1/3)*width}\n              startAtMove={startAtMove}\n              endAtMove={endAtMove}\n              fenMove={fenMove}\n\t\t\t  result={headerInfo ? headerInfo.Result : null}\n            />\n          }\n        </div>\n        <BoardFooter\n          isPlaying={isPlaying}\n          onPlay={this._handlePlay}\n          onDownload={this._handleDownload}\n          onFlipBoard={this._handleFlipBoard}\n          onNextMove={this._handleNextMove}\n          onPreviousMove={this._handlePreviousMove}\n          onReset={this._handleReset}\n          fenMove={fenMove}\n          onLastMove={this._handleLastMove}\n          width={width}\n        />\n        {isMobile &&\n          <MoveList\n            onChangeMove={this._handleChangeMove}\n            currentIndex={index}\n            moves={moves}\n            width={width}\n            startAtMove={startAtMove}\n            endAtMove={endAtMove}\n            fenMove={fenMove}\n\t\t\tresult={headerInfo ? headerInfo.Result : null}\n          />\n        }\n      </div>\n    )\n  }\n}\n\nViewer.propTypes = {\n  backgroundColor: PropTypes.string,\n  blackSquareColour: PropTypes.string,\n  pgnInformation: PropTypes.string.isRequired,\n  width: PropTypes.number\n}\n\nexport default Viewer\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport PropTypes from 'prop-types'\nimport Viewer from './Viewer'\n\nclass PgnViewer extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = { pgns: null }\n  }\n\n  makeViewer = ({ pgnInformation }) => {\n    const {\n      blackSquareColor,\n      whiteSquareColor,\n      orientation,\n      width,\n      backgroundColor,\n\t  showCoordinates,\n\t  startAtLatest\n    } = this.props\n\n    return (\n      <Viewer\n        pgnInformation={pgnInformation}\n        blackSquareColor={blackSquareColor}\n        whiteSquareColor={whiteSquareColor}\n        width={width}\n        orientation={orientation}\n        backgroundColor={backgroundColor}\n        showCoordinates={showCoordinates}\n\t\tstartAtLatest={startAtLatest}\n      />\n    )\n  }\n\n  createInnerHtml = () => {\n    return {__html: this.props.children};\n  }\n\n  additionalHTMLModification = () => {\n    const { nodeToModify, nodeModification } = this.props\n    const nodes = ReactDOM.findDOMNode(this).querySelectorAll(nodeToModify)\n\n    if(typeof nodeModification !== 'function' || !nodeToModify) return null\n\n    for (let i = 0;i < nodes.length;i++) {\n        nodeModification(nodes[i])\n    }\n  }\n\n  setPgn = (pgns) => {\n    const nodes = ReactDOM.findDOMNode(this).querySelectorAll('pgn')\n\n    for(let i=0;i<nodes.length;i++) {\n      ReactDOM.render(this.makeViewer({ pgnInformation: pgns[i] }), nodes[i])\n    }\n  }\n\n  componentDidMount() {\n    const nodes = ReactDOM.findDOMNode(this).querySelectorAll('pgn')\n    const pgns = []\n\n    for(let i=0;i < nodes.length;i++) {\n      pgns.push(nodes[i].innerHTML.slice(0))\n    }\n\n    this.setState({ pgns: pgns })\n\n    this.additionalHTMLModification()\n    this.setPgn(pgns)\n  }\n\n  componentDidUpdate() {\n    this.additionalHTMLModification()\n    this.setPgn(this.state.pgns)\n  }\n\n  render() {\n    const { innerHTML, children } = this.props\n\n    return (\n      <div>\n        {innerHTML && <div dangerouslySetInnerHTML={this.createInnerHtml()}></div>}\n        {!innerHTML && <div>{this.makeViewer({ pgnInformation: children })}</div>}\n      </div>\n    )\n  }\n}\n\nPgnViewer.propTypes = {\n  backgroundColor: PropTypes.string,\n  blackSquareColor: PropTypes.string,\n  nodeToModify: PropTypes.string,\n  nodeModification: PropTypes.func,\n  orientation: PropTypes.string,\n  showCoordinates: PropTypes.bool,\n  whiteSquareColor: PropTypes.string,\n  width: PropTypes.number\n}\n\nPgnViewer.defaultProps = {\n  backgroundColor: '#e1e5ed',\n  blackSquareColor: 'steelblue',\n  orientation: 'w',\n  showCoordinates: true,\n  whiteSquareColor: 'aliceblue',\n  width: 600\n}\n\nexport default PgnViewer\n","import { useState, useDebugValue, useMemo } from 'react';\n\nexport function useStateWithLabel(initialValue: any, name: string) {\n    const [value, setValue] = useState(initialValue);\n    useDebugValue(`${name}: ${value}`);\n    return [value, setValue];\n}\n\nexport function useMemoWithLabel(factory: () => any, deps: React.DependencyList | undefined, name: string) {\n    const value = useMemo(factory, deps);\n    useDebugValue(name);\n    return value;\n}","import React, { useReducer, useCallback, useEffect, useState, useMemo, useRef, RefObject } from 'react';\nimport ChessWebAPI, { BoardData, MatchData, Game, ProfileData, TeamData } from 'chess-web-api';\nimport * as regexes from '../utils/regexes';\nimport styles from '../css/chesscom.module.css';\nimport '../css/react-pgn-viewer.css';\nimport { FaChessBoard, FaAngleLeft, FaAngleRight, FaExclamationTriangle } from 'react-icons/fa';\nimport { AiOutlineLoading3Quarters } from 'react-icons/ai'\nimport PGN from '../components/react-pgn-viewer/';\nimport Match, { ChessComTeam } from '../models/Match';\nimport bcrypt from 'bcryptjs';\nimport { POST, GET, saltRounds } from '../utils/requests';\nimport { useMemoWithLabel } from '../utils/hooks';\nimport { compare } from '../utils/prototype';\n\nexport const Chess = new ChessWebAPI({ queue: true });\n\nexport async function getChessComProfile(username: string): Promise<ProfileData> {\n    return new Promise((res, rej) => {\n        Chess.dispatch(Chess.getPlayer, (data: { body: ProfileData }, error) => {\n            if (error) return rej(error);\n            res(data.body);\n        }, [username]);\n    });\n}\n\nexport async function getChessComTeam(id: string): Promise<TeamData> {\n    return new Promise((res, rej) => {\n        Chess.dispatch(Chess.getClub, (data: { body: TeamData }, error) => {\n            if (error) return rej(error);\n            res(data.body);\n        }, [id]);\n    });\n}\n\nexport async function loadChessComGames(id: number, board: number): Promise<BoardData> {\n    return new Promise((res, rej) => {\n        Chess.dispatch(Chess.getTeamLiveMatchBoard, (data: { body: BoardData }, error) => {\n            if (error) return rej(error);\n            res(data.body);\n        }, [id, board]);\n    });\n}\n\nexport async function loadChessComMatch(id: number): Promise<MatchData> {\n    return new Promise((res, rej) => {\n        Chess.dispatch(Chess.getTeamLiveMatch, (data: { body: MatchData }, error) => {\n            if (error) return rej(error);\n            res(data.body);\n        }, [id]);\n    });\n}\n\ninterface ChessComProps {\n\tid: string\n\tmatch: Match\n\tsetMatch: (match: Match) => void\n\tsetFinished: (id: string) => void\n\tloadData: boolean\n\texpanded: boolean\n\tenforceBoards: number | undefined\n\tround: number\n\tteams: ChessComTeam[]\n}\n\nexport default function ChessCom(props: ChessComProps) {\n\n\tconst [boards, setBoards] = useState(20);\n\tuseEffect(() => {\n\t\tif (props.match.players) setBoards(typeof props.match.players === 'string' ? parseInt(props.match.players) : props.match.players);\n\t\telse if (props.enforceBoards) setBoards(props.enforceBoards);\n\t}, [props.enforceBoards, setBoards, props.match.players]);\n    const [games, setGame] = useReducer((state: {games: Game[], boardScores: {[key: string]: number}}[], action: {\n        board: number,\n        boardScores: {[key: string]: number}\n        games: Game[]\n    }) => {\n        let arr = state.slice(0);\n        arr[action.board] = {\n            boardScores: action.boardScores,\n            games: action.games\n        };\n        return arr;\n    }, []);\n\tconst [id, setID] = useState(0);\n\tconst teamDict = useMemoWithLabel(() => {\n\t\tlet dict = {} as {[key: string]: number};\n\t\tif (!props.match.teams) return dict;\n\t\tfor (let i = 0; i < props.match.teams.length; i++) {\n\t\t\tlet t = props.match.teams[i];\n\t\t\tfor (let player of t.players) {\n\t\t\t\tdict[player.username.toLowerCase()] = i;\n\t\t\t}\n\t\t}\n\t\treturn dict;\n\t}, [props.match.teams], 'teamDict');\n\tconst matchFinished: boolean = useMemoWithLabel(() => props.match.isFinished, [props.match], 'matchFinished');\n    const [boardsFinished, setFinished] = useReducer((state: boolean[], action: {\n       board: number,\n       set: boolean\n    }) => {\n        let arr = state.slice(0);\n        arr[action.board] = action.set;\n        return arr;\n\t}, []);\n\tconst [gamesLength, setGamesLength] = useState(0);\n\n\tconst fetchMatch = useCallback(async () => {\n\t\tif (!props.match.link) return;\n        let matches = props.match.link.match(regexes.chessCom);\n        if (!matches) return console.error('Invalid URL: ', props.match.link);\n\t\tlet teamID = Number(matches[1]);\n\t\tif (!teamID) return;\n\t\tawait loadChessComMatch(teamID as number)\n\t\t\t.catch((e: Error | MatchData) => {\n\t\t\t\tif (e) console.error(e);\n\t\t\t\treturn {} as MatchData;\n\t\t\t})\n\t\t\t.then((body) => {\n\t\t\t\tif (body && body.teams) {\n\t\t\t\t\tlet teams = Object.values(body.teams);\n\t\t\t\t\tif (props.match.w.chessCom || props.match.b.chessCom) {\n\t\t\t\t\t\tif (props.match.w.chessCom && compare(teams[1].name, props.match.w.name || props.match.w.firstName) < 0.45) {\n\t\t\t\t\t\t\tteams = teams.reverse();\n\t\t\t\t\t\t} else \n\t\t\t\t\t\tif (props.match.b.chessCom && compare(teams[0].name, props.match.b.name || props.match.b.firstName) < 0.45) {\n\t\t\t\t\t\t\tteams = teams.reverse();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif ((body.start_time && Date.now() < body.start_time * 1000) || body.status === 'finished') {\n\t\t\t\t\t\tsetID(teamID);\n\t\t\t\t\t\tprops.setMatch(Object.assign(props.match, {\n\t\t\t\t\t\t\tbodyStatus: body.status,\n\t\t\t\t\t\t\tstartTime: body.start_time * 1000,\n\t\t\t\t\t\t\tendTime: body.end_time ? body.end_time * 1000 : undefined,\n\t\t\t\t\t\t\tplayers: body.boards,\n\t\t\t\t\t\t\tteams,\n\t\t\t\t\t\t\tscores: teams.map(t => t.score)\n\t\t\t\t\t\t}));\n\t\t\t\t\t\treturn Promise.reject();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn body;\n\t\t\t})\n\t\t\t.then((body) => {\n\t\t\t\tGET({\n\t\t\t\t\turl: '/tournament/' + props.match.tournamentId + '/scrapeChessComTeamPage',\n\t\t\t\t\tparams: {\n\t\t\t\t\t\turl: props.match.link\n\t\t\t\t\t}\n\t\t\t\t})\t\n\t\t\t\t.then((meta) => {\n\t\t\t\t\t/* eslint-disable-next-line no-throw-literal */\n\t\t\t\t\tif (!meta.Teams) throw null;\n\t\t\t\t\tlet teams = Object.values(meta.Teams) as ChessComTeam[];\n\t\t\t\t\tif (props.match.w.chessCom && compare(teams[1].name, props.match.w.name || props.match.w.firstName) < 0.45) {\n\t\t\t\t\t\tteams = teams.reverse();\n\t\t\t\t\t} else \n\t\t\t\t\tif (props.match.b.chessCom && compare(teams[0].name, props.match.b.name || props.match.b.firstName) < 0.45) {\n\t\t\t\t\t\tteams = teams.reverse();\n\t\t\t\t\t}\n\t\t\t\t\t/* eslint-disable-next-line no-throw-literal */\n\t\t\t\t\tif (!meta['Registration Open'] && !meta['Start Time'] && !meta['Finished On']) throw null;\n\n\t\t\t\t\tlet bTeams = Object.values(body.teams || {});\n\t\t\t\t\tif (body.teams && bTeams[0] && bTeams[0].players.length && (!teams[0] || !teams[0].players.length)) {\n\t\t\t\t\t\tteams[0].players = bTeams.find(t => t['@id'] === teams[0]['@id'])?.players || [];\n\t\t\t\t\t\tteams[1].players = bTeams.find(t => t['@id'] === teams[1]['@id'])?.players || [];\n\t\t\t\t\t}\n\t\t\t\t\tsetID(teamID);\n\t\t\t\t\tprops.setMatch(Object.assign(props.match, {\n\t\t\t\t\t\tregistrationTime: meta['Registration Open'] ? new Date(meta['Registration Open']).valueOf() : undefined,\n\t\t\t\t\t\tmetaStatus: meta['Status'],\n\t\t\t\t\t\tstartTime: body && body.start_time ? body.start_time * 1000 : meta['Start Time'] ? new Date(meta['Start Time']).valueOf() : undefined,\n\t\t\t\t\t\tendTime: meta['Finished On'] ? new Date(meta['Finished On']).valueOf() : undefined,\n\t\t\t\t\t\tplayers: meta['Players per Team'],\n\t\t\t\t\t\tteams,\n\t\t\t\t\t\tscores: teams.map(t => t.score)\n\t\t\t\t\t}));\n\t\t\t\t})\n\t\t\t\t.catch((e) => {\n\t\t\t\t\tif (e) console.error(e);\n\t\t\t\t\tprops.setMatch(Object.assign(props.match, {\n\t\t\t\t\t\taborted: true\n\t\t\t\t\t}));\n\t\t\t\t\tprops.setFinished(props.match.id);\n\t\t\t\t});;\n\t\t\t})\n\t\t\t.catch((e) => {\n\t\t\t\tif (e) console.error(e);\n\t\t\t});\n\t}, [id, props.setMatch, props.match, setID, props.setFinished]);\n\n    useEffect(() => {\n\t\tif (id) return;\n\t\tconsole.log(props.expanded, props.loadData);\n\t\tif (props.expanded || props.loadData) fetchMatch();\n    }, [fetchMatch, props.expanded, props.loadData, id]);\n\n    const ping = useCallback(async () => {\n\t\tif (!id) return;\n        for (let i = 1; i < boards + 1; i++) {\n            if (boardsFinished[i]) continue;\n            let x = loadChessComGames(id, i)\n                .then((fetchedGames) => {\n                    setGame({\n                        games: fetchedGames.games,\n                        boardScores: fetchedGames.board_scores,\n                        board: i\n                    });\n\t\t\t\t\tlet lastGame = fetchedGames.games[fetchedGames.games.length - 1];\n\t\t\t\t\tif (!lastGame) throw new Error('No game data given');\n\t\t\t\t\tif (fetchedGames.games.length > gamesLength) setGamesLength(fetchedGames.games.length);\n                    if (lastGame.end_time) setFinished({board: i, set: true});\n                    return true;\n                })\n                .catch((e) => {\n                    //if (e.message.includes('doesn\\'t have board')) {\n\t\t\t\t\t\tif (i !== 1 || games.length > 2) {\n\t\t\t\t\t\t\tif (boards < i) return true;\n\t\t\t\t\t\t\tif (i === 2 && !games.length) setBoards(i - 2);\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tsetBoards(i - 1);\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t//} else {\n\t\t\t\t\t//\tsetBoards(i - 1);\n\t\t\t\t\t//}\n                    return true;\n\t\t\t\t});\n            if (!props.enforceBoards && !props.match.players && await x === false) break;\n        }\n\n\t}, [id, boards, boardsFinished, games.length, gamesLength, setGamesLength, props.enforceBoards, props.match.players]);\n\t\n\tconst sendGameData = useCallback(async () => {\n\t\tlet match = props.match;\n\t\tlet key = await bcrypt.hash([match.w.id, match.b.id, match.tournamentId, props.round].join('.'), saltRounds);\n\t\tlet pgn = [];\n\t\tfor (let i = 0; i < games.length; i++) {\n\t\t\tif (!games[i] || !games[i].games) continue;\n\t\t\tfor (let j = 0; j < games[i].games.length; j++) {\n\t\t\t\tpgn.push({\n\t\t\t\t\tboard: i,\n\t\t\t\t\tgame: j + 1,\n\t\t\t\t\tpgn: games[i].games[j].pgn\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t\tlet data = {\n\t\t\tidW: match.w.id,\n\t\t\tidB: match.b.id,\n\t\t\ttournamentId: match.tournamentId,\n\t\t\tround: props.round,\n\t\t\tkey,\n\t\t\tfetched: {\n\t\t\t\tstartTime: match.startTime || match.registrationTime,\n\t\t\t\tendTime: match.endTime,\n\t\t\t\tscores: match.teams?.map(t => t.score) || [],\n\t\t\t\tisFinished: match.isFinished || match.isConfirmed\n\t\t\t},\n\t\t\tgames: pgn\n\t\t} \n\t\tawait POST({ url: '/submit/game', data });\n\t\tprops.setFinished(match.id);\n\t}, [games, props.match, props.round, props.setFinished]);\n\n\tconst length = useMemo(() => games.filter(v => v && v).length, [games]);\n\tuseEffect(() => {\n\t\tif (props.match.aborted) {\n\t\t\tsendGameData();\n\t\t\treturn;\n\t\t}\n\t\tif (!boards) {\n\t\t\tif (length) sendGameData();\n\t\t\telse if (games.filter(v => v && v.games.length).length) sendGameData();\n\t\t\treturn;\n\t\t} else {\n\t\t\tif (length >= boards) sendGameData();\n\t\t}\n\t}, [sendGameData, props.match.aborted, games, length, boards])\n\n    useEffect(() => {\n\t\tif (matchFinished && games.length && !boards) return;\n        let x = setInterval(ping, 1000);\n        return () => clearInterval(x);\n\t}, [id, ping,  matchFinished, games.length, boards]);\n\n\tconst summaryRows = useCallback((data, i) => {\n\t\tlet { games, boardScores } = data;\n\t\tlet lastGame = games[games.length - 1];\n\t\tif (!lastGame) return null;\n\t\tlet prop = teamDict[lastGame.white.username.toLowerCase()] === 0 ? lastGame.white : lastGame.black;\n\t\tlet opp = teamDict[lastGame.black.username.toLowerCase()] === 1 ? lastGame.black : lastGame.white;\n\t\treturn [\n\t\t\t<div className={styles.username}>{prop.username}</div>,\n\t\t\t<div className={styles.score}>{boardScores[prop.username.toLowerCase()]}</div>,\n\t\t\t<a href={`#${props.id}.${i}`}>{'#' + i}</a>,\n\t\t\t<div className={styles.score}>{boardScores[opp.username.toLowerCase()]}</div>,\n\t\t\t<div className={styles.username}>{opp.username}</div>\n\t\t];\n\t}, [teamDict, props.id]);\n\n\tconst [focused, setFocused] = useState(0);\n\n\tlet style = games.length ? {} : {gridTemplateColumns: '1fr'}\n    if (!games.length && !boards) return <div>Match has not yet started!</div>\n    if (!games.filter(v => v && v.games.length).length && !boards) return <div>Still waiting for data from Chess.com. Check back later.</div>\n\tif (!games.length) return <div className={styles.loading}><AiOutlineLoading3Quarters /></div>\n\tif (!props.expanded) return null;\n\n    return (\n        <div className={styles.container} style={style}>\n\t\t\t<div className={styles.results}>\n\t\t\t\t<table className='download-table'>\n\t\t\t\t\t<thead>\n\t\t\t\t\t\t{!Object.keys(teamDict).length ?\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<th colSpan={5}>\n\t\t\t\t\t\t\t\t\t<FaExclamationTriangle /> Couldn't fetch player-team identifying data from Chess.com for this match<br />\n\t\t\t\t\t\t\t\t\tCheck back later or contact a dev if this problem persists.\n\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t</tr> :\n\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t}\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<th style={{width: '40%'}}>{props.teams[0]?.name && Object.values(teamDict).includes(0) ? props.teams[0].name : ''}</th>\n\t\t\t\t\t\t\t<th style={{width: '5%'}}></th>\n\t\t\t\t\t\t\t<th style={{width: '10%'}}>Link</th>\n\t\t\t\t\t\t\t<th style={{width: '5%'}}></th>\n\t\t\t\t\t\t\t<th style={{width: '40%'}}>{props.teams[1]?.name && Object.values(teamDict).includes(1) ? props.teams[1].name : ''}</th>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</thead>\n\t\t\t\t\t<tbody>\n\t\t\t\t\t\t{games.map((g, i) => {\n\t\t\t\t\t\t\treturn <tr key={['row', i].join('.')}>\n\t\t\t\t\t\t\t\t{summaryRows(g, i)?.map((cell, j) => {\n\t\t\t\t\t\t\t\t\treturn <td key={['cell', i, j].join('.')}>{cell}</td>\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t})}\n\t\t\t\t\t</tbody>\n\t\t\t\t</table>\n\t\t\t</div>\n\t\t\t{games.map((pairing, i) => <GameViewer\n\t\t\t\tid={props.id}\n\t\t\t\tkey={['game', i].join('.')}\n\t\t\t\tpairing={pairing}\n\t\t\t\tteamDict={teamDict}\n\t\t\t\tteams={props.teams.map(t => t.name) as [string, string]}\n\t\t\t\tround={props.round}\n\t\t\t\tboard={i}\n\t\t\t\tfocused={focused === i}\n\t\t\t\tsetFocused={() => setFocused(i)}\n\t\t\t/>)}\n        </div>\n    );\n}\n\ninterface ViewerProps {\n\tid: string\n\tpairing: { games: Game[], boardScores: {[key: string]: number}}\n\tteamDict: {[key: string]: number}\n\tboard: number\n\tround: number\n\tteams: [string, string]\n\tfocused: boolean\n\tsetFocused: () => void\n}\n\nfunction GameViewer(props: ViewerProps) {\n\n\tconst scores = useMemo(() => Object.entries(props.pairing.boardScores), [props.pairing.boardScores]);\n\tconst [currIndex, setIndex] = useState(props.pairing.games.length - 1);\n\tconst gameRef = useRef(null) as RefObject<HTMLDivElement>;\n\n\tlet rendered = useMemo(() => props.pairing.games.map((g, i) => <SingleGame\n\t\tg={g}\n\t\tround={props.round}\n\t\tboard={props.board}\n\t\tnb={i}\n\t\tteams={props.teams}\n\t\tteamDict={props.teamDict}\n\t/>), [props.pairing.games, props.board, props.round, props.teams, props.teamDict]);\n\n\tconst g = props.pairing.games[currIndex];\n\tconst flip = g && props.teamDict[g.black.username.toLowerCase()]; \n\tlet _scores = flip ? scores.reverse() : scores;\n\n\tuseEffect(() => {\n\t\twindow.dispatchEvent(new Event('resize'));\n\t}, []);\n\n\tconst buttons = useMemo(() => {\n\t\tlet div = gameRef.current;\n\t\tif (!div) return [];\n\t\tlet buttons = Array.from(div.querySelectorAll('.visible .pgnViewerFooter > div'));\n\t\treturn buttons;\n\t}, [gameRef])\n\n\tconst handleScroll = useCallback((ev: Event) => {\n\t\tlet e = ev as WheelEvent;\n\t\tif (e.deltaY < 0) {\n\t\t\tlet button = buttons[1] as HTMLDivElement;\n\t\t\tif (!button) return;\n\t\t\tbutton.click();\n\t\t\te.preventDefault();\n\t\t} else\n\t\tif (e.deltaY > 0) {\n\t\t\tlet button = buttons[2] as HTMLDivElement;\n\t\t\tif (!button) return;\n\t\t\tbutton.click();\n\t\t\te.preventDefault();\n\t\t}\n\t}, [buttons]);\n\tconst handleKeyPress = useCallback((e: KeyboardEvent) => {\n\t\tswitch (e.keyCode) {\n\t\t\tcase 37: {\t//left\n\t\t\t\tlet button = buttons[1] as HTMLDivElement;\n\t\t\t\tif (!button) break;\n\t\t\t\tbutton.click();\n\t\t\t\te.preventDefault();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 39: {\t//right\n\t\t\t\tlet button = buttons[2] as HTMLDivElement;\n\t\t\t\tif (!button) break;\n\t\t\t\tbutton.click();\n\t\t\t\te.preventDefault();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 38: { //up\n\t\t\t\tlet button = buttons[0] as HTMLDivElement;\n\t\t\t\tif (!button) break;\n\t\t\t\tbutton.click();\n\t\t\t\te.preventDefault();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 40: { //down\n\t\t\t\tlet button = buttons[3] as HTMLDivElement;\n\t\t\t\tif (!button) break;\n\t\t\t\tbutton.click();\n\t\t\t\te.preventDefault();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 32: { //space\n\t\t\t\tlet button = buttons[4] as HTMLDivElement;\n\t\t\t\tif (!button) break;\n\t\t\t\tbutton.click();\n\t\t\t\tif (gameRef.current) gameRef.current.scrollIntoView({ behavior: 'smooth' })\n\t\t\t\te.preventDefault();\n\t\t\t\tbreak;\t\t\t\t\n\t\t\t}\n\t\t\tcase 70: { //f\n\t\t\t\tlet button = buttons[5] as HTMLDivElement;\n\t\t\t\tif (!button) break;\n\t\t\t\tbutton.click();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 68: { //d\n\t\t\t\tlet button = buttons[6] as HTMLDivElement;\n\t\t\t\tif (!button) break;\n\t\t\t\tbutton.click();\n\t\t\t\te.preventDefault();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}, [gameRef, buttons]);\n\tuseEffect(() => {\n\t\tif (!props.focused) return;\n\t\tdocument.addEventListener('keydown', handleKeyPress);\n\t\treturn () => document.removeEventListener('keydown', handleKeyPress);\n\t}, [props.focused, handleKeyPress]);\n\n\tconst handleClick = useCallback(() => {\n\t\tlet div = gameRef.current;\n\t\tif (!div) return;\n\t\tprops.setFocused();\n\t}, [gameRef, props.setFocused]);\n\t\n\tif (currIndex < 0) return null;\n\n\treturn (\n\t\t<div id={[props.id, props.board].join('.')} className={styles.wrapper} onClick={handleClick} ref={gameRef}>\n\t\t\t<div className={styles.boardLabel}>\n\t\t\t\t<FaAngleLeft className={[styles.pan, currIndex ? styles.active : styles.null].join(' ')} onClick={() => currIndex ? setIndex(currIndex - 1) : null}/>\n\t\t\t\t<span className='bold'>{_scores[0][1]}</span>\n\t\t\t\t<a href={'https://www.chess.com/live/game/' + g.url.split('/').pop()} target='_blank' rel='noopener noreferrer'>\n\t\t\t\t\t<FaChessBoard />\n\t\t\t\t</a>\n\t\t\t\t<span className='bold'>{_scores[1][1]}</span>\n\t\t\t\t<FaAngleRight className={[styles.pan, currIndex === props.pairing.games.length - 1 ? styles.null : styles.active].join(' ')} onClick={() => currIndex < props.pairing.games.length - 1 ? setIndex(currIndex + 1) : null}/>\n\t\t\t</div>\n\t\t\t{rendered.map((r, i) => <div key={[styles.gameViewWrapper, i].join('.')} className={[styles.gameViewWrapper, i === currIndex ? 'visible' : 'hidden'].join(' ')}>\n\t\t\t\t{r}\n\t\t\t</div>)}\n\t\t</div>\n\t);\n}\n\nfunction SingleGame({g, round, board, nb, teams, teamDict}: {\n\tg: Game\n\tround: number\n\tboard: number\n\tnb: number\n\tteams: [string, string]\n\tteamDict: {[key: string]: number}\n}) {\n\n\tconst flip = teamDict[g.black.username.toLowerCase()];    // team 1 is black\n\tif (!g.pgn) return null;\n\tlet pgn = [\n\t\t`[WhiteTeam \"${flip ? teams[0] : teams[1]}\"]`,\n\t\t`[BlackTeam \"${flip ? teams[1] : teams[0]}\"]`,\n\t\t`[Board \"${board}\"]`,\n\t\t`[Game \"${nb + 1}\"]`,\n\t\tg.pgn.replace('[Round \"-\"]', `[Round \"${round}\"]`)\n\t].join('\\n');\n\n\treturn (\n\t\t<PGN\n\t\t\tinnerHTML={false}\n\t\t\tshowCoordinates={true}\n\t\t\twidth={'100%'}\n\t\t\tstartAtLatest\n\t\t>\n\t\t\t{pgn}\n\t\t</PGN>\n\t);\n}","import React, { useEffect, createRef, useState, useCallback } from \"react\";\n\ninterface FormProps<T> {\n\tonChange: (validOptions: T[]) => void\n\tonSubmit: (value: T) => void\n    action: string\n\toptions: T[]\n\tconvert: (option: T) => string\n\tstyles?: {[key: string]: string}\n\tplaceholder: string\n}\n\nexport default function AutoComplete<T>(props: FormProps<T>) {\n\n\tconst firstInput = createRef() as React.RefObject<HTMLInputElement>;\n\tconst [currChoice, setCurrChoice] = useState(null as T | null);\n    const [focus, mustFocus] = useState(false);\n\n    useEffect(() => {\n        if (!focus) return;\n        if (!firstInput.current) return;\n        firstInput.current.focus();\n\t}, [firstInput, focus]);\n\t\n\tconst handleSubmit = useCallback(() => {\n\t\tif (!currChoice) return;\n\t\tprops.onSubmit(currChoice);\n\t}, [currChoice, props.onSubmit])\n\n\tconst handleKeyDown = useCallback((e: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tswitch (e.keyCode) {\n\t\tcase 13: {\n\t\t\tif (currChoice) {\n\t\t\t\t(e.target as HTMLInputElement).value = '';\n\t\t\t\thandleSubmit();\n\t\t\t}\n\t\t\te.preventDefault();\n\t\t\tbreak;\n\t\t}\n\t\t}\n\t}, [currChoice, handleSubmit]);\n\n    const handleInput = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet event = e.nativeEvent as InputEvent;\n        let input = e.target as HTMLInputElement;\n        let text = input.value;\n        let length = text.length;\n\t\tlet choices = props.options.filter(c => props.convert(c).toLowerCase().startsWith(text.toLowerCase()));\n\t\tprops.onChange(choices);\n\t\tif (!event.data) return;\n\t\tif (!text.trim()) {\n\t\t\tsetCurrChoice(null);\n\t\t\treturn;\n\t\t};\n\t\tlet firstChoice = choices[0];\n\t\tsetCurrChoice(firstChoice);\n        if (!firstChoice) return;\n        let autofill = props.convert(firstChoice);\n        input.value = autofill;\n        input.select();\n        input.setSelectionRange(length, autofill.length, 'forward');\n    }, [props.options]);\n\t\n\treturn (\n\t\t<div className={props.styles?.scoreSection}>\n\t\t\t<input type='text' className={[props.styles?.input].join(' ')} name='value' required\n\t\t\t\tplaceholder={props.placeholder || 'Search'}\n\t\t\t\tonInput={handleInput}\n\t\t\t\tonKeyDown={handleKeyDown}\n\t\t\t\tonSubmit={handleSubmit}\n\t\t\t\tautoComplete={'off'}\t\t\t\t\t\n\t\t\t/>\n\t\t</div>\n\t);\n}","import React, { ReactElement, useMemo } from 'react';\r\nimport { Match } from '../models/';\r\nimport Chartist from 'react-chartist';\r\nimport { IPieChartOptions, Svg } from 'chartist';\r\n\r\ninterface PieProps {\r\n\tmatches: {\r\n\t\t[key: string]: Match\r\n\t}\r\n\tround: number\r\n\ttotal: number\r\n}\r\n\r\nconst def = {\r\n\taborted: 0,\r\n\tpending: 0,\r\n\tscheduled: 0,\r\n\tregistered: 0,\r\n\tlive: 0,\r\n\tfinished: 0,\r\n\tconfirmed: 0\r\n} as {[key: string]: number};\r\n\r\nexport default function PercentageCompleted(props: PieProps): ReactElement {\r\n\r\n\tconst percentages = useMemo(() => {\t\t\r\n\t\tif (!props.matches) return def;\r\n\t\tlet totals = Object.assign({}, def, {pending: props.total});\r\n\t\tObject.values(props.matches).forEach((curr) => {\r\n\t\t\tif (!curr) return;\r\n\t\t\tif (curr.round !== props.round) return;\r\n\t\t\ttotals[curr.status]++;\r\n\t\t\ttotals.pending--;\r\n\t\t});\r\n\t\treturn totals;\r\n\t}, [props.matches, props.round, props.total]);\r\n\r\n\tconst myChart = useMemo(() => {\r\n\t\treturn <Chartist\r\n\t\t\ttype='Pie'\r\n\t\t\tdata={{\r\n\t\t\t\tlabels: Object.entries(percentages).map(([k, v]) => `${k} ${Math.round(v * 100 / props.total)}% (${v})`),\r\n\t\t\t\tseries: Object.entries(percentages).map(([k, v]) => {\r\n\t\t\t\t\treturn {meta: k, value: v};\r\n\t\t\t\t})\r\n\t\t\t}}\r\n\t\t\toptions={{\r\n\t\t\t\tdonut: true,\r\n\t\t\t\tdonutSolid: true,\r\n\t\t\t\tdonutWidth: 60,\r\n\t\t\t\tstartAngle: 270,\r\n\t\t\t\ttotal: props.total * 2,\r\n\t\t\t\theight: 400,\r\n\t\t\t\tignoreEmptyValues: true,\r\n\t\t\t\tshowLabel: true,\r\n\t\t\t\tlabelPosition: 'outside'\r\n\t\t\t} as IPieChartOptions}\r\n\t\t\tlistener={{\r\n\t\t\t\tdraw: (data: any) => {\r\n\t\t\t\t\tif(data.type === 'slice') {\r\n\t\t\t\t\t\tlet pathLength = data.element._node.getTotalLength();\r\n\t\t\t\t\t\tlet animationDefinition = {\r\n\t\t\t\t\t\t\t'stroke-dashoffset': {\r\n\t\t\t\t\t\t\t\tid: 'anim' + data.index,\r\n\t\t\t\t\t\t\t\tdur: 1000,\r\n\t\t\t\t\t\t\t\tfrom: -pathLength + 'px',\r\n\t\t\t\t\t\t\t\tto:  '0px',\r\n\t\t\t\t\t\t\t\teasing: Svg.Easing.easeOutQuint,\r\n\t\t\t\t\t\t\t\t// We need to use `fill: 'freeze'` otherwise our animation will fall back to initial (not visible)\r\n\t\t\t\t\t\t\t\tfill: 'freeze',\r\n\t\t\t\t\t\t\t\tbegin: undefined as string | undefined\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t  \r\n\t\t\t\t\t\t  // If this was not the first slice, we need to time the animation so that it uses the end sync event of the previous animation\r\n\t\t\t\t\t\tif (data.index !== 0) {\r\n\t\t\t\t\t\t\tanimationDefinition['stroke-dashoffset'].begin = 'anim' + (data.index - 1) + '.end';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t  \r\n\t\t\t\t\t\t  // We need to set an initial value before the animation starts as we are not in guided mode which would do that for us\r\n\t\t\t\t\t\tdata.element.attr({\r\n\t\t\t\t\t\t\t'stroke-dashoffset': -pathLength + 'px'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t  \r\n\t\t\t\t\t\t  // We can't use guided mode as the animations need to rely on setting begin manually\r\n\t\t\t\t\t\t  // See http://gionkunz.github.io/chartist-js/api-documentation.html#chartistsvg-function-animate\r\n\t\t\t\t\t\tdata.element.animate(animationDefinition, false);\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}}\r\n\t\t/>;\r\n\t}, [percentages, props.total]);\r\n\r\n\treturn (\r\n\t\t<div className='gauge'>\r\n\t\t\t{myChart}\r\n\t\t</div>\r\n\t);\r\n}","import { Player } from '.';\n\nexport type ChessComResult = 'timeout' | 'resigned' | 'chckmate' | 'draw' | 'win';\nexport interface ChessComTeam {\n\t'@id': string\n\tname: string\n\turl: string\n\tscore: number\n\tresult: ChessComResult\n\tplayers: {\n\t\tusername: string\n\t\tstats: string\n\t\tstatus: string\n\t\tplayed_as_white: ChessComResult\n\t\tplayed_as_black: ChessComResult\n\t\tboard: string\n\t}[]\n\tfair_play_removals: string[]\n}\nexport interface MatchConstructor {\n\tid: string\n\tw: Player\n\tb: Player\n\ttournamentId: string\n\tround: number\n\tlink?: string\n\tlinkSource?: 'chessCom' | 'lichess'\n\tlinkType?: 'team' | 'individual'\n\tteamID?: number\n\tscores: [number, number] | [undefined, undefined]\n\taborted?: boolean\n\tbodyStatus?: 'scheduled' | 'finished' | 'in_progress'\n\tmetaStatus?: 'Completed' | 'In Progress' | ''\n\tregistrationTime?: number\n\tstartTime?: number\n\tendTime?: number\n\tplayers?: number\n\tscored?: boolean,\n\tteams: ChessComTeam[]\n}\n\nexport type MatchStatus = 'finished' | 'live' | 'registered' | 'scheduled' | 'pending' | 'aborted';\n\nexport default class Match {\n\n\tpublic id!: string\n\tpublic w!: Player\n\tpublic b!: Player\n\tpublic tournamentId!: string\n\n\tpublic teamID?: number\n\tpublic link?: string\n\tpublic linkSource?: 'chessCom' | 'lichess'\n\tpublic linkType?: 'team' | 'individual'\n\tpublic scores!: [number, number] | [undefined, undefined]\n\n\tpublic aborted?: boolean\n\tpublic bodyStatus?: 'scheduled' | 'finished' | 'in_progress'\n\tpublic metaStatus?: 'Completed' | 'In Progress' | ''\n\tpublic registrationTime?: number\n\tpublic startTime?: number\n\tpublic endTime?: number\n\tpublic players?: number\n\tpublic scored?: boolean\n\tpublic teams!: ChessComTeam[]\n\n\tpublic debugStatus!: string\n\tconstructor(m: MatchConstructor, public round: number) {\n\t\tfor (let prop of Object.keys(m)) {\n\t\t\tObject.defineProperty(this, prop, {\n\t\t\t\tvalue: m[prop as keyof MatchConstructor]\n\t\t\t});\n\t\t}\n\t\tthis.debugStatus = this.status;\n\t}\n\n\tpublic get status(): MatchStatus {\n\t\tif (this.aborted) return 'aborted';\n\t\tfor (let v of ['Confirmed', 'Finished', 'Live', 'Registered', 'Scheduled']) {\n\t\t\tif (!(('is' + v) in this)) continue;\n\t\t\tif (this[('is' + v) as keyof Match] as boolean) return v.toLowerCase() as  'finished' | 'live' | 'registered' | 'scheduled';\n\t\t}\n\t\treturn 'pending';\n\t}\n\n\tget isConfirmed(): boolean {\n\t\tif (this.scored) return true;\n\t\treturn false;\n\t}\n\n\tget isFinished(): boolean {\n\t\tif (this.isConfirmed) return true;\n\t\tif (this.bodyStatus === 'finished') return true;\n\t\tif (Date.now() > (this.endTime || Infinity)) return true;\n\t\treturn false;\n\t}\n\n\tget isLive(): boolean {\n\t\tif (this.metaStatus === 'In Progress') return true;\n\t\tif (this.bodyStatus === 'in_progress') return true;\n\t\tif (!this.isFinished) {\n\t\t\tif (this.startTime && Date.now() > this.startTime) return true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tget isRegistered(): boolean {\n\t\tif (Date.now() > (this.registrationTime || Infinity)) return true;\n\t\tif (this.players) return true;\n\t\tif (this.isLive) return true;\n\t\tif (this.isFinished) return true;\n\t\treturn false;\n\t}\n\n\tget isScheduled(): boolean {\n\t\tif (Date.now() > (this.startTime || Infinity)) return true;\n\t\tif (this.startTime) return true;\n\t\tif (this.bodyStatus === 'scheduled') return true;\n\t\tif (this.isRegistered) return true;\n\t\tif (this.isFinished) return true;\n\t\treturn false;\n\t}\n\n}","import React, { ReactElement, useCallback, useState, useReducer, useEffect, useMemo } from 'react';\nimport { Link } from 'react-router-dom';\nimport ChessCom, { Chess } from '../chess/ChessCom';\nimport * as icons from '../assets/icons/';\nimport * as regexes from '../utils/regexes';\nimport { FaLink, FaSearch, FaDownload, FaChessBoard } from 'react-icons/fa';\nimport { PairingObject, Player, TournamentStatus, TournamentSettings } from '../interfaces';\nimport { GET } from '../utils/requests';\nimport styles from '../css/pairings.module.css';\nimport AutoComplete from '../components/AutoComplete';\nimport PercentageCompleted from './PieChart';\nimport { flags } from '../config.json';\nimport Match, { MatchConstructor, ChessComTeam } from '../models/Match';\n\nexport interface PairingsProps {\n\tdirection: string\n\tid: string\n\tstatus: TournamentStatus\n\tplayerDict: Map<string, Player>\n\tsettings: TournamentSettings\n}\n\nexport default function Pairings(props: PairingsProps & {round: number}): ReactElement | null {\n\n    const [pairings, setPairings] = useState([] as PairingObject[]);\n    const [expanded, setExpanded] = useReducer((state: string[], action: string) => {\n\t\tlet list = state.slice(0);\n\t\tif (state.includes(action)) list.splice(list.indexOf(action));\n\t\telse list.push(action);\n\t\treturn list;\n\t}, [decodeURIComponent(window.location.hash.slice(1).split('.').slice(0, 2).join('.'))]);\n\tconst [loaded, hasLoaded] = useState(false);\n\tconst [fetched, hasFetched] = useReducer((state: string[], action: string) => {\n\t\tlet s = state.slice(0);\n\t\ts.push(action);\n\t\treturn s;\n\t}, []);\n    const [matchDict, setMatch] = useReducer((state: {[key: string]: Match}, action: MatchConstructor | {id: string, scored: null}) => {\n\t\tlet res = Object.assign({}, state);\n\t\tif (action.scored === null) {\n\t\t\tres[action.id] = null as any as Match;\n\t\t\treturn res;\n\t\t}\n\t\tlet match = action as MatchConstructor;\n        res[action.id] = new Match(match, match.round);\n        return res;\n\t}, {});\n\t\n\tuseEffect(() => {\n\t\thasLoaded(false);\n\t\tGET({\n\t\t\turl: '/tournament/' + props.id + '/getPairings',\n\t\t\tparams: { round: props.round }\n\t\t})\n\t\t\t.then(setPairings)\n\t\t\t.then(() => hasLoaded(true))\n\t\t\t.catch(() => {})\n\t}, [setPairings, props.round, props.id]);\n\t\n\tconst [choices, setChoices] = useState([] as Player[]);\n\tconst headers = ['White', 'White score', 'Black', 'Black score', 'Game link', 'Time'] as string[];\n\tconst [csv, setCSV] = useState([] as any[][]);\n\n    const populatematchDict = useCallback(async (p: PairingObject[], round: number) => {\n\t\tif (!p.length) return;\n        for (let i = 0; i < p.length; i++) {\n\t\t\tlet row = p[i];\n\t\t\tlet id = [row[0].trim(), row[1].trim()].join('.');\n\t\t\tlet w = props.playerDict.get(row[0].trim()) as Player;\n\t\t\tlet b = props.playerDict.get(row[1].trim()) as Player;\n\t\t\tif (!w && !b) {\n\t\t\t\tsetMatch({id, scored: null});\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tlet [linkKey, link] = Object.entries(row[2]).find(v => v) || [undefined, undefined];\n\t\t\tlet matches = link?.match(regexes.chessCom) as RegExpMatchArray;\n\t\t\tif (matches) link = 'https://www.chess.com/club/matches/live/' + matches[1].trim();\n\t\t\tlet teamID = matches ? Number(matches[1]) : undefined;\n\t\t\tlet scored = w?.histories[round]?.match || b?.histories[round]?.match;\n\t\t\tlet match = {\n\t\t\t\ttournamentId: props.status.id,\n\t\t\t\tid,\n\t\t\t\tteamID,\n\t\t\t\tlink,\n\t\t\t\tw,\n\t\t\t\tb,\n\t\t\t\tround,\n\t\t\t\tscores: (w?.histories[round]?.game || b?.histories[round]?.game) ? [\n\t\t\t\t\tw?.histories ? w?.histories[round]?.game : null,\n\t\t\t\t\tb?.histories ? b?.histories[round]?.game : null,\n\t\t\t\t] : row[3]?.scores || [null, null],\n\t\t\t\tscored: !!scored,\n\t\t\t\tlinkSource: linkKey ? linkKey.startsWith('lichess') ? 'lichess' : 'chessCom' : '',\n\t\t\t\tlinkType: linkKey ? linkKey.includes('Team') ? 'team' : 'individual' : '',\n\t\t\t\tstartTime: row[3]?.startTime,\n\t\t\t\tendTime: row[3]?.endTime,\n\t\t\t\tbodyStatus: row[3]?.isFinished ? 'finished' : ''\n\t\t\t} as MatchConstructor;\n\t\t\tsetMatch(match);\t\t\t\t\n        }\n\t}, [setMatch, props.playerDict, props.status.id]);\n\n\tuseEffect(() => {\n\t\tChess.clearQueue();\n\t\tsetPairings([]);\n\t}, [setPairings, props.round]);\n\t\n    useEffect(() => {\n        populatematchDict(pairings, props.round);\n\t\t/* eslint-disable-next-line react-hooks/exhaustive-deps */\n\t}, [populatematchDict, pairings]);\n\n\tconst getDisplayName = useCallback((opp: Player): string => {\n        if (!opp || !opp.id) return '\\u200b';\n\t\tif (opp.id === 'bye') return 'BYE';\n\t\tlet displayName: string;\n\t\tif (props.settings.competitors === 'individual') displayName = [opp.firstName, opp.lastName].join(' ');\n\t\telse displayName = opp.firstName;\n\t\treturn displayName;\n\t}, [props.settings.competitors]);\n\n\tconst [fetchMatch, chooseMatch] = useState(null as null | Match);\n\tuseEffect(() => {\n\t\tlet length = Object.values(matchDict).length;\n\t\tif (!length) return;\n\t\tif (!pairings.length) return;\n\t\tif (length < pairings.length) return;\n\t\tif (fetchMatch && !fetched.includes(fetchMatch.id)) return chooseMatch(fetchMatch);\n\t\tlet found = Object.values(matchDict).find((m) => {\n\t\t\tif (!m) return false;\n\t\t\tif (!m.link) return false;\n\t\t\tif (fetched.includes(m.id)) return false;\n\t\t\tif (!m.startTime && !m.endTime) return true;\n\t\t\tif (m.endTime) {\n\t\t\t\tif (!m.scores || m.scores.every((s: number | undefined) => !s)) return true;\n\t\t\t\tif (Math.random() < 0.01) return true;\n\t\t\t\treturn false;\n\t\t\t} else\n\t\t\tif (m.startTime) {\n\t\t\t\tif (Date.now() > m.startTime) return true;\n\t\t\t\tif (Math.random() < 0.01) return true;\n\t\t\t\treturn false;\n\t\t\t} return true;\n\t\t});\n\t\tif (found) chooseMatch(found);\n\t\telse chooseMatch(null)\n\t}, [matchDict, pairings, chooseMatch, fetchMatch, fetched]);\n\t\t\n\tconst rows = useMemo(() => {\n\t\tlet _csv = [] as any[][];\n\t\tlet r = Object.values(matchDict).map((match, i) => {\n\t\t\tif (!match) return null;\n\t\t\tif (match.round !== props.round) return null;\n\t\t\tlet displayTime = match.startTime || match.registrationTime;\n\t\t\tlet date = new Date(displayTime || 0).toString();\n\t\t\tlet data = [\n\t\t\t\tgetDisplayName(match.w),\n\t\t\t\tmatch.scores[0] ?? ((match.isLive || match.isFinished) && match.teams && (match.w?.chessCom || match.b?.chessCom) ? match.teams[0].score : ''),\n\t\t\t\tgetDisplayName(match.b as Player),\n\t\t\t\tmatch.scores[1] ?? ((match.isLive || match.isFinished) && match.teams && (match.w?.chessCom || match.b?.chessCom) ? match.teams[1].score : ''),\n\t\t\t\tdisplayTime ? date.slice(0, 10) + '\\n' + date.slice(16, 21): '',\n\t\t\t\tmatch.link,\n\t\t\t\tmatch.w ? match.w.nationality : '',\n\t\t\t\tmatch.b ? match.b.nationality : ''\n\t\t\t] as string[];\n\n\t\t\t_csv[i + 1] = data;\n\t\t\treturn <Row\n\t\t\t\tkey={['row', i].join('.')}\n\t\t\t\tdata={data}\n\t\t\t\tmatch={match}\n\t\t\t\tsetMatch={setMatch}\n\t\t\t\tsetFinished={hasFetched}\n\t\t\t\tround={props.round}\n\t\t\t\tloadData={fetchMatch ? fetchMatch.id === match.id : false}\n\t\t\t\texpanded={expanded.includes(match.id)}\n\t\t\t\tsetExpanded={setExpanded}\n\t\t\t\thidden={!!choices.length && !choices.some(c => c.id === match.w.id || c.id === match.b.id)}\n\t\t\t\tsettings={props.settings}\n\t\t\t/>\n\t\t});\n\t\tsetCSV(_csv);\n\t\treturn r;\n\t}, [getDisplayName, fetchMatch, setExpanded, setCSV, expanded, choices, matchDict, props.round, props.settings, hasFetched]);\n\n\tconst [scrolled, setScrolled] = useState(false);\n\t/* eslint-disable-next-line react-hooks/exhaustive-deps */\n\tuseEffect(() => {\n\t\tif (scrolled) return;\n\t\tif (!window.location.hash) return;\n\t\tlet id = window.location.hash.slice(1);\n\t\tif (!id.includes('.')) return;\n\t\tlet elem = document.getElementById(id);\n\t\tif (elem) {\n\t\t\telem.scrollIntoView({\n\t\t\t\tbehavior: 'auto'\n\t\t\t});\n\t\t\tsetScrolled(true);\n\t\t}\n\t})\n\n\tconst handleDownload = useCallback(() => {\n\t\tconst element = document.createElement('a')\n\t\tconst fileContent = headers.join(',') + '\\n' + csv.map(line => line.join(',')).join('\\n');\n\t\tconst fileFormat = 'csv'\n\t\tconst file = new Blob([fileContent], {type: 'text/csv'});\n\t\tconst tourName = (props.status.name.match(regexes.lowerCase) || []).join('');\n\t\tconst date = new Date(Date.now()).toString().slice(4, 15);\n\t\n\t\telement.href = URL.createObjectURL(file)\n\t\telement.download = `${tourName}_${date}_${[props.round]}.${fileFormat}`\n\t\telement.click()\n\t}, [csv, props.round, headers, props.status.name]);\n\n\tconst CompletedChart = useMemo(() => {\n\t\treturn <PercentageCompleted matches={matchDict} round={props.round} total={pairings.length}/>;\n\t}, [matchDict, props.round, pairings]);\n\n\treturn <>\n\t\t<section className={pairings.length ? 'animated-' + props.direction : ''} style={{display: !pairings.length ? 'none' : undefined}}>\n\t\t\t{CompletedChart}\n\t\t</section>\n\t\t<section className={pairings.length ? 'animated-' + props.direction : ''}>\n\t\t\t<div className={styles.subheader}>\n\t\t\t\t<div>All times in {new Date(Date.now()).toString().slice(25)}</div>\n\t\t\t\t<div className={['button'].join(' ')} onClick={handleDownload}>\n\t\t\t\t\t<div><FaDownload /></div>\n\t\t\t\t\t<div>Download</div>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<div className={styles.searchBar}>\n\t\t\t\t\t\t<FaSearch />\n\t\t\t\t\t\t<AutoComplete\n\t\t\t\t\t\t\tonChange={(options: Player[]) => setChoices(options)}\n\t\t\t\t\t\t\tonSubmit={() => Promise.resolve()}\n\t\t\t\t\t\t\taction=''\n\t\t\t\t\t\t\toptions={Array.from(props.playerDict.values())}\n\t\t\t\t\t\t\tconvert={(p: Player) => getDisplayName(p)}\n\t\t\t\t\t\t\tstyles={styles}\n\t\t\t\t\t\t\tplaceholder={'Search'}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\t\t\t\n\t\t\t\n\t\t\t<table className='download-table full-width pairings'>\n\t\t\t\t<thead>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td style={{width: '5%'}}>Fed</td>\n\t\t\t\t\t\t<td style={{width: '22.5%'}}>White</td>\n\t\t\t\t\t\t<td style={{width: '12.5%'}}>Link</td>\n\t\t\t\t\t\t<td style={{width: '5%'}}></td>\n\t\t\t\t\t\t<td style={{width: '10%'}}>Start Time</td>\n\t\t\t\t\t\t<td style={{width: '5%'}}></td>\n\t\t\t\t\t\t<td style={{width: '12.5%'}}>Watch Live</td>\n\t\t\t\t\t\t<td style={{width: '22.5%'}}>Black</td>\n\t\t\t\t\t\t<td style={{width: '5%'}}>Fed</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t{loaded && !pairings.length ? <tr><td colSpan={100}>Draw has not yet taken place!</td></tr> : null}                       \n\t\t\t\t\t{rows}\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t</section>\n\t</>;\n\n}\n\ninterface RowProps {\n\tdata: any[]\n\tmatch: Match\n\tsetMatch: (match: Match) => void\n\tsetFinished: (id: string) => void\n\thidden: boolean\n\tloadData: boolean\n\tround: number\n\texpanded: boolean\n\tsetExpanded: (id: string) => void\n\tsettings: TournamentSettings\n}\n\nconst def = [] as ChessComTeam[];\nfunction Row(props: RowProps) {\n\n\tconst match = props.match;\n\tconst data = props.data;\n\tconst [hasExpanded, cache] = useState(match.isLive);\n\tuseEffect(() => {\n\t\tif (props.expanded && !hasExpanded) cache(true);\n\t}, [props.expanded, hasExpanded, cache]);\n\n\tconst id = [match.w?.id, match.b?.id].join('.');\n\treturn (\n\t\t<>\n\t\t\t<tr id={id} className={[styles.row, props.hidden ? 'collapsed' : ''].join(' ')} style={{\n\t\t\t\tvisibility: props.hidden ? 'collapse' : undefined\n\t\t\t}}>\n\t\t\t\t<td>\n\t\t\t\t\t<div className={styles.flag}>{data[6] ? <img src={flags.replace('|',data[6])} alt={data[6]}/> : null}</div>\n\t\t\t\t</td>\n\t\t\t\t<td id={match.w?.id}>\n\t\t\t\t\t<Link to={['', props.settings.competitors === 'individual' ? 'player' : 'team', match.w?.id].join('/')} className='playerName'>{data[0]}</Link>\n\t\t\t\t</td>\n\t\t\t\t<td className={styles.inner}>\n\t\t\t\t\t{match.link ? <a className='button' href={match.link} target='_blank' rel='noopener noreferrer'>\n\t\t\t\t\t\t<FaLink />\n\t\t\t\t\t\t<div>chess.com</div>\n\t\t\t\t\t</a> : null}\n\t\t\t\t</td>     \n\t\t\t\t<td className={styles.inner}>\n\t\t\t\t\t<div className={[styles.score, styles[match.status], match.status].join(' ')}>\n\t\t\t\t\t\t{match.isFinished || match.isLive ? data[1] : null}\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t\t<td style={{whiteSpace: 'pre-line'}}>{data[4] || '-'}</td>\n\t\t\t\t<td className={styles.inner}>\n\t\t\t\t\t<div className={[styles.score, styles[match.status], match.status].join(' ')}>\n\t\t\t\t\t\t{match.isFinished || match.isLive ? data[3] : null}\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t\t<td className={styles.inner}>\n\t\t\t\t\t{match.link && match.isScheduled ? <div className={['button', match.isLive ? styles.watchLive : ''].join(' ')} onClick={() => {\n\t\t\t\t\t\tif (!match.isFinished) return;\n\t\t\t\t\t\tprops.setExpanded(match.id);\n\t\t\t\t\t\tif (window.location.hash && decodeURIComponent(window.location.hash).includes(match.id)) window.history.pushState('', document.title, window.location.pathname + window.location.search);\n\t\t\t\t\t\telse window.location.hash = '#' + match.id;\n\t\t\t\t\t}}>\n\t\t\t\t\t\t{!match.isFinished ? <>\n\t\t\t\t\t\t\t{match.isLive ? <img className='icon' src={icons.watch} alt={'Watch games'}/> : <FaChessBoard />}\n\t\t\t\t\t\t\t<a href={'https://www.chess.com/live#tm=' + match.teamID} target='_blank' rel='noopener noreferrer'>\n\t\t\t\t\t\t\t\t{match.isLive ? ' Watch live' : 'Join Game'}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</> : <div>Scores</div>}\n\t\t\t\t\t</div> : null}\n\t\t\t\t</td>\n\t\t\t\t<td id={match.b?.id}>\n\t\t\t\t\t<Link to={['', props.settings.competitors === 'individual' ? 'player' : 'team', match.b?.id].join('/')} className='playerName'>{data[2]}</Link>\n\t\t\t\t</td>\n\t\t\t\t<td>\n\t\t\t\t\t<div className={styles.flag}>{data[7] ? <img src={flags.replace('|',data[7])} alt={data[7]}/> : null}</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t{match.link ? <tr key={['row', 'dropdown'].join('.')} className={[props.hidden || !props.expanded  ? 'collapsed' : ''].join(' ')} style={props.hidden || !props.expanded ? {visibility: 'collapse'} : {}}>\n\t\t\t\t<td colSpan={100}>\n\t\t\t\t\t{match.linkSource === 'chessCom' ?\n\t\t\t\t\t\tmatch.linkType === 'team' ?\n\t\t\t\t\t\t\t<ChessCom\n\t\t\t\t\t\t\t\tid={id}\n\t\t\t\t\t\t\t\tmatch={match}\n\t\t\t\t\t\t\t\tsetMatch={props.setMatch}\n\t\t\t\t\t\t\t\tsetFinished={props.setFinished}\n\t\t\t\t\t\t\t\tloadData={props.loadData}\n\t\t\t\t\t\t\t\texpanded={props.expanded}\n\t\t\t\t\t\t\t\tenforceBoards={match.players ? Number(match.players) : 0}\n\t\t\t\t\t\t\t\tround={props.round}\n\t\t\t\t\t\t\t\tteams={match.teams || def}\n\t\t\t\t\t\t\t/> :\n\t\t\t\t\t\t\tnull :\n\t\t\t\t\t\tnull\n\t\t\t\t\t}\n\t\t\t\t</td>\n\t\t\t</tr> : null}\n\t\t</>\n\t)\n}","import React, { useState, ReactElement, useEffect, useMemo, useRef, RefObject, useCallback } from 'react';\nimport { TwitchPlayer, TwitchChat } from 'react-twitch-embed';\nimport styles from '../css/streams.module.css';\nimport { FaTwitch, FaYoutube } from 'react-icons/fa';\nimport {MdPictureInPictureAlt } from 'react-icons/md';\nimport * as regexes from '../utils/regexes';\nimport { GET } from '../utils/requests';\n\nexport function pingTwitch() {\n\tconst clientID = '2tv4pxjk1uldipdt2skrwmq1uu3q9k';\n\tconst url = 'https://api.twitch.tv/helix/streams';\n\tlet user_ids = [] as string[];\n\treturn GET({\n\t\turl: url + user_ids.reduce((acc, curr) => acc += 'user_id=' + curr + '&', '?'),\n\t\theaders: {\n\t\t\t'Client-ID': clientID\n\t\t}\n\t});\n}\n\ninterface TVProps {\n\tdirection: string\n\tstreamURL: string\n\tpop: (elem: HTMLDivElement | null) => void\n}\n\nexport default function TV(props: TVProps) {\n\n\tconst [popped, setPopped] = useState(null as null | ReactElement);\n\n\tlet streamURL = props.streamURL || '';\n\tlet matches = streamURL.match(regexes.streamLink);\n\tif (!matches) matches = ['', ''];\n\tlet [domain, channel] = matches.slice(1);\n\tlet site: 'twitch' | 'youtube' = domain.split('.').shift() as 'twitch' | 'youtube';\n\tconst streamDict = {\n\t\ttwitch: 'https://twitch.tv/',\n\t\tyoutube: 'https://youtube.com/'\n\t};\n\n\tconst component = useMemo(() => {\n\t\treturn <TwitchPlayer\n\t\t\tid={styles.twitchPlayer}\n\t\t\tchannel={channel}\n\t\t\tautoplay\n\t\t\twidth={'100%'}\n\t\t\theight={'640px'}\n\t\t/>;\n\t}, [channel]);\n\n\tconst twitchPlayer = useRef(null) as RefObject<HTMLDivElement>;\n\n\tconst handlePop = useCallback(() => {\n\t\tif (!twitchPlayer.current) return;\n\t\tprops.pop(twitchPlayer.current)\n\t}, [props.pop, twitchPlayer])\n\n\tif (!streamDict.twitch) return null;\n\treturn (\n\t\t<>\n\t\t\t{site === 'twitch' ? <section className={[styles.container, 'animated-' + props.direction].join(' ')}>\n\t\t\t\t<div className={styles.streamHeader}>\n\t\t\t\t\t<FaTwitch />\n\t\t\t\t\t<span className='bold'>{channel}</span>\n\t\t\t\t\t<div className='button' onClick={handlePop}>\n\t\t\t\t\t\tPop-out\n\t\t\t\t\t\t<MdPictureInPictureAlt />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className={styles.streamContainer}>\n\t\t\t\t\t<div id={styles.twitchPlayer} ref={twitchPlayer} className={[styles.player, popped ? styles.popped : ''].join(' ')} />\n\t\t\t\t\t<div className={[styles.player].join(' ')} style={{display: popped ? 'flex' : 'none' }}/>\n\t\t\t\t\t<div id={styles.twitchChat} className={styles.chat}>\n\t\t\t\t\t\t<TwitchChat\n\t\t\t\t\t\t\tchannel={channel}\n\t\t\t\t\t\t\twidth={'100%'}\n\t\t\t\t\t\t\theight={'100%'}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</section> : null}\n\t\t\t{site === 'youtube' ? <section className={[styles.container, 'animated-' + props.direction].join(' ')}>\n\t\t\t\t<div className={styles.streamHeader}>\n\t\t\t\t\t<FaYoutube />\n\t\t\t\t\t<span className='bold'>chess-england</span>\n\t\t\t\t</div>\n\t\t\t\t<div className={styles.streamContainer}>\n\t\t\t\t\t<div id={styles.youtubePlayer} className={styles.player}>\n\t\t\t\t\t\t<iframe title='youtubePlayer' width={Math.min(window.innerWidth - 40, 980) * 0.66} height={Math.min(window.innerWidth - 40, 980) / 2.73} src=\"https://www.youtube.com/embed/R2v-XSRMOFo\" frameBorder={0} allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowFullScreen></iframe>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id={styles.youtubeChat} className={[styles.chat, styles.youtubeChat].join(' ')}>\n\t\t\t\t\t\t<iframe title='youtubeChat' width={Math.min(window.innerWidth - 40, 980) * 0.31} height=\"315\" src=\"https://www.youtube.com/live_chat?v=R2v-XSRMOFo&embed_domain=localhost\" frameBorder={0} allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowFullScreen></iframe>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</section> : null}\n\t\t\t<div className={styles.footer}>\n\t\t\t\tIf you're having problems viewing this player, try disabling any extensions or Brave Shields if you have them enabled.\n\t\t\t</div>\n\t\t\t<div className='hidden'>\n\t\t\t\t{component}\n\t\t\t</div>\n\t\t</>\n\t);\n\n}","import React, { ReactNode, useCallback, useEffect, useState } from 'react';\r\nimport styles from '../css/components.module.css';\r\n\r\n\r\nfunction MouseEvents(props: {\r\n\tbottom: number\r\n\tright: number\r\n\tsetBottom: (y: number) => void\r\n\tsetRight: (x: number) => void\r\n}): void {\r\n\r\n\tconst [click, setClick] = useState(false);\r\n\tconst [startBottom, setStartBottom] = useState(0);\r\n\r\n\tconst handleMouseMove = useCallback((e: MouseEvent, initialX: number, initialY: number) => {\r\n\t\tif (!click) return;\r\n\t}, [click, props.setBottom, props.setRight]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!click) return;\r\n\t\tlet callback = (e: MouseEvent) => handleMouseMove(e, props.right, props.bottom);\r\n\t\tdocument.addEventListener('mousemove', callback);\r\n\t\treturn () => document.removeEventListener('mousemove', callback);\r\n\t}, [click, handleMouseMove, props.right, props.bottom]);\r\n\tuseEffect(() => {\r\n\t\tlet callback = () => setClick(true);\r\n\t\t//document.addEventListener('mousedown', callback);\r\n\t\t//return () => document.removeEventListener('mousedown', callback);\r\n\t}, [setClick]);\r\n\tuseEffect(() => {\r\n\t\tlet callback = () => setClick(false);\r\n\t\tdocument.addEventListener('mouseup', callback);\r\n\t\treturn () => document.removeEventListener('mouseup', callback);\r\n\t}, [setClick]);\r\n}\r\n\r\ninterface DraggableProps {\r\n\tchildren?: ReactNode\r\n\tmargin: number\r\n}\r\n\r\nexport default function Draggable(props: DraggableProps) {\r\n\r\n\tconst [bottom, setBottom] = useState(10);\r\n\tconst [right, setRight] = useState(10);\r\n\r\n\tif (!props.children) return null;\r\n\r\n\t//MouseEvents({ bottom, right, setBottom, setRight });\r\n\r\n\treturn <div className={['popped', styles.draggable].join(' ')} style={{ bottom, right }}>\r\n\t\t{props.children}\r\n\t</div>\r\n}","import React, { useState, useCallback, ReactElement } from 'react';\nimport { Carousel as RRC } from 'react-responsive-carousel';\nimport 'react-responsive-carousel/lib/styles/carousel.min.css';\nimport Gallery from 'react-photo-gallery';\nimport Lightbox, { Modal, ModalGateway } from 'react-images';\nimport { PhotoProps } from 'react-photo-gallery';\nimport styles from '../css/components.module.css';\nimport url from 'url';\n\ninterface Image extends PhotoProps {\n\tsource: string\n    src: string\n    srcSet: string\n\ttitle: string\n\twidth: number\n\theight: number\n\talt?: string\n    index: number\n}\n\nexport interface AlbumProps {\n\ttype: 'carousel' | 'grid'\n\tenableLightbox: boolean\n\n\tphotos: string[],\n\taxis?: 'vertical' | 'horizontal', //def: horizontal\n\tautoPlay?: boolean //def: true\n\tselectedItem?: number\n\tshowThumbs?: boolean\n\tinterval?: number\n\ttransitionTime?: number\n\tcenterMode?: boolean\n    dynamicHeight?: boolean\n    startIndex?: number\n\n\tmargin?: number\n\ttargetRowHeight?: number\n    ratio: number[]\n    height?: number\n}\n\nexport default function Album(props: AlbumProps) {\n\n    const mapToPhoto = useCallback((src: string, index: number): Image => {\n\t\treturn {\n\t\t\tindex,\n\t\t\tsource: url.resolve(process.env.PUBLIC_URL, src),\n\t\t\tsrc: url.resolve(process.env.PUBLIC_URL, src),\n\t\t\tsrcSet: url.resolve(process.env.PUBLIC_URL, src),\n\t\t\twidth: props.ratio[0],\n\t\t\theight: props.ratio[1],\n\t\t\ttitle: src\n\t\t};\n\t}, [props.ratio])\n\n\tconst [currentImage, setCurrentImage] = useState(props.startIndex || 0);\n\tconst [viewerIsOpen, setViewerIsOpen] = useState(false);\n\tconst [photos, setPhotos] = useState(props.photos.map(mapToPhoto));\n\n\tconst openLightbox = useCallback((event, { photo, index }) => {\n\t\tsetCurrentImage(index);\n\t\tsetViewerIsOpen(true);\n\t}, []);\n\n\tconst closeLightbox = () => {\n\t\tsetCurrentImage(0);\n\t\tsetViewerIsOpen(false);\n    };\n    \n\treturn (\n\t\t<div\n\t\t\tclassName={props.type === 'grid' ? styles.grid : styles.carousel}\n\t\t>\n\t\t\t{!photos.length ? null : props.type === 'grid' ?\n\t\t\t\t<Gallery\t// Grid\n\t\t\t\t\tphotos={photos}\n\t\t\t\t\tonClick={props.enableLightbox !== false ? openLightbox : () => {}}\n\t\t\t\t\tmargin={props.margin || 2}\n\t\t\t\t\tcolumns={3}\n\t\t\t\t\ttargetRowHeight={props.height || 200}\n\t\t\t\t/> :\n\t\t\t\t<RRC\t\t//React-Reponsive-Carousel\n\t\t\t\t\tonClickItem={props.enableLightbox !== false ? openLightbox : () => {}}\n\t\t\t\t\tinfiniteLoop={true}\n\t\t\t\t\tuseKeyboardArrows={true}\n\t\t\t\t\tshowStatus={false}\n\t\t\t\t\temulateTouch={true}\n\t\t\t\t\taxis={props.axis || 'horizontal'}\n\t\t\t\t\tautoPlay={props.autoPlay !== false}\n\t\t\t\t\tselectedItem={props.selectedItem || 0}\n\t\t\t\t\tshowThumbs={props.showThumbs !== false}\n\t\t\t\t\tinterval={props.interval || 4000}\n\t\t\t\t\ttransitionTime={props.transitionTime || 500}\n\t\t\t\t\tcenterMode={props.centerMode || false}\n\t\t\t\t\tdynamicHeight={props.dynamicHeight || true}\n\t\t\t\t>\n\t\t\t\t\t{photos.map((x, i) => {\n\t\t\t\t\t\tif (!x) return null;\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div key={x.src + '.' + i.toString()}>\n\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\tsrc={x.src}\n\t\t\t\t\t\t\t\t\talt={x.alt}\n\t\t\t\t\t\t\t\t></img>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)\n\t\t\t\t\t})}\n\t\t\t\t</RRC>\n\t\t\t}\n\t\t\t{props.enableLightbox !== false ? (\n\t\t\t\t<ModalGateway>\n\t\t\t\t\t{!viewerIsOpen ?  null : (\n\t\t\t\t\t\t<Modal onClose={closeLightbox}>\n\t\t\t\t\t\t\t<Lightbox\n\t\t\t\t\t\t\t\tcurrentIndex={currentImage}\n\t\t\t\t\t\t\t\tviews={photos.map(x => Object.assign(x, {\n\t\t\t\t\t\t\t\t\tcaption: x.title\n\t\t\t\t\t\t\t\t}))}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Modal>\n\t\t\t\t\t)}\n\t\t\t\t</ModalGateway>\n\t\t\t) : null}\n\t\t</div>\n\t);\n}\n\ninterface ImgProps {\n\tsrc: string\n\talt: string\n}\n\nexport function Img(props: ImgProps) {\n\n\tconst [viewerIsOpen, setViewerIsOpen] = useState(false);\n\n\treturn (\n\t\t<>\n\t\t\t<img {...props} onClick={() => setViewerIsOpen(!viewerIsOpen)} style={{ cursor: 'pointer' }} />\n\t\t\t<ModalGateway>\n\t\t\t\t{!viewerIsOpen ?  null : (\n\t\t\t\t\t<Modal onClose={() => setViewerIsOpen(false)}>\n\t\t\t\t\t\t<Lightbox\n\t\t\t\t\t\t\tcurrentIndex={0}\n\t\t\t\t\t\t\tviews={[\n\t\t\t\t\t\t\t\tObject.assign({}, props, {\n\t\t\t\t\t\t\t\t\tsource: props.src\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Modal>\n\t\t\t\t)}\n\t\t\t</ModalGateway>\n\t\t</>\n\t)\n}","import React, { useContext } from 'react';\nimport { Link } from 'react-router-dom';\nimport styles from '../css/results.module.css';\nimport '../css/fireworks.css';\nimport { GiTrophyCup, GiTrophy } from 'react-icons/gi';\nimport { IoIosTrophy } from 'react-icons/io';\nimport { DisplayNameContext } from '../Contexts';\nimport Player from '../models/Player';\nimport { columns } from '../resources/columns';\nimport { TournamentSettings } from '../interfaces';\nimport { flags } from '../config.json';\n\ninterface ResultsProps {\n\tdirection: string\n\tid: string\n\tstate: string[]\n\tplayerDict: Map<string, Player>\n\tsettings: TournamentSettings\n}\n\nexport default function Results(props: ResultsProps) {\n\n\tconst getDisplayName = useContext(DisplayNameContext);\n\n\tfunction Description({ id }: { id: string }) {\n\t\tlet player = props.playerDict.get(id) as Player;\n\t\tif (!player) return null;\n\t\treturn <div className={styles.table}>\n\t\t\t{player && player.nationality ? <>\n\t\t\t\t<div className={styles.key}>Nationality</div>\n\t\t\t\t<div className={[styles.flag, styles.value].join(' ')}>\n\t\t\t\t\t<img src={flags.replace('|', player.nationality)} alt={player.nationality}/>\n\t\t\t\t</div>\n\t\t\t</> : null}\n\t\t\t{Object.entries(columns.post).map(([k, meta], i) => {\n\t\t\t\tif (meta.show && !meta.show(player, i, props.settings, 'results')) return null;\n\t\t\t\treturn <>\n\t\t\t\t\t<div className={styles.key}>{meta.mobile}</div>\n\t\t\t\t\t<div className={styles.value}>{meta.convert ? meta.convert(player[k as keyof Player], player, props.settings, 'results') : player[k as keyof Player]?.toString()}</div>\n\t\t\t\t</>;\n\t\t\t})}\n\t\t</div>\n\t}\n\n\treturn <>\n\t\t<section className={[styles.fireworksSection, 'animated-' + props.direction].join(' ')}>\n\t\t\t<div className={'pyro'}>\n\t\t\t\t<div className={'before'}></div>\n\t\t\t\t<div className={'after'}></div>\n\t\t\t</div>\n\t\t\t<div className={styles.resultsScreen}>\n\t\t\t\t<div id='first' className={styles.place}>\n\t\t\t\t\t<GiTrophyCup />\n\t\t\t\t\t<div className={styles.position}>\n\t\t\t\t\t\t1<sup>st</sup>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={styles.teamName}>\n\t\t\t\t\t\t{getDisplayName(props.state[0])}\n\t\t\t\t\t</div>\n\t\t\t\t\t<Description id={props.state[0]} />\n\t\t\t\t</div>\n\t\t\t\t<div id='second' className={styles.place}>\n\t\t\t\t\t<GiTrophy />\n\t\t\t\t\t<div className={styles.position}>\n\t\t\t\t\t\t2<sup>nd</sup>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={styles.teamName}>\n\t\t\t\t\t\t{getDisplayName(props.state[1])}\n\t\t\t\t\t</div>\n\t\t\t\t\t<Description id={props.state[1]} />\n\t\t\t\t</div>\n\t\t\t\t<div id='third' className={styles.place}>\n\t\t\t\t\t<IoIosTrophy />\n\t\t\t\t\t<div className={styles.position}>\n\t\t\t\t\t\t3<sup>rd</sup>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={styles.teamName}>\n\t\t\t\t\t\t{getDisplayName(props.state[2])}\n\t\t\t\t\t</div>\n\t\t\t\t\t<Description id={props.state[2]} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</section>\n\t\t<section>\n\t\t\t<div className='container'>\n\t\t\t\t<Link to={`/${props.id}/standings/final`} className={['header-button', styles.standingsButton].join(' ')}>\n\t\t\t\t\tView Final Standings\n\t\t\t\t</Link>\n\t\t\t</div>\n\t\t</section>\n\t</>\n}","import React, { useEffect, useState, useMemo, useCallback, useReducer } from 'react';\nimport { StaticContext } from 'react-router';\nimport { Link, Route, Redirect, Switch, RouteComponentProps } from 'react-router-dom';\nimport { TournamentStatus, Player, TournamentSettings, TournamentPlayers } from './interfaces';\nimport { GET } from './utils/requests';\nimport { ModeSwitcher, RoundSwitcher } from './components/Switcher';\nimport CrossTable from './tournament/Standings';\nimport Chart from './tournament/Stats';\nimport NotFound from './404';\nimport styles from './css/nav.module.css';\nimport { FaLink, FaWindowClose, FaAngleUp, FaUser } from 'react-icons/fa';\nimport { IoMdDocument } from 'react-icons/io';\nimport Pairings from './tournament/Pairings';\nimport * as regexes from './utils/regexes';\nimport TV from './tournament/Streams';\nimport Draggable from './components/DraggableSticky';\nimport { Img } from './components/Image';\nimport { capitalise } from './utils/prototype';\nimport { TieBreaks } from './resources/tiebreaks';\nimport { TiebreakContext, DisplayNameContext } from './Contexts';\nimport Results from './tournament/Results';\nimport usePlayers from './tournament/Standings/Players';\nimport PlayerData from './models/Player';\n\nexport default function Tournament(props: RouteComponentProps<any, StaticContext, any>) {\n\n    const id = props.match.params.id\n\tconst [loaded, setLoaded] = useReducer((state: {[key: string]: boolean}, {action, set}: {action: string, set?: boolean}) => {\n\t\tlet obj = Object.assign({}, state);\n\t\tobj[action] = set !== undefined ? set : true;\n\t\tif (Object.values(obj).length >= 4) obj.all = true;\n\t\treturn obj;\n\t}, {});\n    const [settings, setSettings] = useState({} as TournamentSettings);\n    const [status, setStatus] = useState({} as TournamentStatus);\n    const [state, setState] = useState([] as string[]);\n\tconst [rawPlayers, setPlayers] = useState([] as Player[]);\n\tconst [poppedComponent, pop] = useState(null as null | HTMLDivElement);\n\n\tconst players: PlayerData[] = usePlayers({ status, players: rawPlayers, settings, round: status.round });\n\n    const playerDict: Map<string, PlayerData> = useMemo(() => {\n        if (!players.length) return new Map();\n        let dict = new Map();\n\t\tfor (let p of players) dict.set(p.id, p);\n        return dict;\n    }, [players]);\n\n\tconst round = status.round || 0;\n\n\tuseEffect(() => {\n\t\tGET({ url: '/tournament/' + id + '/fetchPlayers'})\n\t\t\t.then(setPlayers)\n\t\t\t.then(() => setLoaded({ action: 'players' }))\n\t\t\t.catch(() => setLoaded({ action: 'players', set: false }));\n\t}, [setPlayers, id, setLoaded]);\n\t\n\tuseEffect(() => {\n\t\tGET({ url: '/tournament/' + id + '/getSettings'})\n\t\t\t.then(setSettings)\n\t\t\t.then(() => setLoaded({ action: 'settings' }))\n\t\t\t.catch(() => setLoaded({ action: 'settings', set: false }));\n\t}, [setSettings, id, setLoaded]);\n\t\n\tuseEffect(() => {\n\t\tGET({ url: '/tournament/' + id + '/getState'})\n\t\t\t.then(({ players }: { players: TournamentPlayers }) => {\n\t\t\t\tlet order = Object.entries(players)\n\t\t\t\t\t.map(([k, v]) => [Number(k), v] as [number, string[]])\n\t\t\t\t\t.sort((a, b) => b[0] - a[0])\n\t\t\t\t\t.reduce((acc, curr) => acc.concat(curr[1]), [] as string[]);\n\t\t\t\tsetState(order);\n\t\t\t})\n\t\t\t.then(() => setLoaded({ action: 'state' }))\n\t\t\t.catch(() => setLoaded({ action: 'state', set: false }));\n\t}, [setState, id, setLoaded]);\n\n    useEffect(() => {\n\t\tGET({ url: '/tournament/' + id + '/getStatus'})\n\t\t\t.then(setStatus)\n\t\t\t.then(() => setLoaded({ action: 'status' }))\n\t\t\t.catch(() => setLoaded({ action: 'sattus', set: false }));\n    }, [setStatus, setLoaded, id]);\n\n    useEffect(() => {\n        if (!round) return;\n        let histories = new Array(round + 1);\n        for (let i = 1; i < round + 1; i++) histories[i] = {\n            match: 0,\n            game: 0\n        };\n        playerDict.set('bye', PlayerData.bye(id, round, settings));\n\t}, [playerDict, round, id, settings]);\n\n\tconst [showScroll, toggleScroll] = useState(false);\n\tconst updateScroll = useCallback(() => {\n\t\tif (!window.scrollY) toggleScroll(false);\n\t\telse toggleScroll(true);\n\t}, [toggleScroll]);\n\tuseEffect(() => {\n\t\tdocument.addEventListener('scroll', updateScroll);\n\t\treturn () => document.removeEventListener('scroll', updateScroll);\n\t}, [updateScroll]);\n\n\tconst [floatContainer, setFloat] = useState('' as '' | 'tie breaks' | 'prizes' | 'description');\n\tconst tieBreaks = useMemo(() => {\n\t\tlet entries = Object.entries(TieBreaks);\n\t\tif (settings.tieBreaks) {\n\t\t\tlet arr = settings.tieBreaks.split(',');\n\t\t\tentries = entries.sort((a, b) => arr.indexOf(a[0]) - arr.indexOf(b[0]));\n\t\t}\n\t\treturn entries;\n\t}, [settings.tieBreaks]);\n\n\tconst getDisplayname = useCallback((id: string | Player): string => {\n\t\tif (!id) return '\\u200b';\n\t\tif (id === 'bye') return 'BYE';\n\t\tif (typeof id !== 'string') {\n\t\t\tlet p = id as Player;\n\t\t\tif (settings.competitors === 'individual') return [p.firstName, p.lastName].join(' ');\n\t\t\telse return p.firstName;\n\t\t}\n\t\tlet opp = playerDict.get(id);\n\t\tif (!opp) return id;\n\t\tlet displayName: string;\n\t\tif (settings.competitors === 'individual') displayName = [opp.firstName, opp.lastName].join(' ');\n\t\telse displayName = opp.firstName;\n\t\treturn displayName;\n\t}, [playerDict, settings.competitors]);\n\t\n\tif (loaded.state === false) return <NotFound />;\n\n    return (\n        <div id='main' className={'animated-' + props.location.state.direction}>\n\t\t\t<div className='container' style={{ marginTop: '60px' }}>\n\t\t\t\t<div className={styles.stage}>\n\t\t\t\t\t<div className={[styles.profilePicture, !loaded.all ? styles.preload : ''].join(' ')}>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tloaded.all && settings.logoURL ?\n\t\t\t\t\t\t\t<Img src={settings.logoURL} alt='profile_picture' /> : \n\t\t\t\t\t\t\t<div className={styles.defaultProfilePicture}>\n\t\t\t\t\t\t\t\t{!loaded.all || !status.name ? '\\u200b' : status.name.match(regexes.lowerCase)?.map(v => v.substring(0, 1).toUpperCase()).join('')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={styles.nameContainer}>\n\t\t\t\t\t\t<div className={styles.name}>\n\t\t\t\t\t\t\t{status.name || '\\u200b'}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={styles.linkButtons}>\n\t\t\t\t\t\t{loaded.all ?\n\t\t\t\t\t\t\tsettings.profileURL ? <a className={[styles.website].join(' ')} \n\t\t\t\t\t\t\t\thref={settings.profileURL}\n\t\t\t\t\t\t\t\ttarget='_blank'\n\t\t\t\t\t\t\t\trel='noopener noreferrer'\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<FaLink /> Website\n\t\t\t\t\t\t\t</a> : null\n\t\t\t\t\t\t:  <div className={[styles.website].join(' ')}>{'\\u200b'}</div>}\n\t\t\t\t\t\t{loaded.all ?\n\t\t\t\t\t\t\tsettings.rulesURL ? <a className={[styles.rules].join(' ')} \n\t\t\t\t\t\t\t\thref={settings.rulesURL}\n\t\t\t\t\t\t\t\ttarget='_blank'\n\t\t\t\t\t\t\t\trel='noopener noreferrer'\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<IoMdDocument /> Rules\n\t\t\t\t\t\t\t</a> : null\n\t\t\t\t\t\t:  <div className={[styles.rules].join(' ')}>{'\\u200b'}</div>}\n\t\t\t\t\t\t{loaded.all ?\n\t\t\t\t\t\t\tstatus.user ? <Link\n\t\t\t\t\t\t\t\tclassName={[styles.rules].join(' ')} \n\t\t\t\t\t\t\t\tto={'/@/' + status.user}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<FaUser />{status.user}\n\t\t\t\t\t\t\t</Link> : null\n\t\t\t\t\t\t:  <div className={[styles.rules].join(' ')}>{'\\u200b'}</div>}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={styles.infoBox} style={true ? {} : {\n\t\t\t\t\t\tgridArea: 'info / website / info / info'\n\t\t\t\t\t}}>\n\t\t\t\t\t\t{loaded.all ? <>\n\t\t\t\t\t\t\t<div key='rules.1'>\n\t\t\t\t\t\t\t\t<div>Format: </div><div>{capitalise(settings.pairingSystem)}</div>\n\t\t\t\t\t\t\t\t<div>Created: </div><div>{new Date(status.createdAt).toString().slice(4, 15)}</div>\n\t\t\t\t\t\t\t\t<div>Type: </div><div>{capitalise(settings.competitors) + 's'}</div>\n\t\t\t\t\t\t\t\t<div>{capitalise(settings.competitors === 'team' ? 'Teams' : 'Players')}: </div><div>{status.players}</div>\n\t\t\t\t\t\t\t\t{settings.description ? <div className={styles.tieBreakLink} onClick={() => setFloat(floatContainer === 'description' ? '' : 'description')}>Description</div> : settings.prizes ? <div>{'\\u200b'}</div> : ''}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div key='rules.2'>\n\t\t\t\t\t\t\t\t<div>Location: </div><div>{settings.location || '-'}</div>\n\t\t\t\t\t\t\t\t<div>Time control: </div><div>{settings.timeControl || '-'}</div>\n\t\t\t\t\t\t\t\t<div>Status: </div><div>{status.active !== false ? 'Live' : status.round ? 'Finished' : 'Not yet started'}</div>\n\t\t\t\t\t\t\t\t{settings.prizes ? <div className={styles.tieBreakLink} onClick={() => setFloat(floatContainer === 'prizes' ? '' : 'prizes')}>Prizes</div> : settings.description ? <div>{'\\u200b'}</div> : ''}\n\t\t\t\t\t\t\t\t<div className={styles.tieBreakLink} onClick={() => setFloat(floatContainer === 'tie breaks' ? '' : 'tie breaks')}>Tie breaks</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</>: null}\n\t\t\t\t\t</div>\n\n\n\t\t\t\t\t<Route path='/:id/:section?/:round?/' render={(rProps) => {\n\t\t\t\t\t\tlet round = parseInt(rProps.match.params.round);\n\t\t\t\t\t\tif (isNaN(round)) round = status.round;\n\t\t\t\t\t\tif (round < 0 || round > settings.totalRounds) return null;\n\t\t\t\t\t\treturn <ModeSwitcher\n\t\t\t\t\t\t\tid={props.match.params.id}\n\t\t\t\t\t\t\tsettings={settings}\n\t\t\t\t\t\t\tsection={rProps.match.params.section}\n\t\t\t\t\t\t\tround={round}\n\t\t\t\t\t\t\tloaded={loaded}\n\t\t\t\t\t\t/>\n\t\t\t\t\t}} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<section className={styles.tieBreakSection}>\n\t\t\t\t<div className={['container', styles.tieBreakContainer, floatContainer ? styles.visible : ''].join(' ')}>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div className={styles.tieBreakTitle} onClick={() => setFloat('')}>\n\t\t\t\t\t\t\t{floatContainer.toUpperCase()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className={styles.tieBreaks}>\n\t\t\t\t\t\t\t{floatContainer === 'tie breaks' ?\n\t\t\t\t\t\t\t\ttieBreaks.map(([, v], i) => <>\n\t\t\t\t\t\t\t\t\t<div key={[v, i, '1'].join(' ')}>#{i + 1}</div>\n\t\t\t\t\t\t\t\t\t<div key={[v, i, '2'].join(' ')}>{v.name}</div>\n\t\t\t\t\t\t\t\t</>) :\n\t\t\t\t\t\t\tfloatContainer === 'description' ?\n\t\t\t\t\t\t\t\tsettings.description :\n\t\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t\t<Route path='/:id/:section?/:round?/' render={(rProps) => {\n\t\t\t\tlet round: number;\n\t\t\t\tif (rProps.match.params.round === 'results') round = status.round + 1;\n\t\t\t\telse round = parseInt(rProps.match.params.round);\n\t\t\t\tif (isNaN(round)) round = status.round;\n\t\t\t\tif (settings.totalRounds === 'Infinity') settings.totalRounds = Infinity as number;\n\t\t\t\tif (round <= 0 || round > settings.totalRounds + 1) return null;\n\t\t\t\tlet section = rProps.match.params.section;\n\t\t\t\tif (!section) section = 'pairings';\n\t\t\t\tif (section !== 'pairings' && section !== 'standings') return null;\n\t\t\t\treturn <RoundSwitcher\n\t\t\t\t\tdirection={props.location.state.direction.slice(6)}\n\t\t\t\t\tsection={rProps.match.params.section}\n\t\t\t\t\tround={round}\n\t\t\t\t\tid={props.match.params.id}\n\t\t\t\t\tplayerDict={playerDict}\n\t\t\t\t\tstatus={status}\n\t\t\t\t\tsettings={settings}\n\t\t\t\t\tloaded={loaded}\n\t\t\t\t/>\n\t\t\t}} />\n\t\t\t<Route render={({location}) => {\n\t\t\t\tif (!loaded.status) return null;\n\t\t\t\treturn (\n\t\t\t\t\t<Switch location={location}>\n\t\t\t\t\t\t<Route exact path='/:id/' render={() => {\n\t\t\t\t\t\t\treturn <Redirect push to={{\n\t\t\t\t\t\t\t\tpathname: `/${settings.vanityURL || props.match.params.id}/${status.round ? 'pairings' : 'standings'}`,\n\t\t\t\t\t\t\t\tstate: props.history.location.state\n\t\t\t\t\t\t\t}}/>\n\t\t\t\t\t\t}}/>\n\t\t\t\t\t\t<Route path='/:id/stats/' render={() => {\n\t\t\t\t\t\t\treturn <Chart\n\t\t\t\t\t\t\t\tdirection={props.location.state.direction.slice(6)}\n\t\t\t\t\t\t\t\tround={status.round}\n\t\t\t\t\t\t\t\tstatus={status}\n\t\t\t\t\t\t\t\tplayers={Array.from(playerDict.values())}\n\t\t\t\t\t\t\t\tsettings={settings}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t}} />\n\t\t\t\t\t\t<Route path='/:id/tv/' render={() => {\n\t\t\t\t\t\t\treturn <TV\n\t\t\t\t\t\t\t\tdirection={props.location.state.direction.slice(6)}\n\t\t\t\t\t\t\t\tstreamURL={settings.streamURL}\n\t\t\t\t\t\t\t\tpop={pop}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t}} />\n\t\t\t\t\t\t<Route exact path='/:id/:section/' render={(rProps) => {\n\t\t\t\t\t\t\tif (status.round === undefined) return null;\n\t\t\t\t\t\t\treturn <Redirect push to={{\n\t\t\t\t\t\t\t\tpathname: rProps.match.url + (rProps.match.url.endsWith('/') ? '' : '/') + (rProps.match.params.section === 'pairings' && status.round && !status.active ? 'results' : status.round),\n\t\t\t\t\t\t\t\tstate: props.history.location.state\n\t\t\t\t\t\t\t}}/>\n\t\t\t\t\t\t}} />\n\t\t\t\t\t\t<Route path='/:id/pairings/:round' render={(rProps) => {\n\t\t\t\t\t\t\tif (rProps.match.params.round === 'results') {\n\t\t\t\t\t\t\t\treturn <DisplayNameContext.Provider value={getDisplayname}>\n\t\t\t\t\t\t\t\t\t<Results\n\t\t\t\t\t\t\t\t\t\tdirection={props.location.state.direction.slice(6)}\n\t\t\t\t\t\t\t\t\t\tstate={state} \n\t\t\t\t\t\t\t\t\t\tplayerDict={playerDict}\n\t\t\t\t\t\t\t\t\t\tsettings={settings}\n\t\t\t\t\t\t\t\t\t\tid={rProps.match.params.id}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</DisplayNameContext.Provider>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlet round = parseInt(rProps.match.params.round);\n\t\t\t\t\t\t\tif (isNaN(round)) return null;\n\t\t\t\t\t\t\tif (round < 0 || round > settings.totalRounds) return null;\n\t\t\t\t\t\t\treturn <Pairings\n\t\t\t\t\t\t\t\tdirection={props.location.state.direction.slice(6)}\n\t\t\t\t\t\t\t\tround={round}\n\t\t\t\t\t\t\t\tid={props.match.params.id}\n\t\t\t\t\t\t\t\tplayerDict={playerDict}\n\t\t\t\t\t\t\t\tstatus={status}\n\t\t\t\t\t\t\t\tsettings={settings}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t}}/>\n\t\t\t\t\t\t<TiebreakContext.Provider value={tieBreaks}>\n\t\t\t\t\t\t\t<Route path='/:id/standings/:round' render={(rProps) => {\n\t\t\t\t\t\t\t\tif (rProps.match.params.round === 'final') return <Redirect push to={{\n\t\t\t\t\t\t\t\t\tpathname: (rProps.match.url + (rProps.match.url.endsWith('/') ? '' : '/')).split('/').slice(0, -2).join('/') + '/' + settings.totalRounds,\n\t\t\t\t\t\t\t\t\tstate: rProps.history.location.state\n\t\t\t\t\t\t\t\t}} />\n\t\t\t\t\t\t\t\tlet round = parseInt(rProps.match.params.round);\n\t\t\t\t\t\t\t\tif (isNaN(round)) return null;\n\t\t\t\t\t\t\t\tif (round < 0 || round > settings.totalRounds) return null;\n\t\t\t\t\t\t\t\treturn <CrossTable\n\t\t\t\t\t\t\t\t\tdirection={props.location.state.direction.slice(6)}\n\t\t\t\t\t\t\t\t\tround={round}\n\t\t\t\t\t\t\t\t\tsetDisplayPlayer={() => {}}\n\t\t\t\t\t\t\t\t\tshow={() => {}}\n\t\t\t\t\t\t\t\t\tstatus={status}\n\t\t\t\t\t\t\t\t\tplayers={players}\n\t\t\t\t\t\t\t\t\tsettings={settings}\n\t\t\t\t\t\t\t\t\tstate={state}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t}} />\n\t\t\t\t\t\t</TiebreakContext.Provider>\n\t\t\t\t\t\t<Route path='/:id/*' component={NotFound} status={404} />\n\t\t\t\t\t</Switch>\n\t\t\t\t);\n\t\t\t}}/>\n\t\t\t<Draggable margin={10}>\n\t\t\t\t{poppedComponent ?\n\t\t\t\t\t<div onClick={() => pop(null)}><FaWindowClose /></div> :\n\t\t\t\t\t<div className={['jumpToTop', showScroll ? 'opaque' : 'transparent'].join(' ')} onClick={() => window.scrollTo(0, 0)}><FaAngleUp /></div> \n\t\t\t\t}\n\t\t\t\t<div dangerouslySetInnerHTML={{\n\t\t\t\t\t__html: poppedComponent?.outerHTML || ''\n\t\t\t\t}}/>\n\t\t\t</Draggable>\n        </div>\n    );\n}","\nimport React, { ReactElement } from 'react';\nimport { Link } from 'react-router-dom';\nimport * as regexes from './regexes';\n\nimport htmlParser from 'react-markdown/plugins/html-parser';\nimport HtmlToReact from 'html-to-react';\n\n// See https://github.com/aknuds1/html-to-react#with-custom-processing-instructions\n// for more info on the processing instructions\nconst processNodeDefinitions = new HtmlToReact.ProcessNodeDefinitions(React);\nexport const parseHtml = htmlParser({\n\tisValidNode: (node: parseHTMLElement) => node.type !== 'script',\n\tprocessingInstructions: [\n\t\t{\n\t\t\t// Anything else\n\t\t\tshouldProcessNode: function (node: parseHTMLElement): boolean {\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tprocessNode: processNodeDefinitions.processDefaultNode\n\t\t}\n\t]\n});\n\n\ninterface parseHTMLElement extends HTMLElement {\n\tname: string\n\tattribs: {\n\t\t[key: string]: any\n\t}\n\ttype: string\n}\n\ninterface aProps {\n\thref: string,\n\tchildren: HTMLElement[]\n}\n\nexport function RouterLink(props: aProps): ReactElement {\n\tif (regexes.link.test(props.href)) {\n\t\treturn <a href={props.href} target='_blank' rel='noopener noreferrer' onClick={(e) => {\n\t\t\te.stopPropagation();\n\t\t}}>{props.children}</a>;\n\t} else\n\treturn <Link to={{\n\t\tpathname: props.href,\n\t\tstate: {\n\t\t\tfrom: window.location.href.toString()\n\t\t}\n\t}}>{props.children}</Link>\n}","import React, { ReactElement } from 'react';\nimport { Player } from '../models';\nimport { lichess, zoom, chessCom } from '../assets/icons';\nimport { FaPhone, FaFacebook, FaEnvelope, FaSkype } from 'react-icons/fa';\n\nconst contactFields = {\n\tlichess: {\n\t\tname: 'Lichess.org',\n\t\tvalue: (p: Player) => p.lichess,\n\t\tlink: 'https://lichess.org/@/|',\n\t\ticon: ['img', lichess],\n\t\tauthMessage: 'Authentication via lichess.org is available to any admins of a linked lichess.org team account',\n\t\tcanLink: true\n\t},\n\tchessCom: {\n\t\tname: 'Chess.com',\n\t\tvalue: (p: Player) => p.chessCom,\n\t\tlink: 'https://chess.com/club/|',\n\t\tidLink: 'https://chess.com/members/|',\n\t\ticon: ['img', chessCom],\n\t\tauthMessage: 'Authentication via chess.com is available to any admins of a linked chess.com club account',\n\t\tcanLink: true\n\t},\n\tzoom: {\n\t\tvalue: (p: Player) => p.contact?.zoom,\n\t\tlink: 'https://us02web.zoom.us/user/|/profile',\n\t\ticon: ['img', zoom]\n\t},\n\tskype: {\n\t\tvalue: (p: Player) => p.contact?.skype,\n\t\ticon: ['svg', <FaSkype />]\n\t},\n\tfacebook: {\n\t\tvalue: (p: Player) => p.contact?.facebook,\n\t\tlink: 'https://facebook.com/|',\n\t\tidLink: 'https://facebook.com/profile.php?id=|',\n\t\ticon: ['svg', <FaFacebook />],\n\t\tauthMessage: 'Authentication via Facebook is not available at this time',\n\t\tcanLink: true\n\t},\n\tphone: {\n\t\tvalue: (p: Player) => p.contact?.phone,\n\t\ticon: ['svg', <FaPhone />]\n\t},\n\temail: {\n\t\tvalue: (p: Player) => p.contact?.email,\n\t\ticon: ['svg', <FaEnvelope />],\n\t\tlink: 'mailto:|',\n\t\tpermanent: true,\n\t\tauthMessage: 'Authentication via email requires a matching verified email address',\n\t\tcanLink: true\n\t}\n} as {\n\t[key: string]: ContactMeta\n}\n\nexport default contactFields;\n\nexport interface ContactMeta {\n\tid?: string\n\tvalue: (p: Player) => string | undefined\n\tlink?: string\n\tidLink?: string\n\ticon: ['img' | 'svg', ReactElement | string]\n\tname?: string\n\tpermanent?: boolean\n\tauthMessage?: string\n\tcanLink?: boolean\n}","import React, { ReactElement, useState, useEffect, RefObject, useRef, useContext, useCallback, useReducer } from 'react';\nimport Markdown from 'react-markdown';\nimport { MdAnnouncement } from 'react-icons/md';\nimport { Notif } from '../interfaces';\nimport * as regexes from '../utils/regexes';\nimport { FaFacebook, FaTwitter, FaTwitch, FaGithub, FaTimes, FaTimesCircle, FaCheckCircle } from 'react-icons/fa';\nimport styles from '../css/components.module.css';\n\nimport { capitalise } from '../utils/prototype';\nimport { parseHtml, RouterLink } from '../utils/plugins';\nimport contactFields from '../resources/contact';\nimport { AlertContext } from '../Contexts';\n\nexport function getLogo(brand: string): ReactElement | null {\n\tswitch (brand) {\n\t\tcase 'chess.com': {\n\t\t\treturn <img src={contactFields.chessCom.icon[1] as string} alt='chessCom' className={styles.icon} /> ;\n\t\t}\n\t\tcase 'facebook.com': {\n\t\t\treturn <FaFacebook style={{color: '#3b5998'}} />;\n\t\t}\n\t\tcase 'twitter.com': {\n\t\t\treturn <FaTwitter style={{color: '#00aced'}} />;\n\t\t}\n\t\tcase 'twitch.tv': {\n\t\t\treturn <FaTwitch style={{color: '#6441a5'}} />;\n\t\t}\n\t\tcase 'github.com': {\n\t\t\treturn <FaGithub style={{color: '#333'}} />;\n\t\t}\n\t\tdefault: {\n\t\t\treturn <MdAnnouncement />;\n\t\t}\n\t}\n}\n\nexport interface AlertProps {\n\ttitle: string\n\ticon?: JSX.Element | string\n\tlink?: string\n\tmessage: JSX.Element | string\n\tresolve?: (value: string) => void\n\treject?: () => void\n\ttype?: 'error' | 'confirm' | 'prompt'\n\tprompt?: {\n\t\ttype?: 'text' | 'number'\n\t\tvalidate?: (value: string) => boolean\n\t\terrorMessage?: string\n\t\tallowNull?: boolean\n\t\tdefaultValue?: string\n\t\tplaceholder?: string\n\t}\n}\n\nexport function AlertBox(props: AlertProps) {\n\n\tconst setAlert = useContext(AlertContext);\n\tconst setMessage = useCallback((message: string) => setAlert({ title: '', message }), [setAlert]);\n\tconst [error, toggleError] = useReducer((state: boolean) => !state, false);\n\n\tconst input = useRef(null) as RefObject<HTMLInputElement>;\n\n\tconst handleSubmit = useCallback(() => {\n\t\tlet value = input.current?.value.trim();\n\t\tif (!value && !props.prompt?.allowNull) return;\n\t\tif (props.prompt?.validate && !props.prompt.validate(value as string)) return toggleError();\n\t\tif (props.type === 'prompt' && props.resolve) props.resolve(value as string);\n\t\tsetMessage('');\n\t}, [input, props, setMessage]);\n\t\n\tconst handleKeyDown = useCallback((e: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tswitch (e.keyCode) {\n\t\t\tcase 27:\n\t\t\t\tlet i = input.current;\n\t\t\t\tif (i) i.value = '';\n\t\t\t\tbreak;\n\t\t\tcase 13:\n\t\t\t\thandleSubmit();\n\t\t\t\tbreak;\n\t\t}\n\t}, [handleSubmit, input]);\n\n\tif (!props.message) return null;\n\tlet domain = (props.link || '').match(regexes.link);\n\tconst icon = typeof props.icon !== 'string' ?\n\t\tprops.icon :\n\t\tprops.icon ?\n\t\t\tgetLogo(props.icon) :\n\t\t\tdomain ?\n\t\t\t\tgetLogo(domain[1]) :\n\t\t\t\tnull;\n\n\treturn <div className={styles.shade} onClick={() => setMessage('')}>\n\t\t<div className={[styles.section].join(' ')}>\n\t\t\t<div className={[styles.lightBoxTitle, props.type === 'error' ? styles.error : ''].join(' ')} onClick={() => setMessage('')}>\n\t\t\t\t<div>\n\t\t\t\t\t{props.link ? <a className={styles.iconLink} href={props.link} rel='noopener noreferrer' target='_blank'>\n\t\t\t\t\t\t{icon}\n\t\t\t\t\t</a> :\n\t\t\t\t\t<div>{icon}</div>}\n\t\t\t\t</div>\n\t\t\t\t<div>{props.title}</div>\n\t\t\t</div>\n\t\t\t<div className={styles.lightBoxContent} onClick={(e) => e.stopPropagation()}>\n\t\t\t\t{props.message}\n\t\t\t\t{props.link ? <><a href={props.link} rel='noopener noreferrer' target='_blank'>{props.link}</a></> : null}\n\t\t\t\t{props.type === 'prompt' ?\n\t\t\t\t\t<input\n\t\t\t\t\t\tref={input}\n\t\t\t\t\t\tonKeyDown={handleKeyDown}\n\t\t\t\t\t\ttype={props.prompt?.type || 'text'}\n\t\t\t\t\t\tspellCheck={false}\n\t\t\t\t\t\tautoComplete='game-link'\n\t\t\t\t\t\tautoFocus\n\t\t\t\t\t\tdefaultValue={props.prompt?.defaultValue}\n\t\t\t\t\t/> :\n\t\t\t\t\tnull\n\t\t\t\t}\n\t\t\t\t{error ?\n\t\t\t\t\t<div className={styles.error}>{props.prompt?.errorMessage}</div> :\n\t\t\t\t\tnull\n\t\t\t\t}\n\t\t\t</div>\n\t\t\t{props.type === 'confirm' || props.type === 'prompt' ?\n\t\t\t\t<div className={styles.dateTime} onClick={(e) => e.stopPropagation()}>\n\t\t\t\t\t<div className={styles.reject} onClick={() => {\n\t\t\t\t\t\tif (props.reject) props.reject();\n\t\t\t\t\t\tsetMessage('');\n\t\t\t\t\t}} >\n\t\t\t\t\t\t<FaTimesCircle />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={styles.resolve} onClick={handleSubmit}>\n\t\t\t\t\t\t<FaCheckCircle />\n\t\t\t\t\t</div>\n\t\t\t\t</div> :\n\t\t\t\t<div className={styles.dateTime}>\n\t\t\t\t\t<div className={styles.footer}>\n\t\t\t\t\t\t{new Date(Date.now()).toString().slice(0, 21)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t}\n\t\t</div>\n\t</div>\n}\n\nexport default function NotifBox(props: {\n\tnotif: Notif\n\tselect: (n: Notif) => void\n}) {\n\n\tlet n = props.notif;\n\tif (!n.id) return null;\n\tlet icon = <MdAnnouncement /> as JSX.Element | null;\n\tlet domain = (n.link || '').match(regexes.link);\n\tif (domain) icon = getLogo(domain[1]);\n\n\treturn <div className={styles.shade} onClick={() => props.select({} as Notif)}>\n\t\t<div className={[styles.section].join(' ')}>\n\t\t\t<div className={styles.lightBoxTitle}>\n\t\t\t\t<div>\n\t\t\t\t\t{n.link ? <a className={styles.iconLink} href={n.link} rel='noopener noreferrer' target='_blank'>\n\t\t\t\t\t\t{icon}\n\t\t\t\t\t</a> :\n\t\t\t\t\t<div>{icon}</div>}\n\t\t\t\t</div>\n\t\t\t\t<div>{n.title}</div>\n\t\t\t</div>\n\t\t\t<div className={styles.lightBoxContent} onClick={(e) => e.stopPropagation()}>\n\t\t\t\t<Markdown\n\t\t\t\t\tsource={n.content.trim() + (n.link ? `\\n\\n[${n.link}](${n.link})` : '')}\n\t\t\t\t\tescapeHtml={false}\n\t\t\t\t\tastPlugins={[parseHtml]}\n\t\t\t\t\trenderers={{\n\t\t\t\t\t\tlink: RouterLink\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div className={styles.dateTime}>\n\t\t\t\t<div className={styles.footer}>\n\t\t\t\t\t{capitalise(n.role)} Announcement | {new Date(n.createdAt).toString().slice(0, 21)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n}","import React, { useEffect, useState, useCallback, useContext } from 'react';\nimport { StaticContext } from 'react-router';\nimport { Link, RouteComponentProps } from 'react-router-dom';\nimport { NotifContext } from './Contexts';\n\nimport * as regexes from './utils/regexes';\nimport styles from './css/home.module.css';\nimport { GET, socket } from './utils/requests';\nimport { Notif, TournamentStatus } from './interfaces';\nimport { FaAngleRight } from 'react-icons/fa';\nimport { GoPrimitiveDot } from 'react-icons/go'\nimport { MdAnnouncement } from 'react-icons/md';\nimport { getLogo } from './components/NotifBox';\n\nlet connected = 0;\n\nexport default function Home(props: RouteComponentProps<any, StaticContext, any>) {\n\n\tconst [tournaments, setTournaments] = useState([] as TournamentStatus[]);\n\tconst [notifications, setNotifications] = useState([] as Notif[]);\n\tconst select = useContext(NotifContext);\n\n\tconst updateTournaments = useCallback(() => GET({ url: '/tournaments' })\n\t\t.then(setTournaments), [setTournaments]);\n\n\tconst updateNotifications = useCallback(() => GET({ url: '/notifications' })\n\t\t\t.then((n) => setNotifications(n.sort((a: Notif, b: Notif) => new Date(b.createdAt).valueOf() - new Date(a.createdAt).valueOf()))), [setNotifications]);\n\n\tuseEffect(() => {\n\t\tupdateTournaments();\n\t\tupdateNotifications();\n\t}, [updateTournaments, updateNotifications]);\n\n\tuseEffect(() => {\n\t\tsocket.on('connected_count', (count: number) => connected = count);\n\t}, []);\n\n\treturn (<>\n        <div id='main' className={'animated-' + props.location.state?.direction}>\n\t\t\t<div className={styles.container}>\n\t\t\t\t<div className={styles.title}>\n\t\t\t\t\t<h1><span className='bold'>Results</span> by ScorchChess</h1>\n\t\t\t\t\t<h3>Your universal platform for results and pairings. Attractive. Automated. Effortless.</h3>\n\t\t\t\t</div>\n\t\t\t\t<div className={['container', styles.announcements].join(' ')}>\n\t\t\t\t\t<table className={[styles.tableAnnounce].join(' ')}>\n\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<th className={styles.sectionHeader}>\n\t\t\t\t\t\t\t\t\tAnnouncements\n\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t{notifications.map((n, i) => {\n\t\t\t\t\t\t\t\tlet icon = <MdAnnouncement /> as JSX.Element | null;\n\t\t\t\t\t\t\t\tlet domain = (n.link || '').match(regexes.link);\n\t\t\t\t\t\t\t\tif (domain) icon = getLogo(domain[1]);\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<tr className={styles.notificationRow} key={['notification', i].join('.')}>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<div onClick={() => select(n)}>\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t{n.link ?\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a className={styles.iconLink} href={n.link} rel='noopener noreferrer' target='_blank'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{icon}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</a> :\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div>icon</div>\n\t\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className='bold'>{n.title}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className={styles.notifContent}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{n.content}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className={styles.expando}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<FaAngleRight />\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t</tbody>\n\t\t\t\t\t</table>\n\t\t\t\t</div>\n\t\t\t\t<div className={['container', styles.tournaments].join(' ')}>\n\t\t\t\t\t<table className={[styles.tableAnnounce].join(' ')}>\n\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t<tr className={styles.sizer}>\n\t\t\t\t\t\t\t\t<th /><th /><th /><th />\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<th colSpan={4} className={styles.sectionHeader}>\n\t\t\t\t\t\t\t\t\tPublic Tournaments\n\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr className={styles.sectionHeader}>\n\t\t\t\t\t\t\t\t<th>Name</th>\n\t\t\t\t\t\t\t\t<th>Started</th>\n\t\t\t\t\t\t\t\t<th>Round</th>\n\t\t\t\t\t\t\t\t<th />\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t{tournaments.sort((a, b) => new Date(b.updatedAt).valueOf() - new Date(a.updatedAt).valueOf()).map((tourn, i) => {\n\t\t\t\t\t\t\t\tlet dateStarted = new Date(tourn.createdAt).toString();\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<tr key={[tourn.id, i].join('.')} className={styles.rowLink}>\n\t\t\t\t\t\t\t\t\t\t<td><Link className={styles.tournamentLink} to={'/' + tourn.id}>\n\t\t\t\t\t\t\t\t\t\t\t{tourn.name || tourn.id}\n\t\t\t\t\t\t\t\t\t\t</Link></td>\n\t\t\t\t\t\t\t\t\t\t<td><Link className={styles.tournamentLink} to={'/' + tourn.id}>\n\t\t\t\t\t\t\t\t\t\t\t{dateStarted.slice(0, 11)}\n\t\t\t\t\t\t\t\t\t\t</Link></td>\n\t\t\t\t\t\t\t\t\t\t<td><Link className={styles.tournamentLink} to={'/' + tourn.id}>\n\t\t\t\t\t\t\t\t\t\t\t{tourn.round}\n\t\t\t\t\t\t\t\t\t\t</Link></td>\n\t\t\t\t\t\t\t\t\t\t<td><Link className={styles.tournamentLink} to={'/' + tourn.id}>\n\t\t\t\t\t\t\t\t\t\t\t<FaAngleRight />\n\t\t\t\t\t\t\t\t\t\t</Link></td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t})}\t\t\t\t\n\t\t\t\t\t\t</tbody>\n\t\t\t\t\t</table>\n\t\t\t\t</div>\n\t\t\t\t<div className={socket.connected ? styles.connected : styles.disconnected}>\n\t\t\t\t\t<GoPrimitiveDot /> {connected || '-'} users online\n\t\t\t\t</div>\n\t\t\t\t<a href='https://beta.scorchapp.co.uk' rel='noopener noreferrer' target='_blank' className={[styles.new].join(' ')}>\n\t\t\t\t\tCreate New Tournament\n\t\t\t\t\t<FaAngleRight />\n\t\t\t\t</a>\n\t\t\t</div>\t\t\t\t\n\t\t</div>\n\t</>)\n}","import React, { useState, useCallback, useEffect } from 'react';\nimport { StaticContext } from 'react-router';\nimport { Link, RouteComponentProps } from 'react-router-dom';\nimport styles from './css/community.module.css';\nimport { GET, POST } from '../utils/requests';\nimport { ProfileData, Team } from '../interfaces';\nimport { FaCrown, FaCircle } from 'react-icons/fa';\n\nexport default function Community(props: RouteComponentProps<any, StaticContext, any>) {\n\n\tconst [users, setUsers] = useState([]);\n\tconst updateUsers = useCallback(() => GET({ url: '/users' })\n\t\t.then(setUsers), [setUsers]);\n\tuseEffect(() => {\n\t\tupdateUsers();\n\t}, [updateUsers]);\n\n\tconst [teams, setTeams] = useState([]);\n\tconst updateTeams = useCallback(() => GET({ url: '/teams' })\n\t\t.then(setTeams), [setTeams]);\n\tuseEffect(() => {\n\t\tupdateTeams();\n\t}, [updateTeams]);\n\n\treturn (\n        <div id='main' className={'animated-' + props.location.state?.direction}>\n\t\t\t<div className={styles.container}>\n\t\t\t\t<section className='container'>\n\t\t\t\t\t<div className={styles.title}>\n\t\t\t\t\t\t<div><b>Users</b></div>\n\t\t\t\t\t\t<div className={'light'}>{users.length}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={styles.userTable}>\n\t\t\t\t\t\t{users.map((u: ProfileData, i: number) => {\n\t\t\t\t\t\t\treturn <>\n\t\t\t\t\t\t\t\t<div key={['status', i].join('.')} className={styles.status}>\n\t\t\t\t\t\t\t\t\t{u.isLicensed ? <FaCrown /> : <FaCircle style={{fontSize: '0.5em'}} />}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<Link key={['username', i].join('.')} className={styles.profile} to={'/@/' + u.username}>\n\t\t\t\t\t\t\t\t\t{u.username}\n\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t</section>\n\t\t\t\t<section className='container'>\n\t\t\t\t\t<div className={styles.title}>\n\t\t\t\t\t\t<div><b>Teams</b></div>\n\t\t\t\t\t\t<div className={'light'}>{teams.length}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={styles.userTable}>\n\t\t\t\t\t\t{teams.map((u: Team, i: number) => {\n\t\t\t\t\t\t\treturn <>\n\t\t\t\t\t\t\t\t<div />\n\t\t\t\t\t\t\t\t<Link key={['username', i].join('.')} className={styles.profile} to={'/team/' + u.id}>\n\t\t\t\t\t\t\t\t\t{u.name}\n\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t</section>\n\t\t\t</div>\n\t\t</div>\n\t)\n}","import React, { ReactElement, Dispatch, SetStateAction, useContext, useMemo, useState, useEffect, useCallback, useReducer } from 'react';\nimport { Link } from 'react-router-dom';\nimport { isMobile } from '../utils/auth';\nimport styles from '../css/header.module.css';\nimport { LoginContext } from '../App';\nimport { ProfileData } from '../interfaces';\nimport { FaBars, FaBell } from 'react-icons/fa';\n\nexport interface TitlebarProps {\n\tsetID: Dispatch<SetStateAction<string>>\n\tprofile: ProfileData\n\treferrer: string\n\tcurrentPath: string\n}\n\nexport default function Header(props: TitlebarProps): ReactElement | null {\n\n\tconst pathDict = useMemo(() => { return {\n\t\t['/@/' + props.profile.username]: 'login',\n\t\t'/login': 'login',\n\t\t'/@/': 'community',\n\t\t'/community': 'community',\n\t\t'/team/': 'community',\n\t\t'/player/': 'community',\n\t}}, [props.profile.username]);\n\n\tconst loggedIn = useContext(LoginContext);\n\tconst [mobileMenu, setMenu] = useState(false);\n\tconst [display, setDisplay] = useState(true);\n\tconst [showNotifs, toggleNotifs] = useReducer((state) => !state, false);\n    const buttons = useMemo(() => [\n\t\t{\n\t\t\tname: <><span className={'bold'}>Results</span>{'\\u200b '}by ScorchChess</>,\n\t\t\tmobile: 'HOME',\n\t\t\turl: '/',\n\t\t\tselected: !Object.entries(pathDict).some(([k]) => props.currentPath.startsWith(k))\n\t\t},\n\t\t{\n\t\t\tname: 'COMMUNITY',\n\t\t\turl: '/community',\n\t\t\tselected: pathDict[Object.keys(pathDict).find((k) => props.currentPath.startsWith(k)) as keyof typeof pathDict] === 'community'\n\t\t},\n\t\t{\n\t\t\tname: 'ABOUT',\n\t\t\turl: 'https://scorchapp.co.uk',\n\t\t\tmobileIgnore: true\n\t\t},\n\t\t{\n\t\t\tname: 'DESKTOP',\n\t\t\turl: 'https://beta.scorchapp.co.uk',\n\t\t\tmobileIgnore: true\n\t\t},\n\t\t{\n\t\t\tname: <FaBell />,\n\t\t\tonClick: toggleNotifs,\n\t\t\tnative: true,\n\t\t\tmobileIgnore: true\n\t\t},\n\t\t{\n\t\t\tname: loggedIn ? (props.profile.username || 'PROFILE') : 'SIGN IN',\n\t\t\turl: loggedIn ? '/@/' + props.profile.username : '/login',\n\t\t\tselected: pathDict[Object.keys(pathDict).find((k) => props.currentPath.startsWith(k)) as keyof typeof pathDict] === 'login',\n\t\t\tnative: true\n\t\t}\n\t], [loggedIn, props.profile, props.currentPath, pathDict, toggleNotifs]);\n\n\tconst checkIfFullScreen = useCallback(() => {\n\t\tif (window.innerWidth === window.screen.width && window.innerHeight === window.screen.height) setDisplay(false);\n\t\telse setDisplay(true);\n\t}, [setDisplay]);\n\n\tuseEffect(() => {\n\t\tdocument.addEventListener('fullscreenchange', checkIfFullScreen);\n\t\treturn () => document.removeEventListener('fullscreenchange', checkIfFullScreen);\n\t}, [checkIfFullScreen]);\n\n\tconst checkKeyPress = useCallback((e: KeyboardEvent) => {\n\t\tif (e.keyCode !== 122) return;\n\t\tif ((window.innerWidth > window.screen.width - 10) && (window.innerHeight > window.screen.height - 10)) setDisplay(false);\n\t\telse setDisplay(true);\n\t}, [setDisplay]);\n\n\tuseEffect(() => {\n\t\tdocument.addEventListener('keydown', checkKeyPress);\n\t\treturn () => document.removeEventListener('keydown', checkKeyPress);\n\t}, [checkIfFullScreen, checkKeyPress]);\n\n\tconst [height, setHeight] = useState(12);\n\tconst updateHeight = useCallback(() => {\n\t\tif (!window.scrollY) setHeight(12);\n\t\telse setHeight(6);\n\t}, [setHeight]);\n\tuseEffect(() => {\n\t\tdocument.addEventListener('scroll', updateHeight);\n\t\treturn () => document.removeEventListener('scroll', updateHeight);\n\t}, [updateHeight]);\n\t\n\tif (!display) return null;\n\n    return (<>\n        <div className={styles.header} style={{ height: height + 'vh' }}>\n            <Link \n\t\t\t\tto={{\n\t\t\t\t\tpathname: '/'\n\t\t\t\t}}\n\t\t\t\tclassName={styles.logoWrapper}\n\t\t\t>\n                <img\n                    src={process.env.PUBLIC_URL + '/favicon.png'}\n                    className={styles.logo}\n\t\t\t\t\talt='logo'\n\t\t\t\t\tstyle={{ height: (height* 1.618) + 'vh' }}\n                />\n            </Link>\n            {!isMobile() ? <>\n                <div className={styles.buttonContainer}>\n                    {buttons.map((b, i) => {\n                        return b.url && b.url.startsWith('/') ? \n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tkey={['headerLink', i].join('.')}\n\t\t\t\t\t\t\t\tclassName={[styles.headerButton, b.selected ? styles.selected : '', ].join(' ')}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Link \n\t\t\t\t\t\t\t\t\tclassName={[styles.button, b.native ? styles.native : ''].join(' ')}\n\t\t\t\t\t\t\t\t\tto={{\n\t\t\t\t\t\t\t\t\t\tpathname: b.url\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{b.name}\n\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t</div> :\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tkey={['headerLink', i].join('.')}\n\t\t\t\t\t\t\t\tclassName={[styles.headerButton, b.selected ? styles.selected : '', ].join(' ')}\n\t\t\t\t\t\t\t><a\n\t\t\t\t\t\t\t\tkey={['headerLink', i].join('.')}\n\t\t\t\t\t\t\t\tclassName={[styles.button, b.native ? styles.native : ''].join(' ')}\n\t\t\t\t\t\t\t\tonClick={b.onClick}\n\t\t\t\t\t\t\t\thref={b.url}\n\t\t\t\t\t\t\t\ttarget='_blank'\n\t\t\t\t\t\t\t\trel='noopener noreferrer'\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{b.name}\n\t\t\t\t\t\t\t</a></div>                      \n                    })}\t\t\t\t\t\n                </div>\n            </> :\n\t\t\t<div className={styles.menuButton} onClick={() => setMenu(!mobileMenu)}>\n\t\t\t\t<FaBars />\n\t\t\t</div>\n\t\t}\n        </div>\n\t\t<div className={styles.notifications} style={{\n\t\t\topacity: showNotifs ? 1 : 0,\n\t\t\ttop: height + 'vh',\n\t\t\tvisibility: showNotifs ? 'visible' : 'hidden'\n\t\t}}>\n\t\t\t<div><strong>Notifications</strong></div>\n\t\t\t<hr />\n\t\t\tYou have no new notifications at this time.\n\t\t</div>\n\t\t{isMobile() ?\n\t\t\t<div className={styles.mobileMenu} style={{\n\t\t\t\tpaddingTop: mobileMenu ? undefined : '0px',\n\t\t\t\tmaxHeight: mobileMenu ? '100%' : '0px'\n\t\t\t}}>\n\t\t\t\t{buttons.map((b, i) => {\n\t\t\t\t\tif (b.mobileIgnore) return null;\n\t\t\t\t\tlet name = b.mobile || b.name;\n\t\t\t\t\tif (typeof name === 'string') name = name.toLowerCase();\n\t\t\t\t\treturn <>\n\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\tkey={[b, i].join('.')}\n\t\t\t\t\t\t\tclassName={styles.button}\n\t\t\t\t\t\t\tonClick={() => setMenu(false)}\n\t\t\t\t\t\t\tto={{\n\t\t\t\t\t\t\t\tpathname: b.url,\n\t\t\t\t\t\t\t\tstate: {\n\t\t\t\t\t\t\t\t\tfrom: window.location.pathname\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{name}\n\t\t\t\t\t\t</Link>\n\t\t\t\t\t</>\n\t\t\t\t})}\n\t\t\t</div> :\n\t\tnull}\n    </>);\n}","import React, { ReactElement, useState, useCallback, useMemo, useEffect, CSSProperties, useContext } from 'react';\r\nimport { StaticContext } from 'react-router';\r\nimport { Redirect, RouteComponentProps } from 'react-router-dom';\r\nimport url from 'url';\r\nimport { server, FORM, cookies, GET } from '../utils/requests';\r\n\r\nimport styles from '../css/login.module.css';\r\nimport { FaAngleLeft, FaAngleUp, FaAngleRight, FaAngleDown } from 'react-icons/fa';\r\nimport { isMobile } from '../utils/auth';\r\nimport { AlertContext } from '../Contexts';\r\n\r\nexport function Crown(props: {\r\n\tclassNames?: {[key: string]: string}\r\n}) {\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tclassName={[styles.logo, props.classNames?.logo].join(' ')}\r\n\t\t>\r\n\t\t\t<img className={styles.staticLogo} src={process.env.PUBLIC_URL + '/favicon.png'} alt='swiss-logo.png'/>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\ninterface LoginProps {\r\n\tloggedIn: boolean | undefined\r\n\tmode: 'login' | 'register' | 'reset/password'\r\n\tsetSession: (s: string) => void\r\n\tupdateProfile: () => void\r\n}\r\nexport default function Login(props: RouteComponentProps<any, StaticContext, any> & LoginProps) {\r\n\r\n\tconst [mode, setMode] = useState(props.mode as string);\r\n\tconst [errorMessage, triggerError] = useState('');\r\n\tconst { setSession } = props;\r\n\tconst [shouldRedirect, redirectTo] = useState('');\r\n\tconst login = useCallback(async (sessionID: string): Promise<void> => {\r\n\t\tawait cookies.set('sessionID', sessionID );\r\n\t\tsetSession(sessionID);\r\n\t\tsetTimeout(() => redirectTo('/me'), 2000);\r\n\t}, [setSession, redirectTo]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (mode !== 'register' && mode !== 'login' && mode !== 'reset/password') return;\r\n\t\twindow.history.pushState('', document.title, '/' + mode + window.location.search);\r\n\t}, [mode]);\r\n\r\n\tconst handleSubmit = useCallback((e: React.FormEvent<HTMLFormElement>): void => {\r\n\t\tFORM(e)\r\n\t\t\t.then(login)\r\n\t\t\t.catch((e) => {\r\n\t\t\t\tif (e && e.response && e.response.data) triggerError(e.response.data);\r\n\t\t\t\tconsole.error(e);\r\n\t\t\t});\r\n\t}, [triggerError, login]);\r\n\r\n\tconst setAlert = useContext(AlertContext);\r\n\r\n\tconst ForgottenContainer = useCallback(function ForgottenContainer({ style }: { style?: CSSProperties }) {\r\n\t\treturn (\r\n\t\t\t<div className={styles.forgottenContainer} style={style}>\r\n\t\t\t\t<div className={['input', styles.forgotten].join(' ')} onClick={() => setMode('reminder')}>username reminder</div>\r\n\t\t\t\t<div className={['input', styles.forgotten].join(' ')} onClick={() => setMode('reset')}>password reset</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}, [setMode]);\r\n\r\n\tconst PasswordForm = useCallback(function PasswordForm(): ReactElement | null {\r\n\t\tconst [name, setName] = useState('');\r\n\r\n\t\tlet code = props.location.search.slice(1).split('&').find(p => p.startsWith('code='))?.slice('code='.length);\r\n\t\t\r\n\t\tuseEffect(() => {\r\n\t\t\tif (!code) return;\r\n\t\t\tGET({ url: 'exchangeSession', params: { sid: code }}).then(setName);\r\n\t\t}, [code]);\r\n\r\n\t\tif (!code) {\r\n\t\t\tredirectTo('/login');\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<form\r\n\t\t\t\tclassName={styles.form}\r\n\t\t\t\tmethod='POST'\r\n\t\t\t\taction={url.resolve(server, 'triggerPasswordReset')}\r\n\t\t\t\tonSubmit={(e) => {\r\n\t\t\t\t\tlet form = e.target as HTMLFormElement;\r\n\t\t\t\t\tif (form.password.value !== form.passwordRepeat.value) {\r\n\t\t\t\t\t\tsetAlert({\r\n\t\t\t\t\t\t\ttitle: 'Password reset',\r\n\t\t\t\t\t\t\tmessage: 'Passwords must match!',\r\n\t\t\t\t\t\t\ttype: 'error'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn e.preventDefault();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tFORM(e).then(() => redirectTo('/login'));\t\t\t\t\t\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<div className={['input', styles.input, styles.text].join(' ')}>\r\n\t\t\t\t\t{name}\r\n\t\t\t\t</div>\r\n\t\t\t\t<input type='password' name='password' autoComplete='current-password' required placeholder='new password' className={['input', styles.input].join(' ')} />\r\n\t\t\t\t<input type='password' name='passwordRepeat' required placeholder='repeat password' className={['input', styles.input].join(' ')} />\r\n\t\t\t\t<input type='hidden' name='sid' required value={props.location.search.slice(1).split('&').find(p => p.startsWith('code='))?.slice('code='.length)} />\r\n\t\t\t\t<button type='submit' className={['input', styles.submit].join(' ')}>\r\n\t\t\t\t\tRESET PASSWORD\r\n\t\t\t\t</button>\r\n\t\t\t</form>\r\n\t\t);\r\n\t}, [setAlert, props.location.search, redirectTo]);\r\n\r\n\tconst resetForm = useMemo((): ReactElement => {\r\n\t\treturn (\r\n\t\t\t<form\r\n\t\t\t\tclassName={styles.form}\r\n\t\t\t\tmethod='POST'\r\n\t\t\t\taction={url.resolve(server, 'requestPasswordReset')}\r\n\t\t\t\tonSubmit={(e) => FORM(e).then(() => setAlert({\r\n\t\t\t\t\ttitle: 'Password reset',\r\n\t\t\t\t\tmessage: 'Successfully sent a password reset link to the email on file. Check your inbox!'\r\n\t\t\t\t}))}\r\n\t\t\t>\r\n\t\t\t\t<div className={['input', styles.input, styles.back].join(' ')} onClick={() => setMode('login')}>BACK</div>\r\n\t\t\t\t<input type='text' name='username' autoComplete='username' required placeholder='username' className={['input', styles.input].join(' ')} />\r\n\t\t\t\t<ForgottenContainer />\r\n\t\t\t\t<button type='submit'className={['input', styles.submit].join(' ')}>\r\n\t\t\t\t\tREQUEST PASSWORD RESET\r\n\t\t\t\t</button>\r\n\t\t\t</form>\r\n\t\t);\r\n\t}, [setMode, setAlert]);\r\n\r\n\tconst reminderForm = useMemo((): ReactElement => {\r\n\t\treturn (\r\n\t\t\t<form\r\n\t\t\t\tclassName={styles.form}\r\n\t\t\t\tmethod='POST'\r\n\t\t\t\taction={url.resolve(server, 'requestUsernameReminder')}\r\n\t\t\t\tonSubmit={(e) => FORM(e).then(() => setAlert({\r\n\t\t\t\t\ttitle: 'Username reminder',\r\n\t\t\t\t\tmessage: 'Successfully sent a username reminder. Check your inbox!'\r\n\t\t\t\t}))}\r\n\t\t\t>\r\n\t\t\t\t<div className={['input', styles.input, styles.back].join(' ')} onClick={() => setMode('login')}>BACK</div>\r\n\t\t\t\t<input type='email' name='email' autoComplete='email' required placeholder='email' className={['input', styles.input].join(' ')} />\r\n\t\t\t\t<ForgottenContainer />\r\n\t\t\t\t<button type='submit'className={['input', styles.submit].join(' ')}>\r\n\t\t\t\t\tREQUEST USERNAME REMINDER\r\n\t\t\t\t</button>\r\n\t\t\t</form>\r\n\t\t);\r\n\t}, [setMode]);\r\n\r\n\tconst loginForm = useMemo((): ReactElement => {\r\n\t\treturn (\r\n\t\t\t<form\r\n\t\t\t\tclassName={styles.form}\r\n\t\t\t\tmethod='POST'\r\n\t\t\t\tonSubmit={handleSubmit}\r\n\t\t\t\taction={url.resolve(server, 'login')}\r\n\t\t\t>\r\n\t\t\t\t<input type='text' name='username' autoComplete='username' required placeholder='username' className={['input', styles.input].join(' ')} />\r\n\t\t\t\t<input type='password' name='password' autoComplete='current-password' required placeholder='password' className={['input', styles.input].join(' ')} />\r\n\t\t\t\t<ForgottenContainer />\r\n\t\t\t\t<button type='submit'className={['input', styles.submit].join(' ')}>\r\n\t\t\t\t\tLOGIN\r\n\t\t\t\t</button>\r\n\t\t\t</form>\r\n\t\t);\r\n\t}, [handleSubmit]);\r\n\r\n\tconst registerForm = useMemo((): ReactElement => {\r\n\t\treturn (\r\n\t\t\t<form\r\n\t\t\t\tclassName={styles.form}\r\n\t\t\t\tmethod='POST'\r\n\t\t\t\tonSubmit={handleSubmit}\r\n\t\t\t\taction={url.resolve(server, 'register')}\r\n\t\t\t>\r\n\t\t\t\t<input type='text' minLength={4} name='username' required placeholder='username' className={['input', styles.input].join(' ')}></input>\r\n\t\t\t\t<input type='password' name='password' required placeholder='password' minLength={8} className={['input', styles.input].join(' ')}></input>\r\n\t\t\t\t<input type='email' name='email' autoComplete='email' required placeholder='email' className={['input', styles.input].join(' ')}></input>\r\n\t\t\t\t<button type='submit' className={['input', styles.submit].join(' ')} onSubmit={(e) => {\r\n\t\t\t\t\tlet button = e.target as HTMLButtonElement;\r\n\t\t\t\t\tlet form = button.parentElement as HTMLFormElement;\r\n\t\t\t\t\tform.requestSubmit();\r\n\t\t\t\t}}>\r\n\t\t\t\t\tLOGIN\r\n\t\t\t\t</button>\r\n\t\t\t</form>\r\n\t\t);\r\n\t}, [handleSubmit]);\r\n\r\n\tconst crownBuild = useMemo(() => <Crown />, []);\r\n\r\n\tconst loginSection = useMemo((): ReactElement => {\r\n\t\treturn (\r\n\t\t\t<div className={[styles.loginSection, styles.initialiseButton].join(' ')}>\r\n\t\t\t\t<div className={[styles.flip, styles.loginButton].join(' ')} onClick={() => {\r\n\t\t\t\t\tsetMode(props.mode === 'reset/password' ? 'reset/password' : 'login');\r\n\t\t\t\t\ttriggerError('');\r\n\t\t\t\t}}>\r\n\t\t\t\t\t<div>LOGIN</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t{!isMobile() ? <FaAngleLeft /> : <FaAngleUp />}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className={['container', styles.foreground, mode === 'register' ? styles.registerForeground : styles.loginForeground].join(' ')}>\r\n\t\t\t\t\t{crownBuild}\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tmode === 'register' ?\r\n\t\t\t\t\t\t\tregisterForm :\r\n\t\t\t\t\t\tmode === 'login' ?\r\n\t\t\t\t\t\t\tloginForm :\r\n\t\t\t\t\t\tmode === 'reminder' ?\r\n\t\t\t\t\t\t\treminderForm :\r\n\t\t\t\t\t\tmode === 'reset' ?\r\n\t\t\t\t\t\t\tresetForm :\r\n\t\t\t\t\t\tmode === 'reset/password' ?\r\n\t\t\t\t\t\t\t<PasswordForm /> :\r\n\t\t\t\t\t\t\tnull\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className={[styles.flip, styles.registerButton].join(' ')} onClick={() => {\r\n\t\t\t\t\tsetMode('register');\r\n\t\t\t\t\ttriggerError('');\r\n\t\t\t\t}}>\r\n\t\t\t\t\t<div>REGISTER</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t{!isMobile() ? <FaAngleRight /> : <FaAngleDown />}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}, [mode, setMode, triggerError, loginForm, registerForm, reminderForm, resetForm, crownBuild, props.mode, PasswordForm]);\r\n\r\n\tif (shouldRedirect) {\r\n\t\tif (shouldRedirect === '/login') {\r\n\t\t\tsetMode('login');\r\n\t\t\tredirectTo('');\r\n\t\t}\r\n\t\treturn <Redirect to={shouldRedirect}/>\r\n\t}\r\n\r\n\treturn (\r\n        <div id='main' className={'animated-' + props.location.state?.direction}>\r\n\t\t\t<div className={[styles.column].join(' ')}>\r\n\t\t\t\t<div className={[styles.frame, 'container'].join(' ')}>\r\n\t\t\t\t\t{loginSection}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className={styles.messageBar}>\r\n\t\t\t\t\t{errorMessage || '\\u200b'}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n\r\n\r\n}","import React, { useEffect, useRef, RefObject, useState } from 'react';\nimport { FaChevronDown } from 'react-icons/fa';\nimport styles from '../css/components.module.css';\n\nexport default function SectionBreak(props: {\n\tname: string\n\texpanded?: boolean\n}) {\n\n\tconst [show, toggle] = useState(props.expanded ?? true);\n\tconst divRef = useRef(null) as RefObject<HTMLDivElement>\n\tconst { current } = divRef;\n\n\tuseEffect(() => {\n\t\tif (!current) return;\n\t\tlet section = current.nextElementSibling as HTMLElement;\n\t\twhile (section && section.className.includes('container')) {\n\t\t\tif (!section) return;\n\t\t\tif (!section.style.overflow) section.style.overflow = 'hidden';\n\t\t\tif (!section.style.transition) section.style.transition = 'all 0.333s ease';\n\t\t\tif (show) {\n\t\t\t\tsection.removeAttribute('style');\n\t\t\t} else {\n\t\t\t\tObject.assign(section.style, {\n\t\t\t\t\tmaxHeight: '0px',\n\t\t\t\t\tpaddingTop: '0px',\n\t\t\t\t\tpaddingBottom: '0px',\n\t\t\t\t\tmarginTop: '0px',\n\t\t\t\t\tmarginBottom: '0px'\n\t\t\t\t});\n\t\t\t}\n\t\t\tsection = section.nextElementSibling as HTMLElement;\n\t\t}\n\t})\n\n\treturn (\t\t\n\t\t<div ref={divRef} className={[styles.divide, show ? '' : styles.collapsed].join(' ')} onClick={() => toggle(!show)}>\n\t\t\t<hr />\n\t\t\t{props.name}\n\t\t\t<FaChevronDown />\n\t\t\t<hr />\n\t\t</div>\n\t)\n}","import { capitalise } from '../utils/prototype';\nimport { TournamentStatus, Player } from '../interfaces';\nimport { resultsServer } from '../utils/requests';\nimport { TieBreaks } from './tiebreaks';\n\nexport function booleanConvert(v: boolean): 'On' | 'Off' | '' {\n\tif (v) return 'On';\n\tif (v === false) return 'Off';\n\treturn '';\n}\n\nexport interface TournamentSettings {\n\n\ttournamentId: string; // Note that the `null assertion` `!` is required in strict mode.\n\tpairingSystem: 'swiss' | 'round-robin';\n\tcompetitors: string\n\ttotalRounds: number | 'Infinity';\n\tperformanceSystem: 'ELO' | 'FIDE';\n\tratingSystem: 'ECF' | 'FIDE' | 'USCF';\n\n\tdisplayPoints: 'match' | 'game';\n\tgamePointTotal: number;\n\tlossReward: number;\n\tdrawReward: number;\n\twinReward: number;\n\tbyeReward: 'win' | 'draw' | 'loss';\n\tbyeGameReward: number;\n\n\tpublic: boolean\n\ttimeControl: string\n\tlocation: string\n\tvanityURL: string\n\tlogoURL: string\n\tprofileURL: string\n\trulesURL: string\n\tstreamURL: string\n\tshowRatings: boolean\n\n\tallowRegistration: 'closed' | 'approve' | 'open';\n\tallowNewPlayers: boolean;\n\tcheckForDuplicatePlayers: boolean\n    allowSelfLinks: number;\n    allowSelfSubmissions: boolean;\n    allowClashes: boolean;\n\troundTimes: boolean;\n\tallowBonuses: boolean;\n\n\tdescription: string;\n\ttieBreaks: string;\n\tprizes: string;\n\n\tsource?: 'lichess' | 'chessCom';\n\tpullResults: number;\n\n\tcreatedAt: string\n\tupdatedAt: string\n\n}\n\nexport interface TournamentSetting {\n\tname?: string\n\tenum?: string[] | number[]\n\tconvert?: (v: any) => string\n\tvalidate?: (v: any) => boolean\n\tvalue?: (status: any, players: Player[], setting: TournamentSettings) => any\n\ttype?: string\n\tlocked?: boolean,\n\tlockWhen?: {\n\t\t[key in keyof TournamentSettings]?: any\n\t},\n\tonInit?: boolean,\n\tlockOnInit?: boolean\n\tshow?: {\n        [key in keyof TournamentSettings]?: any\n\t}\n\thidden?: boolean\n\tallow?: {\n\t\tinfinity?: boolean\n\t\tany?: boolean\n\t\tsubmit?: boolean\n        increment?: boolean\n        clear?: boolean\n\t}\n\tnb?: {\n\t\tmin?: number\n\t\tmax?: number\n\t\tstep?: number\n\t}\n\thighlight?: boolean\n\taction?: string\n\tprimaryKey?: boolean\n\tdefaultValue?: any\n\tlevel?: number\n\tlinked?: keyof TournamentSettings\n}\n\nexport const defaultSettings = {\n\tcore: {\n\t\ttournamentId: {\n\t\t\tname: 'Unique ID',\n\t\t\ttype: 'string',\n\t\t\tlocked: true,\n\t\t\tprimaryKey: true\n\t\t},\n\t\tstatus: {\n\t\t\tname: 'Status',\n\t\t\tenum: ['uninitialised', 'active', 'finished'],\n\t\t\tconvert: capitalise,\n\t\t\tdefaultValue: 'uninitialised',\n\t\t\tvalue: (status: TournamentStatus): string => {\n\t\t\t\tif (!status.round) return 'uninitialised';\n\t\t\t\tif (status.active === false) return 'finished';\n\t\t\t\telse return 'active';\n\t\t\t}\n\t\t},\n\t\tpairingSystem: {\n\t\t\tname: 'Pairing system',\n\t\t\tenum: ['swiss', 'round-robin'],\n\t\t\tconvert: capitalise,\n\t\t\tlockOnInit: true,\n\t\t\tdefaultValue: 'swiss'\n\t\t},\n\t\tcompetitors: {\n\t\t\tname: 'Tournament type',\n\t\t\tenum: ['individual', 'team'],\n\t\t\tconvert: capitalise,\n\t\t\tlockOnInit: true,\n\t\t\tdefaultValue: 'individual'\n\t\t},\n\t\ttotalRounds: {\n\t\t\tname: 'Total rounds',\n\t\t\tconvert: (v: number | 'Infinity') => v === 'Infinity' ? '' : v.toString(),\n\t\t\ttype: 'number',\n\t\t\tdefaultValue: Infinity,\n\t\t\tlockWhen: {\n\t\t\t\tpairingSystem: 'round-robin'\n\t\t\t},\n\t\t\tnb: {\n\t\t\t\tmin: 1,\n\t\t\t\tmax: 100\n\t\t\t},\n\t\t\tallow: {\n\t\t\t\tinfinity: true\n\t\t\t}\n\t\t},\n\t\tratingSystem: {\n\t\t\tname: 'Rating system',\n\t\t\tenum: ['ECF', 'FIDE', 'USCF'],\n\t\t\tlockOnInit: true,\n\t\t\tdefaultValue: 'ECF'\n\t\t},\n\t\tdisplayPoints: {\n\t\t\tname: 'Games per pairing',\n\t\t\tconvert: (v: 'match' | 'game') => v === 'match' ? 'Just One' : 'Multiple',\n\t\t\tenum: ['match', 'game'],\n\t\t\tdefaultValue: 'match'\n\t\t},\n\t\tgamePointTotal: {\n\t\t\tname: 'Number of games per pairing',\n\t\t\ttype: 'number',\n\t\t\tdefaultValue: 1,\n\t\t\tshow: {\n\t\t\t\tdisplayPoints: 'game'\n\t\t\t},\n\t\t\tlockOnInit: true,\n\t\t\tnb: {\n\t\t\t\tstep: 1,\n\t\t\t\tmin: 1\n\t\t\t},\n\t\t\tallow: {\n\t\t\t\tany: true\n\t\t\t},\n\t\t\thighlight: true,\n\t\t\tlinked: 'byeGameReward'\n\t\t},\n\t\tpublic: {\n\t\t\tname: 'Public',\n\t\t\tconvert: booleanConvert,\n\t\t\tlockOnInit: false,\n\t\t\ttype: 'boolean',\n\t\t\tdefaultValue: false,\n\t\t\tlevel: 1\n\t\t},\n\t\ttieBreaks: {\n\t\t\tname: 'Tie Breaks',\n\t\t\tconvert: () => '',\n\t\t\ttype: 'string',\n\t\t\tdefaultValue: null,\n\t\t\tvalidate: (v: string) => {\n\t\t\t\tlet list = v.split(',');\n\t\t\t\tfor (let k of list) {\n\t\t\t\t\tif (!(k in TieBreaks)) throw `Invalid tiebreak '${k}'`;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\thidden: true\n\t\t}\n\t},\n\tpermissions: {        \n\t\tallowNewPlayers: {\n\t\t\tname: 'Mid-way joining?',\n\t\t\tconvert: booleanConvert,\n\t\t\tlockOnInit: false,\n\t\t\ttype: 'boolean',\n\t\t\tdefaultValue: true,\n\t\t\thidden: true\n\t\t},\n\t\tcheckForDuplicatePlayers: {\n\t\t\tname: 'Check for duplicate players?',\n\t\t\tconvert: booleanConvert,\n\t\t\tlockOnInit: false,\n\t\t\ttype: 'boolean',\n\t\t\tdefaultValue: true,\n\t\t\tshow: {\n\t\t\t\tallowNewPlayers: true,\n\t\t\t\tpairingSystem: 'swiss'\n\t\t\t},\n\t\t\thighlight: true\n\t\t},\n\t\tallowClashes: {\n\t\t\tname: 'Forbid certain pairings?',\n\t\t\tconvert: booleanConvert,\n\t\t\tlockOnInit: false,\n\t\t\ttype: 'boolean',\n\t\t\tdefaultValue: true,\n\t\t\tshow: {\n\t\t\t\tpairingSystem: 'swiss'\n\t\t\t}\n\t\t},\n\t\tallowBonuses: {\n\t\t\tname: 'Input score bonuses for players?',\n\t\t\tconvert: booleanConvert,\n\t\t\tlockOnInit: false,\n\t\t\ttype: 'boolean',\n\t\t\tdefaultValue: true\n\t\t}\n\t},\n\tpoints: {\n\t\tlossReward: {\n\t\t\tname: 'Points on loss',\n\t\t\tlockOnInit: true,\n\t\t\ttype: 'number',\n\t\t\tdefaultValue: 0,\n\t\t\tnb: {\n\t\t\t\tstep: 0.1\n\t\t\t}\n\t\t},\n\t\tdrawReward: {\n\t\t\tname: 'Points on draw',\n\t\t\tlockOnInit: true,\n\t\t\ttype: 'number',\n\t\t\tdefaultValue: 0.5,\n\t\t\tnb: {\n\t\t\t\tstep: 0.1\n\t\t\t}\n\t\t},\n\t\twinReward: {\n\t\t\tname: 'Points on win',\n\t\t\tlockOnInit: true,\n\t\t\ttype: 'number',\n\t\t\tdefaultValue: 1,\n\t\t\tnb: {\n\t\t\t\tstep: 0.1\n\t\t\t}\n\t\t},\n\t\tbyeReward: {\n\t\t\tname: 'Bye reward',\n\t\t\tenum: ['win', 'draw', 'loss'],\n\t\t\tlockOnInit: true,\n\t\t\tdefaultValue: 'win'\n\t\t},\n\t\tbyeGameReward: {\n\t\t\tname: 'Bye reward in game points',\n\t\t\ttype: 'number',\n\t\t\tlockOnInit: false,\n\t\t\tdefaultValue: 1,\n\t\t\tshow: {\n\t\t\t\tdisplayPoints: 'game'\n\t\t\t},\n\t\t\tnb: {\n\t\t\t\tmin: 0\n\t\t\t},\n\t\t\thighlight: true\n\t\t},\n\t\tperformanceSystem: {\n\t\t\tname: 'Performance rating',\n\t\t\tenum: ['ELO', 'FIDE'],\n\t\t\tlockOnInit: false,\n\t\t\tdefaultValue: 'ELO'\n\t\t}\n\t},\n\tstats: {\n\t\tnbPlayers: {\n\t\t\tname: 'Number of players',\n\t\t\ttype: 'number',\n\t\t\tdefaultValue: 0,\n\t\t\tvalue: (status: TournamentStatus, players: Player[]): number => players.length,\n\t\t\tconvert: (v: number) => v.toString()\n\t\t},\n\t\tactivePlayers: {\n\t\t\tname: 'Active players',\n\t\t\ttype: 'number',\n\t\t\tdefaultValue: 0,\n\t\t\tvalue: (status: TournamentStatus, players: Player[]): number => players.filter(p => p.active).length,\n\t\t\tconvert: (v: number) => v.toString()\n\t\t},\n\t\tmatchesPlayed: {\n\t\t\tname: 'Matches played',\n\t\t\ttype: 'number',\n\t\t\tdefaultValue: 0,\n\t\t\tvalue: (status: TournamentStatus, players: Player[]): number => players.reduce((acc, curr) => acc += curr.played, 0) / 2,\n\t\t\tconvert: (v: number) => v.toString()\n\t\t},\n\t\tgamesPlayed: {\n\t\t\tname: 'Games played',\n\t\t\ttype: 'number',\n\t\t\tdefaultValue: 0,\n\t\t\tvalue: (status: TournamentStatus, players: Player[]): number => players.reduce((acc, curr) => acc += curr.histories.reduce((acc, curr) => curr ? acc += curr.played : acc, 0), 0) / 2,\n\t\t\tconvert: (v: number) => v.toString()\n\t\t},\n\t\taverageRating: {\n\t\t\tname: 'Average rating',\n\t\t\ttype: 'number',\n\t\t\tdefaultValue: 1200,\n\t\t\tvalue: (status: TournamentStatus, players: Player[]): number => {\n\t\t\t\tlet sum = players.reduce((acc, curr) => acc += curr.rating, 0);\n\t\t\t\treturn Math.round(sum / players.length);\n\t\t\t},\n\t\t\tconvert: (v: number) => v.toString()\n\t\t},\n\t\tcreatedAt: {\n\t\t\tname: 'Created at',\n\t\t\tconvert: (v: string) => new Date(v).toString().slice(0, 24),\n\t\t\tlocked: true\n\t\t},\n\t\tupdatedAt: {\n\t\t\tname: 'Last updated',\n\t\t\tconvert: (v: string) => new Date(v).toString().slice(0, 24),\n\t\t\tlocked: true\n\t\t}\n\t},\n\tpublic: {\n\t\tvanityURL: {\n\t\t\tname: 'Custom ID',\n\t\t\ttype: 'string',\n\t\t\tdefaultValue: '',\n\t\t\taction: 'updateVanityURL',\n\t\t\tlevel: 2\n\t\t},\n\t\turl: {\n\t\t\tname: 'URL',\n\t\t\ttype: 'link',\n\t\t\tdefaultValue: '',\n\t\t\tvalue: (status: TournamentStatus, p: Player[], s: TournamentSettings): string => `${resultsServer}tournament/${s.vanityURL || status.id}`.trim(),\n\t\t\tlevel: 2\n\t\t},\n\t\ttimeControl: {\n\t\t\tname: 'Time control',\n\t\t\ttype: 'string',\n\t\t\tdefaultValue: '',\n\t\t\tlevel: 2\n\t\t},\n\t\tlocation: {\n\t\t\tname: 'Location',\n\t\t\ttype: 'string',\n\t\t\tdefaultValue: '',\n\t\t\tlevel: 2\n\t\t},\n\t\tprofileURL: {\n\t\t\tname: 'Link to website',\n\t\t\ttype: 'string',\n\t\t\tlevel: 2\n\t\t},\n\t\trulesURL: {\n\t\t\tname: 'Link to rules',\n\t\t\ttype: 'string',\n\t\t\tlevel: 2\n\t\t},\n\t\tlogoURL: {\n\t\t\tname: 'Link to profile picture',\n\t\t\ttype: 'string',\n\t\t\tlevel: 2\n\t\t},\n\t\tstreamURL: {\n\t\t\tname: 'Stream link',\n\t\t\ttype: 'string',\n\t\t\tlevel: 2\n\t\t}\n\t},\n\tpublic_permissions: {\n\t\tshowRatings: {\n\t\t\tname: 'Show ratings',\n\t\t\tconvert: booleanConvert,\n\t\t\ttype: 'boolean',\n\t\t\tdefaultValue: true,\n\t\t\tlevel: 1\n\t\t},\n\t\troundTimes: {\n\t\t\tname: 'Show round times',\n\t\t\tconvert: booleanConvert,\n\t\t\ttype: 'boolean',\n\t\t\tdefaultValue: true,\n\t\t\tlocked: false,\n\t\t\tlevel: 1\n\t\t}\n\t},\n\tpublic_hidden: {\n\t\tdescription: {\n\t\t\tname: 'Description',\n\t\t\ttype: 'string',\n\t\t\tlevel: 1\n\t\t},\n\t\tprizes: {\n\t\t\tname: 'Prizes',\n\t\t\ttype: 'string',\n\t\t\tlevel: 1\n\t\t}\n\t},\n\tautomation: {\n\t\tsource: {\n\t\t\tname: 'Source',\n\t\t\tenum: ['', 'lichess', 'chessCom'],\n\t\t\tconvert: (v: string): string => {\n\t\t\t\tif (v === 'lichess') return 'Lichess.org';\n\t\t\t\tif (v === 'chessCom') return 'Chess.com';\n\t\t\t\treturn 'None';\n\t\t\t},\n\t\t\tdefaultValue: '',\n\t\t\tlevel: 1\n\t\t},\n\t\tpullResults: {\n\t\t\tname: 'Pull results',\n\t\t\tshow: {\n\t\t\t\tsource: ['lichess', 'chessCom']\n\t\t\t},\n\t\t\tenum: [0, 1, 2],\n\t\t\ttype: 'number',\n\t\t\thighlight: true,\n\t\t\tlevel: 1,\n\t\t\tconvert: (v: number) => {\n\t\t\t\tif (v === 0) return 'Off';\n\t\t\t\tif (v === 1) return 'Ask me first';\n\t\t\t\treturn 'Smart Pull and save all';\n\t\t\t},\n\t\t\tdefaultValue: 1\n\t\t},\n\t\tallowSelfLinks: {\n\t\t\tname: 'Let users submit links?',\n\t\t\tlockOnInit: false,\n\t\t\tenum: [0, 1, 2, 3],\n\t\t\ttype: 'number',\n\t\t\tdefaultValue: 1,\n\t\t\thighlight: true,\n\t\t\tlevel: 1,\n\t\t\tconvert: (v: number) => {\n\t\t\t\tif (v === 0) return 'Off';\n\t\t\t\tif (v === 1) return 'Ask me first';\n\t\t\t\tif (v === 2) return 'Save if both players confirm';\n\t\t\t\treturn 'Smart if either player confirms';\n\t\t\t}\n\t\t},\n\t\tallowSelfSubmissions: {\n\t\t\tname: 'Let users submit results?',\n\t\t\tconvert: booleanConvert,\n\t\t\tlocked: true,\n\t\t\tlockOnInit: false,\n\t\t\ttype: 'boolean',\n\t\t\tdefaultValue: true\n\t\t},\n\t\tallowRegistration: {\n\t\t\tname: 'Let users register online?',\n\t\t\tconvert: capitalise,\n\t\t\tenum: ['closed', 'approve', 'open'],\n\t\t\tonInit: false,\n\t\t\tdefaultValue: 'closed'\n\t\t}\n\t}\n} as {\n\t[key: string]: {\n\t\t[key: string]: TournamentSetting\n\t}\n};","import React, { ReactElement, useContext, useCallback } from 'react';\nimport { Link } from 'react-router-dom';\nimport { EnhancedPlayer, EnhancedHistory, SmallTeam, EnhancedMatch } from '../interfaces';\nimport { Player, Match } from '../models';\nimport bcrypt from 'bcryptjs';\n\nimport { columns } from '../resources/columns';\nimport { FaEllipsisH, FaEye, FaFlag, FaChessPawn } from 'react-icons/fa';\nimport styles from '../css/profile.module.css';\nimport userStyles from './css/user.module.css';\nimport { GET, POST, saltRounds } from '../utils/requests';\nimport { watch } from '../assets/icons';\nimport { flags } from '../config.json';\nimport { FaChess, FaLink, FaBell, FaPlusCircle } from 'react-icons/fa';\nimport { LoginContext } from '../App';\nimport { AlertContext } from '../Contexts';\nimport { defaultSettings } from '../resources/settings';\nimport * as regexes from '../utils/regexes';\n\nexport async function fetchNames (data: [string, string][]) {\n\tlet sorted = data.reduce((acc, curr) => {\n\t\tif (!acc[curr[1]]) acc[curr[1]] = [] as string[];\n\t\tacc[curr[1]].push(curr[0]);\n\t\treturn acc;\n\t}, {} as {[key: string]: string[]});\n\tlet promises: Promise<Player[]>[] = [];\n\tfor (let [id, ids] of Object.entries(sorted)) {\n\t\tpromises.push(GET({\n\t\t\turl: ['tournament', id, 'fetchPlayers'].join('/'),\n\t\t\tparams: { ids: ids.join(',') }\n\t\t}))\n\t}\n\tlet names = {} as {[key: string]: string}\n\tfor (let list of await Promise.all(promises)) {\n\t\tfor (let p of list) {\n\t\t\tnames[p.id] = p.firstName;\t//TODO ON BACKEND\n\t\t}\n\t}\n\treturn names;\n}\n\nexport function renderTournament(p: EnhancedPlayer, playerNames: {[key: string]: string}): [JSX.Element, [string, string][]] {\t\n\n\tconst player = new Player(p, p.tournament.round, p.tournament.setting);\n\tconst shouldFetch = [] as [string, string][];\n\tlet totalRounds = typeof p.tournament.setting.totalRounds as string | number !== 'string' ?\n\t\tp.tournament.setting.totalRounds !== Infinity ?\n\t\t\tp.tournament.setting.totalRounds :\n\t\tp.histories.length + 1 :\n\tp.histories.length + 1;\n\tlet histories = p.histories.slice(0);\n\tfor (let i = 0; i <= totalRounds; i++) if (!histories[i]) histories[i] = null as any;\n\n\tlet [last, next] = [null, null] as [EnhancedHistory | null, EnhancedHistory | null];\n\tfor (let i = 1; i < histories.length; i++) {\n\t\tif (!histories[i]) {\n\t\t\tnext = null;\n\t\t\tbreak;\n\t\t}\n\t\tlet h = Object.assign(histories[i], {\n\t\t\tround: i,\n\t\t\tw: histories[i].colour === 'W' ? p.id : histories[i].id,\n\t\t\tb: histories[i].colour === 'W' ? histories[i].id : p.id\n\t\t});\n\t\tif (h.match === null) {\n\t\t\tnext = h;\n\t\t\tbreak;\n\t\t}\n\t\tlast = h;\n\t}\n\t\n\treturn [\n\t\t<section key={['section', p.id].join('.')} className={['container', styles.background].join(' ')}>\n\t\t\t<div className={styles.stage}>\n\t\t\t\t<Link to={`/${p.tournament.setting.vanityURL || p.tournament.id}`} className={[styles.name, styles.box].join(' ')}>{p.tournament.name}</Link>\n\t\t\t\t<div className={[styles.scores, styles.box].join(' ')}>\n\t\t\t\t\t{Object.entries(columns.post).map(([k, meta], i) => {\n\t\t\t\t\t\tif (meta.show && !meta.show(player, i, p.tournament.setting, 'results')) return null;\n\t\t\t\t\t\treturn <div className={styles.row} key={['row', i].join('.')}>\n\t\t\t\t\t\t\t<div className={styles.key}>{meta.brief || meta.mobile}</div>\n\t\t\t\t\t\t\t<div className={styles.value}>\n\t\t\t\t\t\t\t\t{meta.convert ?\n\t\t\t\t\t\t\t\t\tmeta.convert(player[k as keyof Player], player, p.tournament.setting, 'results') :\n\t\t\t\t\t\t\t\t\tplayer[k as keyof Player]?.toString()}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>;\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t\t<Link to={`/${p.tournament.setting.vanityURL || p.tournament.id}`} className={[styles.currRound, styles.box, 'header-button'].join(' ')}>\n\t\t\t\t\tRound: {p.tournament.round}\n\t\t\t\t</Link>\n\t\t\t\t<div className={[styles.nextRound, styles.box, 'header-button'].join(' ')}>\n\t\t\t\t\tTime: {p.tournament.setting.timeControl}\n\t\t\t\t</div>\n\t\t\t\t<div className={[styles.history, styles.box].join(' ')} style={p.tournament.setting.totalRounds < 10 ? {gridTemplateRows: `1.5em repeat(${p.tournament.setting.totalRounds}, auto)`} : {}}>\n\t\t\t\t\t<div className={styles.subtitle}>\n\t\t\t\t\t\tResults\n\t\t\t\t\t</div>\n\t\t\t\t\t{histories.map((h, i) => {\n\t\t\t\t\t\tif (!i) return null;\n\t\t\t\t\t\tif (!h) h = {} as any;\n\t\t\t\t\t\tlet { id, colour } = h;\n\t\t\t\t\t\tlet game = h.game as number | null;\n\t\t\t\t\t\tlet match = h.match as number | null;\n\t\t\t\t\t\tlet showGame = h.game !== null && p.tournament.setting.displayPoints === 'game';\n\t\t\t\t\t\tlet w = colour === 'W' ? p.id : h.id;\n\t\t\t\t\t\tlet b = colour === 'W' ? h.id : p.id;\n\t\t\t\t\t\tif (id && id.toLowerCase() !== 'bye' && !(id in playerNames)) shouldFetch.push([id, p.tournament.id]);\n\t\t\t\t\t\tlet data = [\n\t\t\t\t\t\t\ti,\n\t\t\t\t\t\t\tplayerNames[id] || (id === 'bye' ? 'BYE' : id),\n\t\t\t\t\t\t\tcolour || '\\u200b',\n\t\t\t\t\t\t\tgame !== null ? game : <FaEllipsisH />,\n\t\t\t\t\t\t\tmatch !== null ? match : <FaEllipsisH />\n\t\t\t\t\t\t]\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div className={[styles.resultsRow, showGame ? '' : styles.small].join(' ')} key={['row', 'history', i].join('.')}>\n\t\t\t\t\t\t\t\t{data.map((entry, j) => {\n\t\t\t\t\t\t\t\t\tlet className = j === 1 ? styles.playerName : styles.fieldBox;\n\t\t\t\t\t\t\t\t\tlet to = j === 1 ?`/${p.tournament.setting.competitors === 'team' ? 'team' : 'individual'}/${id}`  : `/${p.tournament.id}/pairings/${i}#${w}.${b}`;\n\t\t\t\t\t\t\t\t\tif (j === 3 && !showGame) return null;\n\t\t\t\t\t\t\t\t\tif (!id) {\n\t\t\t\t\t\t\t\t\t\treturn <div className={className} key={['entry', j].join('.')}>{entry}</div>\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\treturn <Link to={to} className={className} key={['entry', j].join('.')}>{entry}</Link>\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t\t{p.active && p.tournament.active ?\n\t\t\t\t\t<div className={styles.action}>\n\t\t\t\t\t\t{last ?\n\t\t\t\t\t\t\t<Link className='header-button' to={`/${p.tournament.id}/pairings/${last.round}#${last.w}.${last.b}`}>\n\t\t\t\t\t\t\t\t<img src={watch} alt='watch' />Analyse last game\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t: null}\n\t\t\t\t\t\t{next ?\n\t\t\t\t\t\t\t<Link className='header-button' to={`/${p.tournament.id}/pairings/${next.round}#${next.w}.${next.b}`}>\n\t\t\t\t\t\t\t\t<FaEye />View next game\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t: null}\n\t\t\t\t\t</div> :\n\t\t\t\tnull}\n\t\t\t</div>\n\t\t</section>,\n\t\tshouldFetch\n\t];\n\n}\n\nexport function renderTeam(t: SmallTeam): ReactElement {\n\t\n\treturn (\n\t\t<section className={['container', styles.background].join(' ')}>\n\t\t\t<div className={styles.teamStage}>\n\t\t\t\t<Link to={`/team/${t.id}`} className={[styles.name, styles.box].join(' ')}>\n\t\t\t\t\t{t.name}\n\t\t\t\t</Link>{/*\n\t\t\t\t<div className={[styles.scores, styles.box].join(' ')}>\n\t\t\t\t\t{Object.entries(columns.post).map(([k, meta], i) => {\n\t\t\t\t\t\treturn <div className={styles.row} key={['row', i].join('.')}>\n\t\t\t\t\t\t\t<div className={styles.key}>{meta.brief || meta.mobile}</div>\n\t\t\t\t\t\t\t<div className={styles.value}>\n\t\t\t\t\t\t\t\t{'\\u200b'}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>;\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t\t<div className={[styles.currRound, styles.box, 'header-button'].join(' ')}>\n\t\t\t\t\tRound\n\t\t\t\t</div>\n\t\t\t\t<div className={[styles.nextRound, styles.box, 'header-button'].join(' ')}>\n\t\t\t\t\t{'\\u200b'}\n\t\t\t\t</div>\n\t\t\t\t<div className={[styles.history, styles.box].join(' ')}>\n\t\t\t\t\t<div className={styles.subtitle}>\n\t\t\t\t\t\tResults\n\t\t\t\t\t</div>\n\t\t\t\t\t{[].map((h, i) => {\n\t\t\t\t\t\tlet entry = '\\u200b';\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div className={[styles.resultsRow].join(' ')} key={['row', 'history', i].join('.')}>\n\t\t\t\t\t\t\t\t<div className={styles.fieldBox}>{entry}</div>\n\t\t\t\t\t\t\t\t<div className={styles.fieldBox}>{entry}</div>\n\t\t\t\t\t\t\t\t<div className={styles.fieldBox}>{entry}</div>\n\t\t\t\t\t\t\t\t<div className={styles.fieldBox}>{entry}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</div>*/}\n\t\t\t\t<div className={styles.action}>\n\t\t\t\t\t<div className='header-button'>\n\t\t\t\t\t\t<FaFlag style={{color: 'indianred' }} />Founded: {new Date(t.createdAt).toString().slice(4, 15)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className='header-button'>\n\t\t\t\t\t\t<FaChessPawn />Last online: {new Date(t.updatedAt).toString().slice(4, 15)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</section>\n\t);\n\n}\n\nexport function RenderMatch({u, isAuthed, update}: {u: EnhancedMatch, isAuthed: number, update: () => void}) {\n\tconst isLoggedIn = useContext(LoginContext);\n\tconst setAlert = useContext(AlertContext);\n\n\tlet {prop, opp, colour, round, id, result} = u;\n\tlet swap = colour === 'B' && prop.tournament.setting.gamePointTotal === 1;\n\tlet w = swap ? opp : prop;\n\tlet b = swap ? prop : opp;\n\tlet type = prop.tournament.setting.competitors === 'individual' ? 'player' : 'team';\n\tlet link = Object.values(result[2]).find(l => l);\n\tlet match = new Match({ w: w as any, b: b as any, id, tournamentId: prop.tournamentId, round, scores: [undefined, undefined], teams: [], link, ...result[3]}, round);\n\tconst source = prop.tournament.setting.source ? (defaultSettings.automation.source.convert as ((v: string) => string))(prop.tournament.setting.source) : '';\n\t\n\tconst handleAdd = useCallback(() => {\n\t\tsetAlert({\n\t\t\ttitle: 'Add game link',\n\t\t\tmessage: `Input your ${type} game link${source ? ' from ' + source : ''}:`, \n\t\t\ticon: prop.tournament.setting.source === 'chessCom' ? 'chess.com' : undefined,\n\t\t\ttype: 'prompt',\n\t\t\tresolve: async (link: string) => {\n\t\t\t\tlet W = colour === 'B' ? opp : prop;\n\t\t\t\tlet B = colour === 'B' ? prop : opp;\n\t\t\t\tlet key = await bcrypt.hash([W.id, B.id, match.tournamentId, round].join('.'), saltRounds);\n\t\t\t\tPOST({\n\t\t\t\t\turl: '/submit/gameLink',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tidW: W.id,\n\t\t\t\t\t\tidB: B.id,\n\t\t\t\t\t\ttournamentId: match.tournamentId,\n\t\t\t\t\t\tround,\n\t\t\t\t\t\tkey,\n\t\t\t\t\t\tlink\n\t\t\t\t\t}\n\t\t\t\t}).then(update)\n\t\t\t},\n\t\t\tprompt: {\n\t\t\t\tvalidate: (v: string) => prop.tournament.setting.source === 'chessCom' ? \n\t\t\t\t\ttype === 'team' ?\n\t\t\t\t\t\tregexes.chessCom.test(v) :\n\t\t\t\t\t\ttrue :\n\t\t\t\t\ttrue,\n\t\t\t\terrorMessage: type === 'team' ? 'Link must be a valid from ' + source : ''\n\t\t\t}\n\t\t})\n\t}, [setAlert, prop.tournament.setting, type, match, round, update]);\n\t\n\treturn <section className={['container',userStyles.upcomingBattle].join(' ')}>\n\t\t<div className={[userStyles.stage, swap ? userStyles.reversed : ' '].join(' ')}>\n\t\t\t<Link to={`/${type}/${w.id}`} className={userStyles.name} style={{gridArea: 'wName'}}>\n\t\t\t\t{w.name}\n\t\t\t</Link>\n\t\t\t{w.nationality ? <div className={userStyles.flag} style={{gridArea: 'wFlag'}}>\n\t\t\t\t<img src={flags.replace('|', w.nationality)} alt={w.nationality}/>\t\t\t\t\t\t\n\t\t\t</div> : null}\n\t\t\t<div className={userStyles.vs}>\n\t\t\t\tVS\n\t\t\t</div>\n\t\t\t{b.nationality ? <div className={userStyles.flag} style={{gridArea: 'bFlag'}}>\n\t\t\t\t<img src={flags.replace('|', b.nationality)} alt={b.nationality}/>\t\t\t\t\t\t\n\t\t\t</div> : null}\n\t\t\t<Link to={`/${type}/${b.id}`} className={userStyles.name} style={{gridArea: 'bName'}}>\n\t\t\t\t{b.name}\n\t\t\t</Link>\n\t\t\t<div className={userStyles.infoBox}>\n\t\t\t\t<div>Starting:</div>\t\t\t\t\n\t\t\t\t{match.startTime ? new Date(match.startTime).toString().slice(0, 10) + ' ' + new Date(match.startTime).toString().slice(16, 21):\n\t\t\t\t\t(isAuthed && false ? //TODO\n\t\t\t\t\t\t<div className={userStyles.clickButton}>Add starting time</div> :\n\t\t\t\t\t\t<div className={[userStyles.null, userStyles.clickButton].join(' ')}>No starting time added</div>\n\t\t\t\t\t)\n\t\t\t\t}\t\t\t\t\n\t\t\t\t<div>Round:</div><div>{round}</div>\n\t\t\t</div>\n\t\t\t<div className={userStyles.buttons}>\n\t\t\t\t{match.link ?\n\t\t\t\t\t<>\n\t\t\t\t\t\t<a href={match.link as string} rel='noopener noreferrer' target='_blank' className={['header-button', 'link', userStyles.join].join(' ')}>\n\t\t\t\t\t\t\t<FaLink />\n\t\t\t\t\t\t\tJoin game on {source}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t{isAuthed >= 2 ?\n\t\t\t\t\t\t\t<div className={['header-button', 'link', userStyles.remove].join(' ')}>\n\t\t\t\t\t\t\t\tRemove link\n\t\t\t\t\t\t\t</div> :\n\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t}\n\t\t\t\t\t</> :\n\t\t\t\t\tisAuthed || true ?\n\t\t\t\t\t\t<div className={['header-button', 'link', userStyles.join].join(' ')} onClick={handleAdd}>\n\t\t\t\t\t\t\t<FaPlusCircle />\n\t\t\t\t\t\t\tAdd game link\n\t\t\t\t\t\t</div> :\n\t\t\t\t\t\t<div className={['header-button', userStyles.join, userStyles.null].join(' ')}>\n\t\t\t\t\t\t\tNo game link added\n\t\t\t\t\t\t</div> \n\t\t\t\t}\t\t\t\t\t\t\n\t\t\t\t<Link to={['', prop.tournament.setting.vanityURL || prop.tournamentId, 'pairings', round].join('/') + '#' + id} className={['header-button', 'link'].join(' ')}>\n\t\t\t\t\t<FaChess />{prop.tournament.name}\n\t\t\t\t</Link>\n\t\t\t\t<div className={['header-button', 'link', userStyles.null].join(' ')}>\n\t\t\t\t\t<FaBell />Set reminder\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</section>\n}","import React, { useState, useCallback, useEffect, useMemo, useReducer } from 'react';\nimport { StaticContext } from 'react-router';\nimport { Link, RouteComponentProps } from 'react-router-dom';\nimport { GET } from '../utils/requests';\nimport { TournamentStatus, TournamentSettings, ProfileData, Team, EnhancedPlayer } from '../interfaces';\nimport SectionBreak from '../components/SectionBreak';\nimport styles from './css/tournaments.module.css';\nimport { FaAngleLeft, FaAngleRight } from 'react-icons/fa';\nimport { renderTournament, fetchNames } from './hooks';\n\nexport default function Tournaments(props: RouteComponentProps<any, StaticContext, any> & {\n\tdirection: string\n\tuser: ProfileData\n\tprofile: ProfileData & Team\n\tisAuthed: boolean\n\ttype: 'player' | 'team'\n}) {\n\n\tconst [managed, setManaged] = useState([] as (TournamentStatus & { setting: TournamentSettings })[]);\n\tconst updateManaged = useCallback(() => GET({ url: '/profile/tournaments' })\n\t\t.then(setManaged), [setManaged]);\n\tuseEffect(() => {\n\t\tif (!props.isAuthed || props.type !== 'player') return;\n\t\tupdateManaged();\n\t}, [updateManaged, props.isAuthed, props.type]);\n\n\tconst [active, inactive] = useMemo(() => {\n\t\tlet arr = [[], []] as [EnhancedPlayer[], EnhancedPlayer[]];\n\t\tif (!props.profile) return arr;\n\t\tfor (let p of props.profile.tournaments) {\n\t\t\tif (p.active && p.tournament.active) arr[0].push(p);\n\t\t\telse arr[1].push(p);\n\t\t}\n\t\treturn arr;\n\t}, [props.profile]);\n\tconst [playerNames, setPlayerNames] = useState({});\n\tconst [hasFetched, setFetch] = useReducer((state: number) => state += 1, 0);\n\tconst activeTournaments = useMemo(() => active.map((v) => {\n\t\tlet [elem, shouldFetch] = renderTournament(v,playerNames);\n\t\tif (shouldFetch.length && hasFetched < 5) fetchNames(shouldFetch).then(setPlayerNames).then(setFetch);\n\t\treturn elem;\n\t\t/* eslint-disable-next-line react-hooks/exhaustive-deps */\n\t}), [active, playerNames, setPlayerNames, setFetch]);\n\tconst inactiveTournaments = useMemo(() => inactive.map((v) => {\n\t\tlet [elem, shouldFetch] = renderTournament(v, playerNames);\n\t\tif (shouldFetch.length && hasFetched < 5) fetchNames(shouldFetch).then(setPlayerNames).then(setFetch);\n\t\treturn elem;\n\t\t/* eslint-disable-next-line react-hooks/exhaustive-deps */\n\t}), [inactive, playerNames, setPlayerNames, setFetch]);\n\t\n\treturn (<>\n\t\t{!managed.length ? null : <section className={'animated-' + props.direction} key='standings.1'>\n\t\t\t<SectionBreak name='MANAGED TOURNAMENTS'/>\n\t\t\t<div className={['container'].join(' ')}>\n\t\t\t\t<table className={[styles.tableAnnounce].join(' ')}>\n\t\t\t\t\t<thead>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<th style={{width: '20px' }}>Manage</th>\n\t\t\t\t\t\t\t<th>Name</th>\n\t\t\t\t\t\t\t<th>Started</th>\n\t\t\t\t\t\t\t<th>Round</th>\n\t\t\t\t\t\t\t<th>View</th>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</thead>\n\t\t\t\t\t<tbody>\n\t\t\t\t\t\t{managed.sort((a, b) => new Date(b.updatedAt).valueOf() - new Date(a.updatedAt).valueOf()).map((tourn, i) => {\n\t\t\t\t\t\t\tlet dateStarted = new Date(tourn.createdAt).toString();\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<tr key={[tourn.id, i].join('.')} className={styles.rowLink}>\n\t\t\t\t\t\t\t\t\t<td><a className={styles.tournamentLink} href='https://beta.scorchapp.co.uk'>\n\t\t\t\t\t\t\t\t\t\t<FaAngleLeft />\n\t\t\t\t\t\t\t\t\t</a></td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t{tourn.name || tourn.id}\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t{dateStarted.slice(0, 11)}\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t{tourn.round}\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t{tourn.setting && tourn.setting.public ?\n\t\t\t\t\t\t\t\t\t\t<Link className={styles.tournamentLink} to={{pathname: '/' + tourn.id, state: {from: props.location.pathname}}}>\n\t\t\t\t\t\t\t\t\t\t\t<FaAngleRight />\n\t\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t\t\t: null}\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\t\t\t\t\n\t\t\t\t\t</tbody>\n\t\t\t\t</table>\n\t\t\t</div>\n\t\t</section>}\n\t\t<SectionBreak name='ACTIVE TOURNAMENTS' />\n\t\t{!active.length ? null : activeTournaments}\n\t\t<SectionBreak name='INACTIVE TOURNAMENTS' />\n\t\t{!inactive.length ? null : inactiveTournaments}\n\t\t<section />\n\t</>)\n\n}","import React, { useEffect, useState, useCallback, useContext, useMemo } from 'react';\nimport { getChessComProfile, getChessComTeam } from '../../chess/ChessCom';\nimport { POST, GET } from '../../utils/requests';\nimport { AlertContext } from '../../Contexts';\nimport { ProfileData } from '../../interfaces';\nimport contactFields from '../../resources/contact';\nimport { TeamData } from 'chess-web-api';\n\nexport function useLink (props: {\n\tupdateProfile: () => void\n}) {\n\n\tconst setAlert = useContext(AlertContext);\n\n\tfunction href() {\n\t\tsetAlert({\n\t\t\ttitle: 'Link Chess.com account',\n\t\t\tmessage: 'Enter Chess.com account to link:',\n\t\t\ttype: 'prompt',\n\t\t\ticon: 'chess.com',\n\t\t\tresolve: handleHref\n\t\t});\n\t}\n\n\tasync function handleHref(username: string) {\n\t\tif (!username) return;\n\t\tlet profile = await getChessComProfile(username.trim());\n\t\tif (!profile) return console.error('Invalid username to link');\n\t\tPOST({\n\t\t\turl: '/profile/chessCom/link',\n\t\t\tdata: {\n\t\t\t\tusername,\n\t\t\t\tnationality: profile.country?.split('/').pop()\n\t\t\t}\n\t\t})\n\t\t\t.then(props.updateProfile);\n\t}\n\n\treturn { href, setWindow: () => {} }\n\n}\nconst def = {\n\t'@id': '',\n\tname: ''\n};\nexport function useClub(link: string): Partial<TeamData> | TeamData {\n\n\tconst [fetched, setFetched] = useState(null as null | TeamData);\n\tuseEffect(() => {\n\t\tif (!link) return;\n\t\tlet id = link.split('/').pop() as string;\n\t\tgetChessComTeam(id).then(setFetched);\n\t}, [link]);\n\tif (fetched) return fetched;\n\treturn def;\n}\n\nexport function useVerify (props: {\n\tprofile: ProfileData\n\tupdateProfile: () => void\n}) {\n\n\tconst setAlert = useContext(AlertContext);\n\tconst [chessComToken, setChessComToken] = useState('');\n\tconst getChessComToken = useCallback(() => GET({ url: '/profile/chessCom/token' })\n\t\t.then(setChessComToken), [setChessComToken]);\n\tconst { username } = props.profile.chessCom || {};\n\n\tuseEffect(() => {\n\t\tif (!username) return;\n\t\tif (chessComToken) return;\n\t\tgetChessComToken();\n\t}, [chessComToken, getChessComToken, username]);\n\n\treturn async function verify() {\n\t\tif (props.profile.chessCom?.verified) return;\n\t\tawait POST({ url: '/profile/chessCom/verify' })\n\t\t\t.then(props.updateProfile)\n\t\t\t.catch(() => {})\n\t\tsetAlert({\n\t\t\ttitle: 'Verify your chess.com account',\n\t\t\ticon: <img src={contactFields.chessCom.icon[1] as string} alt='chessCom' />,\n\t\t\tlink: (contactFields.chessCom.idLink as string).replace('|', props.profile.chessCom?.username || ''),\n\t\t\tmessage: <>\n\t\t\t\t<p>Head to your chess.com profile and click 'Enter a status here'.\n\t\t\t\tCopy and paste the following code into your status. Don't worry! You can change it back afterwards!</p>\n\t\t\t\t<span className='mono'>SCORCH_TOKEN={chessComToken}</span>\n\t\t\t\t<p>Click <button onClick={() => POST({ url: '/profile/chessCom/verify' }).then(() => setAlert({ title: '', message: '' })).then(props.updateProfile)}>here</button> when done.</p>\n\t\t\t</>\n\t\t});\n\t}\n\n}","import React, { useState, useCallback, useContext, useMemo, useEffect } from 'react';\nimport { StaticContext } from 'react-router';\nimport { Link, Route, Redirect, RouteComponentProps } from 'react-router-dom';\n\nimport styles from './css/user.module.css';\nimport contactFields, { ContactMeta } from '../resources/contact';\nimport { UserSwitcher } from '../components/Switcher';\nimport { ProfileData, Team, ContactEntry } from '../interfaces';\nimport { FaAngleRight, FaCheckCircle, FaChess, FaUserCircle, FaCogs, FaUsers, FaBan } from 'react-icons/fa';\nimport { isDev, POST } from '../utils/requests';\nimport { flags } from '../config.json';\nimport countries from '../assets/countries.json';\nimport { useClub } from './callbacks/ChessCom';\nimport { ChessTeam, TeamData } from 'chess-web-api';\nimport { capitalise } from '../utils/prototype';\nimport { LoginContext } from '../App';\nimport { AlertContext } from '../Contexts';\nimport { GiCrossedSwords } from 'react-icons/gi';\n\nexport default function Info(props: RouteComponentProps<any, StaticContext, any> & {\n\tid: string\n\tuser: ProfileData\n\tprofile: Team & ProfileData\n\tupdateProfile: () => void\n\tendSession?: () => Promise<void>\n\tisAuthed: boolean | number\n\ttype?: 'user' | 'team' | 'player'\n}) {\n\n\tconst notes = useMemo(() => {\n\t\treturn Object.entries(props.profile?.meta || {}).map(([k, v]) => {\n\t\t\tif (!v) return null;\n\t\t\tk = k.trim();\n\t\t\tif (k.endsWith('?')) k = k.slice(0, -1);\n\t\t\tif (typeof v === 'boolean') return k;\n\t\t\tk += ': ';\n\t\t\treturn k + v.toString();\n\t\t}).filter(v => v);\n\t}, [props.profile]);\n\tconst Notes = useMemo(() => {\n\t\treturn notes.map((line, i) => !line ? null : (\n\t\t\t<div className={styles.notes}>\n\t\t\t\t<div key={['line', i].join('.')}>{line}</div>\n\t\t\t</div>\n\t\t));\t\n\t}, [notes]);\n\n\tconst [shouldFetch, fetchClub] = useState('');\n\tconst chessComClub = useClub(shouldFetch) as TeamData;\n\tconst getName = useCallback((meta: ContactMeta, entry: ContactEntry) => {\n\t\tif (entry.name) return entry.name;\n\t\tif (entry.username) return entry.username;\n\t\tif (entry.id) return entry.id;\n\t\tif (meta.id !== 'chessCom') return capitalise(meta.id as string);\n\t\tif (chessComClub.name) return chessComClub.name;\n\t\tif (entry.link && !shouldFetch) fetchClub(entry.link);\n\t\treturn capitalise(meta.id);\n\t}, [fetchClub, chessComClub.name, shouldFetch]);\n\n\tconst isLoggedIn = useContext(LoginContext);\n\tconst setAlert = useContext(AlertContext);\n\n\tconst fields = useMemo(() => {\n\t\treturn Object.entries(contactFields).reverse().map(([k, meta], i) => {\n\t\t\tmeta = Object.assign(contactFields[k], { id: k }) as ContactMeta;\n\t\t\tif (!meta) return null;\n\t\t\tlet entry =  props.profile[k as keyof typeof props.profile] as ContactEntry | undefined;\n\t\t\tif (k === 'email') entry = props.profile.email ? Object.assign(props.profile.emailMeta || {}, {id: props.profile.email}) as ContactEntry : undefined;\n\t\t\tif (!entry || typeof entry !== 'object' || (props.type === 'user' && !entry.verified)) return null;\n\t\t\treturn [meta, entry];\n\t\t}).filter(v => v) as [ContactMeta, ContactEntry][];\n\t}, [props])\n\n\tconst createTrigger = useCallback(() => {\n\t\tsetAlert({ title: '', message: '' });\n\t\tPOST({ url: ['team', props.id, 'create'].join('/') })\n\t\t\t.then(props.updateProfile)\n\t}, [props.id, props.updateProfile, setAlert])\n\tconst handleCreate = useCallback(async () => {\n\t\tlet someAuth = false;\n\t\tsetAlert({\n\t\t\ttitle: 'Claim team',\n\t\t\tmessage: <>\n\t\t\t\tTeam <b>{props.profile.name}</b> has the following available authentication methods:\n\t\t\t\t<div className={styles.auth}>\n\t\t\t\t\t{fields.map(([meta, entry], i) => {\n\t\t\t\t\t\tlet userF = props.user[meta.id === 'email' ? 'emailMeta' : meta.id as keyof ProfileData] as ContactEntry;\n\t\t\t\t\t\tlet name = getName(meta, entry);\n\t\t\t\t\t\tlet canAuth: boolean | null | undefined = (() => {\n\t\t\t\t\t\t\tif (!userF) return null;\n\t\t\t\t\t\t\tif (entry.id && entry.id === userF.id) return true;\n\t\t\t\t\t\t\tif (entry.username && entry.username === userF.username) return true;\n\t\t\t\t\t\t\tif (meta.id === 'chessCom' && chessComClub && chessComClub.admin) {\n\t\t\t\t\t\t\t\tif (chessComClub.admin.some(a => a.split('/').pop() === userF.username?.toLowerCase())) return true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t})();\n\t\t\t\t\t\tif (canAuth !== false) someAuth = true;\n\t\t\t\t\t\tif (canAuth === null) return <>\n\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\tto={'/me/accounts'}\n\t\t\t\t\t\t\t\tid={meta.id}\n\t\t\t\t\t\t\t\tclassName={['button', 'link', styles.account].join(' ')}\n\t\t\t\t\t\t\t\tonClick={() => setAlert({ title: '', message: '' })}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{typeof meta.icon[1] === 'string' ? <img src={meta.icon[1]} alt={meta.id} className={styles.icon} /> : React.cloneElement(meta.icon[1], { className: styles.icon })}\n\t\t\t\t\t\t\t\tVerify {meta.name || capitalise(meta.id as string)} account\n\t\t\t\t\t\t\t\t<FaAngleRight />\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t<div />\n\t\t\t\t\t\t</>\n\t\t\t\t\t\treturn <>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tid={meta.id}\n\t\t\t\t\t\t\t\tclassName={['button', 'link', styles.account, canAuth === false ? styles.null : ''].join(' ')}\n\t\t\t\t\t\t\t\tonClick={canAuth ? createTrigger : () => {}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{typeof meta.icon[1] === 'string' ? <img src={meta.icon[1]} alt={meta.id} className={styles.icon} /> : React.cloneElement(meta.icon[1], { className: styles.icon })}\n\t\t\t\t\t\t\t\t{canAuth ?\n\t\t\t\t\t\t\t\t\t<>Claim via {meta.name || capitalise(meta.id as string)}</>\n\t\t\t\t\t\t\t\t\t: name\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t{!canAuth ? <FaBan /> : <FaAngleRight />}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className={styles.authMessage}>\n\t\t\t\t\t\t\t\t{canAuth === false ? <small>{meta.authMessage}</small> : null}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t\t{!someAuth ?\n\t\t\t\t\tObject.values(fields).length ?\n\t\t\t\t\t\t<>You do not have any available authentication methods for this team.<br />Do you definitely own it?</> :\n\t\t\t\t\t\t<>There are no available authentication methods for this team.<br />Submit a request to your Tournament director.</> :\n\t\t\t\t\tnull\n\t\t\t\t}\n\t\t\t</>\n\t\t})\n\t}, [createTrigger, fields, props.user, props.profile.name, getName, setAlert, chessComClub]);\n\n\tconst [redirect, setRedirect] = useState(false);\n\tif (props.location.search.startsWith('?user=')) window.close();\n\tif (redirect) return <Redirect to='/' />;\n\n\treturn (\n\t\t<div className={styles.container}>\n\t\t\t<div className={styles.title}>\n\t\t\t\t<div className={['container', styles.info].join(' ')}>\n\t\t\t\t\t<h1>\n\t\t\t\t\t\t<span className='bold'>\n\t\t\t\t\t\t\t{props.profile.username || props.profile.name}\n\t\t\t\t\t\t\t{props.profile.verified ? <FaCheckCircle className='verified' /> : null}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</h1>\n\t\t\t\t\t<div className={styles.details}>\n\t\t\t\t\t\t{isLoggedIn && !props.isAuthed && props.type === 'team' ?\n\t\t\t\t\t\t\t!props.profile.teamId ?\n\t\t\t\t\t\t\t\t<div className={['button', 'link', styles.account].join(' ')} onClick={handleCreate}>\n\t\t\t\t\t\t\t\t\tThis team is unclaimed. Register team?\n\t\t\t\t\t\t\t\t\t<FaAngleRight />\n\t\t\t\t\t\t\t\t</div> :\n\t\t\t\t\t\t\t\t<div className={['button', 'link', styles.account, styles.claim].join(' ')}>\n\t\t\t\t\t\t\t\t\tRegistered\n\t\t\t\t\t\t\t\t</div> :\n\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t}\n\t\t\t\t\t\t{props.profile.nationality ? <div className={styles.flag}>\n\t\t\t\t\t\t\t<img src={flags.replace('|', props.profile.nationality)} alt={props.profile.nationality}/>\n\t\t\t\t\t\t\t{countries[props.profile.nationality as keyof typeof countries]}\n\t\t\t\t\t\t</div> : null}\n\t\t\t\t\t\t{props.type === 'team' && props.profile.founder ?\n\t\t\t\t\t\t\t<div>Founder: <Link to={'/@/' + props.profile.founder} className='playerName'>{props.profile.founder}</Link></div> :\n\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t}\n\t\t\t\t\t\t{props.type === 'team' && props.profile.users ?\n\t\t\t\t\t\t\t<div>Members: <Link to={['', 'team', props.id, 'members'].join('/')} className='playerName'>{props.profile.users.length}</Link></div> :\n\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t}\n\t\t\t\t\t\t<div>Account creation: {new Date(props.profile.createdAt).toString().slice(0, 15)}</div>{/*}\n\t\t\t\t\t\t<div>Tournaments: {tournaments.length}</div>\n\t\t\t\t\t\t<div>Public tournaments: {tournaments.filter(t => t.setting && t.setting.public).length}</div>*/}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={styles.buttons}>\n\t\t\t\t\t\t{props.isAuthed ?\n\t\t\t\t\t\t\t<div className={styles.row}>\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<a href={isDev ? 'https://localhost:3000' : 'https://beta.scorchapp.co.uk'} rel='noopener noreferrer' target='_blank' className={['button', 'link', styles.new].join(' ')}>\n\t\t\t\t\t\t\t\t\tCreate New Tournament\n\t\t\t\t\t\t\t\t\t<FaAngleRight />\n\t\t\t\t\t\t\t\t</a>\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t{props.endSession ? <div className={['button', 'link', styles.logout].join(' ')} onClick={() => {\n\t\t\t\t\t\t\t\t\tif (props.endSession) props.endSession().then(() => setRedirect(true));\n\t\t\t\t\t\t\t\t}}>\n\t\t\t\t\t\t\t\t\tLog out\n\t\t\t\t\t\t\t\t\t<FaAngleRight />\n\t\t\t\t\t\t\t\t</div> : null}\n\t\t\t\t\t\t\t</div> :\n\t\t\t\t\t\tnull}\t\t\t\t\t\n\t\t\t\t\t\t{!isLoggedIn ?\n\t\t\t\t\t\t\t<div className={styles.row}>\n\t\t\t\t\t\t\t\t<Link to='/login' className={['button', 'link'].join(' ')}>Sign in to view contact details</Link>\n\t\t\t\t\t\t\t</div> :\n\t\t\t\t\t\t!Object.values(fields).length ?\n\t\t\t\t\t\t\t<div className={styles.row}>No contact details registered</div> :\n\t\t\t\t\t\tfields.map(([meta, entry], i) => {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<div className={styles.row} key={['row', i].join('.')}>\n\t\t\t\t\t\t\t\t\t{entry.link || meta.idLink || meta.link ?\n\t\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t\tid={meta.id}\n\t\t\t\t\t\t\t\t\t\t\thref={entry.link || (meta.idLink || meta.link as string).replace('|', entry.username || '')}\n\t\t\t\t\t\t\t\t\t\t\tclassName={['button', 'link', styles.account].join(' ')}\n\t\t\t\t\t\t\t\t\t\t\trel='noopener noreferrer'\n\t\t\t\t\t\t\t\t\t\t\ttarget='_blank'\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{typeof meta.icon[1] === 'string' ? <img src={meta.icon[1]} alt={meta.id} className={styles.icon} /> : React.cloneElement(meta.icon[1], { className: styles.icon })}\n\t\t\t\t\t\t\t\t\t\t\t{getName(meta, entry)}\n\t\t\t\t\t\t\t\t\t\t\t{entry.verified ? <FaCheckCircle className='verified' /> : null}\n\t\t\t\t\t\t\t\t\t\t</a> :\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tid={meta.id}\n\t\t\t\t\t\t\t\t\t\t\tclassName={['button', 'link', styles.account].join(' ')}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{typeof meta.icon[1] === 'string' ? <img src={meta.icon[1]} alt={meta.id} className={styles.icon} /> : React.cloneElement(meta.icon[1], { className: styles.icon })}\n\t\t\t\t\t\t\t\t\t\t\t{getName(meta, entry)}\n\t\t\t\t\t\t\t\t\t\t\t{entry.verified ? <FaCheckCircle className='verified' /> : null}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\t\t\t\t\t\t{Notes.length && Notes.some(n => n) ? Notes.map(n => <div className={styles.row}>{n}</div>) : null}\n\t\t\t\t\t</div>\n\t\t\t\t\t<Route path='/team/:id/:section?' render={(rProps) => {\n\t\t\t\t\t\treturn <UserSwitcher\n\t\t\t\t\t\t\tsection={rProps.match.params.section || 'play'}\n\t\t\t\t\t\t\tloaded\n\t\t\t\t\t\t\tsections={{\n\t\t\t\t\t\t\t\t'play': {\n\t\t\t\t\t\t\t\t\tname: 'Play',\n\t\t\t\t\t\t\t\t\tlink: `/team/${props.id}/`,\n\t\t\t\t\t\t\t\t\ticon: <GiCrossedSwords />\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttournaments: {\n\t\t\t\t\t\t\t\t\tlink: `/team/${props.id}/tournaments`,\n\t\t\t\t\t\t\t\t\ticon: <FaChess />\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tmembers: {\n\t\t\t\t\t\t\t\t\thide: !props.profile.players && !props.profile.teamId,\n\t\t\t\t\t\t\t\t\tlink: `/team/${props.id}/members`,\n\t\t\t\t\t\t\t\t\ticon: <FaUsers />\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\taccounts: {\n\t\t\t\t\t\t\t\t\thide: props.isAuthed < 2,\n\t\t\t\t\t\t\t\t\tlink: `/team/${props.id}/accounts`,\n\t\t\t\t\t\t\t\t\ticon: <FaUserCircle />\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tsettings: {\n\t\t\t\t\t\t\t\t\thide: props.isAuthed < 2,\n\t\t\t\t\t\t\t\t\tlink: `/team/${props.id}/settings`,\n\t\t\t\t\t\t\t\t\ticon: <FaCogs />\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t}} />\n\t\t\t\t\t<Route exact path='/@/:id/:section?' render={(rProps) => {\n\t\t\t\t\t\treturn <UserSwitcher\n\t\t\t\t\t\t\tsection={rProps.match.params.section}\n\t\t\t\t\t\t\tloaded\n\t\t\t\t\t\t\tsections={{\n\t\t\t\t\t\t\t\ttournaments: {\n\t\t\t\t\t\t\t\t\tlink: `/@/${props.profile.username}/tournaments`,\n\t\t\t\t\t\t\t\t\ticon: <FaChess />\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tteams: {\n\t\t\t\t\t\t\t\t\tlink: `/@/${props.profile.username}/teams`,\n\t\t\t\t\t\t\t\t\ticon: <FaUsers />\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\taccounts: {\n\t\t\t\t\t\t\t\t\thide: !props.isAuthed,\n\t\t\t\t\t\t\t\t\tlink: `/@/${props.profile.username}/accounts`,\n\t\t\t\t\t\t\t\t\ticon: <FaUserCircle />\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tsettings: {\n\t\t\t\t\t\t\t\t\thide: !props.isAuthed,\n\t\t\t\t\t\t\t\t\tlink: `/@/${props.profile.username}/settings`,\n\t\t\t\t\t\t\t\t\ticon: <FaCogs />\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t}} />\n\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}","import React, { useEffect, useState } from 'react';\nimport { StaticContext } from 'react-router';\nimport { Redirect, RouteComponentProps } from 'react-router-dom';\nimport { POST } from '../utils/requests';\n\nexport default function Verify(props: RouteComponentProps<any, StaticContext, any> & {\n\tid: string\n\tupdateProfile: () => void\n}) {\n\n\tconst [verified, setVerified] = useState(false);\n\n\tuseEffect(() => {\n\t\tif (verified) return;\n\t\tPOST({\n\t\t\turl: '/profile/email/authenticate',\n\t\t\tdata: props.location.search.slice(1).split('&').reduce((acc: {[key: string]: string}, curr: string) => {\n\t\t\t\tlet [k, v] = curr.split('=');\n\t\t\t\tacc[k] = v;\n\t\t\t\treturn acc;\n\t\t\t}, {})\n\t\t})\n\t\t\t.then(() => setVerified(true));\n\t}, [verified, setVerified, props.location.search])\n\n\tif (verified) {\n\t\tprops.updateProfile();\n\t\treturn <Redirect push to={{\n\t\t\tpathname: `/@/${props.id}/accounts`,\n\t\t\tstate: props.history.location.state\n\t\t}} />\n\t}\n\n\treturn null;\n}","import React, { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { Redirect, RouteComponentProps, Route, Switch } from 'react-router-dom';\r\nimport { StaticContext } from 'react-router';\r\nimport Tournaments from './Tournaments';\r\nimport { ProfileData, Team } from '../interfaces';\r\nimport Info from './Info';\r\nimport { SettingsComponent, Accounts, Teams } from '.'\r\nimport { GET, POST } from '../utils/requests';\r\nimport * as regexes from '../utils/regexes';\r\nimport NotFound from '../404';\r\nimport Verify from './Verify';\r\n\r\nexport default function User(props: RouteComponentProps<any, StaticContext, any> & {\r\n\tid: string\r\n\tprofile: ProfileData\r\n\tupdateProfile: () => void\r\n\tendSession: () => Promise<void>\r\n}) {\r\n\r\n\tconst [profile, setProfile] = useState(undefined as Team & ProfileData | null | undefined);\r\n\tconst id = useMemo(() => profile?.username || props.id, [props.id, profile]);\r\n\r\n\tconst updateProfile = useCallback(async () => {\r\n\t\tif (!regexes.username.test(props.id)) return setProfile(null);\r\n\t\tGET({ url: '/user/' + props.id })\r\n\t\t\t.then(setProfile)\r\n\t\t\t.catch(() => setProfile(null));\r\n\t}, [props.id, setProfile])\r\n\tuseEffect(() => {\r\n\t\tupdateProfile();\r\n\t}, [updateProfile]);\r\n\r\n\tconst isAuthed = props.id.toLowerCase() === props.profile.uniqueID;\r\n\r\n\tif (profile === undefined) return null;\r\n\tif (!profile) return <NotFound />;\r\n\r\n\treturn (<>\r\n        <div id='main' className={'animated-' + props.location.state?.direction}>\r\n\t\t\t<Info\r\n\t\t\t\t{...props}\r\n\t\t\t\tuser={props.profile}\r\n\t\t\t\tprofile={profile}\r\n\t\t\t\tupdateProfile={updateProfile}\r\n\t\t\t\tisAuthed={isAuthed}\r\n\t\t\t\ttype='user'\r\n\t\t\t/>\r\n\t\t\t<Route render={({location}) => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Switch location={location}>\r\n\t\t\t\t\t\t<Route exact path={`/@/${id}`} render={() => {\r\n\t\t\t\t\t\t\treturn <Tournaments {...props} user={props.profile} profile={profile} isAuthed={isAuthed} direction={props.location.state.direction.slice(6)} type='player'/>\t\r\n\t\t\t\t\t\t}}/>\r\n\t\t\t\t\t\t<Route exact path={`/@/${id}/verify/:account?`} render={(rProps) => {\r\n\t\t\t\t\t\t\tif (!isAuthed) return null;\r\n\t\t\t\t\t\t\treturn <Verify {...props} id={id} updateProfile={updateProfile}/>;\r\n\t\t\t\t\t\t}}/>\r\n\t\t\t\t\t\t<Route exact path={`/@/${id}/tournaments`} render={() => {\r\n\t\t\t\t\t\t\treturn <Tournaments {...props} user={props.profile} profile={profile} isAuthed={isAuthed} direction={props.location.state.direction.slice(6)} type='player'/>\t\r\n\t\t\t\t\t\t}}/>\r\n\t\t\t\t\t\t<Route exact path={`/@/${id}/teams`} render={() => {\r\n\t\t\t\t\t\t\treturn <Teams {...props} profile={profile} direction={props.location.state.direction.slice(6)} updateProfile={updateProfile}/>\t\r\n\t\t\t\t\t\t}}/>\r\n\t\t\t\t\t\t<Route exact path={`/@/${id}/accounts`} render={() => {\r\n\t\t\t\t\t\t\tif (!isAuthed) return null;\r\n\t\t\t\t\t\t\treturn <Accounts {...props} profile={profile} direction={props.location.state.direction.slice(6)} updateProfile={updateProfile}/>\t\r\n\t\t\t\t\t\t}}/>\r\n\t\t\t\t\t\t<Route exact path={`/@/${id}/settings`} render={() => {\r\n\t\t\t\t\t\t\tif (!isAuthed) return null;\r\n\t\t\t\t\t\t\treturn <SettingsComponent {...props} user={props.profile} direction={props.location.state.direction.slice(6)} updateProfile={props.updateProfile}/>\t\r\n\t\t\t\t\t\t}}/>\r\n\t\t\t\t\t</Switch>\r\n\t\t\t\t)\r\n\t\t\t}} />\t\t\r\n\t\t</div>\r\n\t</>)\r\n}","import React, { useState, useCallback, useEffect, ReactElement } from 'react';\nimport { StaticContext } from 'react-router';\nimport { Link, RouteComponentProps } from 'react-router-dom';\nimport styles from '../pages/css/community.module.css';\nimport { GET, POST } from '../utils/requests';\nimport { ProfileData, Team } from '../interfaces';\nimport { FaCrown, FaCircle, FaPlusCircle } from 'react-icons/fa';\nimport AutoComplete from '../components/AutoComplete';\nimport { renderTeam } from './hooks';\n\nexport default function Teams(props: RouteComponentProps<any, StaticContext, any> & {\n\tdirection: string\n\tprofile: ProfileData\n\tupdateProfile: () => void\n}): ReactElement {\n\n\tif (!props.profile.teams?.length) return <section className='container'>\n\t\tThis user is not in any teams\n\t</section>\n\n\treturn <>\n\t\t{(props.profile.teams || []).map(renderTeam)}\n\t</>\n}\n\nexport function Members(props: RouteComponentProps<any, StaticContext, any> & {\n\tteam: Team & ProfileData\n\tupdateProfile: () => void\n\tisAuthed: boolean\n}) {\n\n\tconst [users, setUsers] = useState([]);\n\tconst updateUsers = useCallback(() => GET({ url: '/users' })\n\t\t.then(setUsers), [setUsers]);\n\tuseEffect(() => {\n\t\tupdateUsers();\n\t}, [updateUsers]);\n\n\tconst [admins, setAdmins] = useState([] as ProfileData[]);\n\tconst [members, setMembers] = useState([] as ProfileData[]);\n\tuseEffect(() => {\n\t\tif (!props.team.users) return;\n\t\tlet a = [] as ProfileData[];\n\t\tlet m = [] as ProfileData[];\n\t\tfor (let u of props.team.users) {\n\t\t\tif (u.level) a.push(u);\n\t\t\telse m.push(u);\n\t\t}\n\t\tsetAdmins(a);\n\t\tsetMembers(m);\n\t}, [setAdmins, setMembers, props.team])\n\n\tconst addUser = useCallback((u: ProfileData) => POST({\n\t\turl: ['team', props.team.id, 'addUser'].join('/'),\n\t\tdata: { username: u.username }\n\t})\n\t\t.then(props.updateProfile), [props.updateProfile, props.team.id]);\n\n\treturn <>\n\t\t<section className='container'>\n\t\t\t<h1><b>Admins</b></h1>\n\t\t\t<div className={styles.userTable}>\n\t\t\t\t{admins.map((u: ProfileData, i: number) => {\n\t\t\t\t\treturn <>\n\t\t\t\t\t\t<div key={['status', i].join('.')} className={styles.status}>\n\t\t\t\t\t\t\t{u.isLicensed ? <FaCrown /> : <FaCircle style={{fontSize: '0.5em'}} />}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Link key={['username', i].join('.')} className={styles.profile} to={'/@/' + u.username}>\n\t\t\t\t\t\t\t{u.username}\n\t\t\t\t\t\t</Link>\n\t\t\t\t\t</>\n\t\t\t\t})}\n\t\t\t</div>\n\t\t</section>\n\t\t<section className='container'>\n\t\t\t<h1><b>Members</b></h1>\n\t\t\t<div className={styles.userTable}>\n\t\t\t\t{\n\t\t\t\t\tprops.isAuthed ?\n\t\t\t\t\t<>\n\t\t\t\t\t\t<div />\n\t\t\t\t\t\t<div className={styles.searchBar}>\n\t\t\t\t\t\t\t<FaPlusCircle />\n\t\t\t\t\t\t\t<AutoComplete\n\t\t\t\t\t\t\t\tonChange={() => {}}\n\t\t\t\t\t\t\t\tonSubmit={addUser}\n\t\t\t\t\t\t\t\taction=''\n\t\t\t\t\t\t\t\toptions={users}\n\t\t\t\t\t\t\t\tconvert={(u: ProfileData) => u.username}\n\t\t\t\t\t\t\t\tstyles={styles}\n\t\t\t\t\t\t\t\tplaceholder='Add new member'\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</> :\n\t\t\t\t\tnull\n\t\t\t\t}\n\t\t\t\t{members.map((u: ProfileData, i: number) => {\n\t\t\t\t\treturn <>\n\t\t\t\t\t\t<div key={['status', i].join('.')} className={styles.status}>\n\t\t\t\t\t\t\t{u.isLicensed ? <FaCrown /> : <FaCircle style={{fontSize: '0.5em'}} />}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Link key={['username', i].join('.')} className={styles.profile} to={'/team/' + u.username}>\n\t\t\t\t\t\t\t{u.username}\n\t\t\t\t\t\t</Link>\n\t\t\t\t\t</>\n\t\t\t\t})}\n\t\t\t</div>\n\t\t</section>\n\t</>\n}","import React, { ReactElement, useEffect, useState, useCallback } from 'react';\nimport { StaticContext } from 'react-router';\nimport { Link, RouteComponentProps } from 'react-router-dom';\nimport styles from './css/user.module.css';\nimport { ProfileData, Team, History, EnhancedPlayer, Player, PairingObject, EnhancedMatch } from '../interfaces';\nimport { GET } from '../utils/requests';\nimport SectionBreak from '../components/SectionBreak';\nimport { RenderMatch } from './hooks';\n\nexport default function Play(props: RouteComponentProps<any, StaticContext, any> & {\n\tdirection: string\n\tprofile: Team & ProfileData\n\ttype: 'team' | 'player'\n\tisAuthed: number\n}): ReactElement {\n\n\tconst [upcoming, setUpcoming] = useState([] as EnhancedMatch[]);\n\tconst [past, setPast] = useState([] as EnhancedMatch[]);\n\tconst populateGames = useCallback(async () => {\n\t\tlet u = [] as EnhancedMatch[];\n\t\tlet p = [] as EnhancedMatch[];\n\n\t\tconst tournaments = props.profile.tournaments.filter(t => t.active);\n\n\t\tlet opponents = {} as {[key: string]: Player};\n\t\tlet results = {} as {[key: string]: PairingObject}\n\t\tfor (let t of tournaments) {\n\t\t\tlet opps = [] as string[];\n\t\t\tlet res = [] as string[];\n\t\t\tif (t.histories) for (let i = 1; i < t.histories.length; i++) {\n\t\t\t\tlet h = t.histories[i];\n\t\t\t\tif (!h) continue;\n\t\t\t\topps.push(h.id);\n\t\t\t\tlet ids = [t.id, h.id];\n\t\t\t\tif (h.colour === 'B') ids = ids.reverse();\n\t\t\t\tres.push([...ids, t.tournamentId, i].join('.'));\n\t\t\t};\n\n\t\t\tlet players = await GET({\n\t\t\t\turl: ['tournament', t.tournamentId, 'fetchPlayers'].join('/'), \n\t\t\t\tparams: { ids: opps.join(',') }\n\t\t\t}).catch((e) => {console.error(e); return []});\n\t\t\tfor (let p of players) opponents[p.id] = p;\n\n\t\t\tlet games = await GET({\n\t\t\t\turl: ['tournament', t.tournamentId, 'getPairings'].join('/'), \n\t\t\t\tparams: { ids: res.join(',') }\n\t\t\t}).catch((e) => {console.error(e); return []});\n\t\t\tfor (let i = 0; i < games.length; i++) {\n\t\t\t\tresults[res[i].split('.').slice(-2).join('.')] = games[i];\n\t\t\t}\n\t\t}\n\n\t\tfor (let t of tournaments) {\n\t\t\tif (!t.histories) continue;\n\t\t\tfor (let i = t.histories.length - 1; i >= 0; i--) {\n\t\t\t\tlet currGame = t.histories[i];\n\t\t\t\tif (!currGame) continue;\n\t\t\t\tlet match = {\n\t\t\t\t\tprop: t as EnhancedPlayer,\n\t\t\t\t\topp: opponents[currGame.id] as Player,\n\t\t\t\t\tb: currGame.colour === 'B' ? t : t as any as EnhancedPlayer,\n\t\t\t\t\tid: currGame.colour === 'B' ? [currGame.id, t.id].join('.') : [t.id, currGame.id].join('.'),\n\t\t\t\t\tround: i,\n\t\t\t\t\tcolour: currGame.colour,\n\t\t\t\t\tresult: results[[t.tournamentId, i].join('.')]\n\t\t\t\t}\n\t\t\t\tif (currGame.match === null) u.push(match);\n\t\t\t\telse p.push(match);\n\t\t\t}\n\t\t}\n\t\tsetUpcoming(u);\n\t\tsetPast(p);\n\t}, [props.profile, setUpcoming, setPast])\n\tuseEffect(() => {\n\t\tpopulateGames();\n\t}, [populateGames]);\n\n\treturn <>\n\t\t<SectionBreak name='UPCOMING MATCHES'/>\n\t\t{upcoming.map(u => <RenderMatch u={u} isAuthed={props.isAuthed} update={populateGames} />)}\n\t\t<SectionBreak name='PAST MATCHES' expanded={false} />\n\t\t{past.map(u => <RenderMatch u={u} isAuthed={props.isAuthed} update={populateGames} />)}\n\t\t<section />\n\t</>\n}","import React, { useEffect, useState, useCallback, ReactElement, useMemo, useReducer, useContext } from 'react';\r\nimport { StaticContext } from 'react-router';\r\nimport { Route, Switch, RouteComponentProps, Redirect } from 'react-router-dom';\r\n\r\nimport { GET } from '../utils/requests';\r\nimport { Team as TeamInterface, EnhancedPlayer, ProfileData } from '../interfaces';\r\nimport { renderTournament, fetchNames } from './hooks';\r\nimport NotFound from '../404';\r\nimport Info from './Info';\r\nimport Tournaments from './Tournaments';\r\nimport { Members } from './Teams';\r\nimport { useMemoWithLabel } from '../utils/hooks';\r\nimport Play from './Play';\r\n\r\nexport default function Team(props: RouteComponentProps<any, StaticContext, any> & {\r\n\tid: string\r\n\tprofile: ProfileData\r\n\ttype: 'player' | 'team'\r\n}): ReactElement | null {\r\n\r\n\tconst [player, setPlayer] = useState(undefined as TeamInterface & ProfileData | null | undefined);\r\n\tconst updateProfile = useCallback(() => GET({ url: '/' + props.type + '/' + props.id })\r\n\t\t.then(p => {setPlayer(p); return p})\r\n\t\t.then(p => !p.teamId ? null : window.history.pushState('', document.title, window.location.pathname.replace(props.id, p.teamId) + window.location.search))\r\n\t\t.catch(() => setPlayer(null)), [setPlayer, props.id, props.type]);\r\n\tuseEffect(() => {\r\n\t\tupdateProfile();\r\n\t}, [updateProfile]);\r\n\tconst isAuthed: number | boolean = useMemoWithLabel(() => {\r\n\t\treturn props.type === 'player' ?\r\n\t\t\tprops.id.toLowerCase() === props.profile.uniqueID :\r\n\t\t\ttypeof player?.permissions === 'number' ? player.permissions + 1 : 0;\r\n\t}, [props.type, props.id, props.profile, player], 'isAuthed');\r\n\r\n\tif (player === undefined) return null;\r\n\tif (player === null) return <NotFound />;\r\n\t\r\n\treturn <>\r\n\t\t<div id='main' className={'animated-' + props.location.state?.direction}>\r\n\t\t\t<Info\r\n\t\t\t\t{...props}\r\n\t\t\t\tuser={props.profile}\r\n\t\t\t\tprofile={player}\r\n\t\t\t\tupdateProfile={updateProfile}\r\n\t\t\t\tisAuthed={isAuthed as number}\r\n\t\t\t\ttype='team'\r\n\t\t\t/>\r\n\t\t\t<Route render={({location}) => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Switch location={location}>\r\n\t\t\t\t\t\t<Route exact path={`/team/${props.id}`} render={() => {\r\n\t\t\t\t\t\t\treturn <Play {...props} profile={player} direction={props.location.state.direction.slice(6)} isAuthed={isAuthed as number} type={props.type} />;\r\n\t\t\t\t\t\t}}/>\r\n\t\t\t\t\t\t<Route exact path={`/team/${props.id}/tournaments`} render={() => {\r\n\t\t\t\t\t\t\treturn <Tournaments {...props} user={props.profile} profile={player} isAuthed={!!isAuthed} direction={props.location.state.direction.slice(6)} type={props.type}/>\t\r\n\t\t\t\t\t\t}}/>\r\n\t\t\t\t\t\t<Route exact path={`/team/${props.id}/members`} render={() => {\r\n\t\t\t\t\t\t\treturn <Members {...props} team={player} isAuthed={!!player.permissions} updateProfile={updateProfile} />\t\r\n\t\t\t\t\t\t}}/>\r\n\t\t\t\t\t</Switch>\r\n\t\t\t\t)\r\n\t\t\t}} />\r\n\t\t</div>\r\n\t</>\r\n}","import React from 'react';\n\nexport default function ToggleSwitch(props: {\n\ton: boolean\n\tonSwitch: (newState: boolean) => void\n\tmain: {\n\t\ton: string\n\t\toff: string\n\t}\n\tsub?: {\n\t\ton: string\n\t\toff: string\n\t}\n}) {\n\treturn (\n\t\t<div className={['header-button', 'switchContainer'].join(' ')}>\n\t\t\t<label>\n\t\t\t\t<div>{props.on ? props.main.on : props.main.off}</div>\n\t\t\t\t{props.sub ? <div>{props.on ? props.sub.on : props.sub.off }</div> : null}\n\t\t\t</label>\n\t\t\t<div className='toggleSwitch' onClick={() => props.onSwitch(!props.on)}>\n\t\t\t\t<input type='checkbox' className='check' checked={props.on}/>\n\t\t\t\t<div className='toggleSlider round' />\n\t\t\t</div>\n\t\t</div>\n\t)\n}","import { useEffect, useMemo, useState, useCallback } from 'react';\nimport { cookies, lichess, lichessCallback, POST } from '../../utils/requests';\n\nexport function useLink(props: {\n\tcurrentPath: string\n\tupdateProfile: () => void\n}) {\n\n\tconst { updateProfile } = props;\n\tconst [sessionID, setSession] = useState('');\n\tuseEffect(() => {\n\t\t(async () => {\n\t\t\tlet c = await cookies.getAll();\n\t\t\tsetSession(c.sessionID);\n\t\t})();\n\t}, [setSession]);\n\tconst href = useMemo(() => {\n\t\tconst base = 'https://oauth.lichess.org/oauth/authorize';\n\t\tconst scopes = [\n\t\t\t['email', 'read'],\n\t\t\t['challenge', 'read'],\n\t\t\t['challenge', 'write']\n\t\t] as string[][];\n\t\tconst params = {\n\t\t\tresponse_type: 'code',\n\t\t\tclient_id: lichess,\n\t\t\tredirect_uri: lichessCallback,\n\t\t\tscope: scopes.map(scope => scope.join(':')).join(' '),\n\t\t\tstate: `${sessionID?.slice(0, 8)}.referrer=${props.currentPath}`\n\t\t}\n\t\treturn `${base}?${Object.entries(params).map(p => p.join('=')).join('&')}`;\n\t}, [sessionID, props.currentPath]);\n\n\tconst [win, setWindow] = useState(null as Window | null);\n\tconst handleClose = useCallback((myWin: Window) => {\n\t\tif (!myWin.closed) return;\n\t\tsetWindow(null);\n\t\tupdateProfile();\n\t}, [updateProfile, setWindow]);\n\tuseEffect(() => {\n\t\tif (!win) return;\n\t\tlet x = setInterval(() => handleClose(win), 1000);\n\t\treturn () => clearInterval(x);\n\t}, [win, handleClose]);\n\n\treturn { href, setWindow };\n\n}\n\nexport function handleSync(updateProfile: () => void) {\n\treturn POST({ url: ['profile', 'lichess', 'updateFrom'].join('/') })\n\t\t.finally(updateProfile)\n}","import { useCallback } from 'react';\nimport { FacebookCallback } from '../../interfaces';\nimport { POST } from '../../utils/requests';\n\nexport function useFacebook(props: {\n\tupdateProfile: () => void\n}) {\n\t\n\tconst handleFacebook = useCallback((res: FacebookCallback) => {\n\t\tif (!res || !res.id) return;\n\t\tPOST({\n\t\t\turl: '/profile/facebook/link',\n\t\t\tdata: {\n\t\t\t\tid: res.userID,\n\t\t\t\tname: res.name,\n\t\t\t\temail: res.id,\n\t\t\t\taccessToken: res.accessToken\n\t\t\t}\n\t\t})\n\t\t\t.then(props.updateProfile);\n\t}, [props.updateProfile]);\n\n\treturn handleFacebook;\n\n}","import React, { useEffect, useState, useCallback, useMemo, useContext } from 'react';\nimport { StaticContext } from 'react-router';\nimport { RouteComponentProps } from 'react-router-dom';\nimport { POST, GET } from '../utils/requests';\nimport { ProfileData, ContactEntry } from '../interfaces';\nimport contactFields, { ContactMeta } from '../resources/contact';\nimport SectionBreak from '../components/SectionBreak';\nimport ToggleSwitch from '../components/ToggleSwitch';\nimport styles from './css/user.module.css';\nimport { FaCheckCircle, FaSyncAlt, FaSkullCrossbones, FaAngleRight, FaTimes, FaPaperPlane } from 'react-icons/fa';\nimport * as callbacks from './callbacks/';\nimport { capitalise } from '../utils/prototype';\nimport FacebookLogin from 'react-facebook-login';\nimport { AlertContext } from '../Contexts';\nimport { getChessComTeam } from '../chess/ChessCom';\n\nconst teams = {\n\tchessCom: getChessComTeam\n}\n\nexport default function Accounts(props: RouteComponentProps<any, StaticContext, any> & {\n\tdirection: string\n\tprofile: ProfileData\n\tupdateProfile: () => void\n\tpermanent?: boolean\n}) {\n\n\tconst [accounts, setAccounts] = useState(props.profile as any as {[key: string]: ContactEntry});\n\tuseEffect(() => {\n\t\tsetAccounts(props.profile as any as {[key: string]: ContactEntry});\n\t}, [setAccounts, props.profile]);\n\tconst getAccounts = useCallback(() => GET({ url: '/user/' + props.profile.username + '/getAccounts' })\n\t\t.then(setAccounts), [setAccounts, props.profile.username]);\n\tconst updateAccount = useCallback((k: string, v: Partial<ContactEntry>) => {\n\t\tPOST({\n\t\t\turl: '/profile/updateAccount',\n\t\t\tdata: {\n\t\t\t\taccount: k === 'email' ? 'emailMeta' : k,\n\t\t\t\tdata: v\n\t\t\t}\n\t\t})\n\t\t\t.then(setAccounts)\n\t}, [setAccounts]);\n\tconst [verified, setVerified] = useState([] as [ContactMeta, ContactEntry][]);\n\tconst [pending, setPending] = useState([] as [ContactMeta, ContactEntry][]);\n\tconst [available, setAvailable] = useState([] as [ContactMeta, ContactEntry][]);\n\tuseEffect(() => {\n\t\tlet v = [] as [ContactMeta, ContactEntry][];\n\t\tlet p = [] as [ContactMeta, ContactEntry][];\n\t\tlet a = [] as [ContactMeta, ContactEntry][];\n\t\tfor (let [k, meta] of Object.entries(contactFields)) {\n\t\t\tif (k in accounts) {\n\t\t\t\tlet entry = accounts[k as keyof ProfileData] as ContactEntry;\n\t\t\t\tif (k === 'email') entry = Object.assign(accounts.emailMeta || {}, {\n\t\t\t\t\tid: entry as any as string,\n\t\t\t\t\tusername: entry as any as string\n\t\t\t\t});\n\t\t\t\tObject.assign(meta, { id: k });\n\t\t\t\tif (entry?.verified) v.push([meta, entry]);\n\t\t\t\telse if (!entry?.id && !entry?.username) a.push([meta, entry]);\n\t\t\t\telse p.push([meta, entry]);\n\t\t\t} else\n\t\t\tif (meta.canLink) a.push([meta, {} as ContactEntry]);\n\t\t}\n\t\tsetVerified(v);\n\t\tsetPending(p);\n\t\tsetAvailable(a);\n\t}, [accounts, setVerified, setPending, setAvailable]);\n\n\tconst { updateProfile } = props;\n\tconst { currentPath } = props.location.state;\n\tconst linkLichess = callbacks.lichess.useLink({ currentPath, updateProfile });\n\tconst linkChessCom = callbacks.chessCom.useLink({ updateProfile });\t\n\tconst linkFacebook = callbacks.facebook.useFacebook({ updateProfile });\n\tconst links = {\n\t\t['lichess' as string]: linkLichess,\n\t\tchessCom: linkChessCom,\n\t\tfacebook: { href: linkFacebook, setWindow: () => {} }\n\t}\n\tconst setAlert = useContext(AlertContext);\n\tconst verifyChessCom = callbacks.chessCom.useVerify({ profile: props.profile, updateProfile });\n\tconst verify = useMemo(() => {\n\t\treturn {\n\t\t\tchessCom: verifyChessCom,\n\t\t\temail: (force?: boolean) => POST({ url: '/profile/email/verify', data: { force } })\n\t\t\t\t.then(() => setAlert({\n\t\t\t\t\ttitle: 'Verify email account',\n\t\t\t\t\tmessage: 'An email has been sent to ' + props.profile.email + '. Check your inbox!'\n\t\t\t\t}))\n\t\t\t\t.then(updateProfile)\n\t\t} as {[key: string]: (force?: boolean) => void}\n\t}, [verifyChessCom, setAlert, props.profile.email, updateProfile]);\n\tconst sync = useMemo(() => {\n\t\treturn {\n\t\t\tlichess: () => callbacks.lichess.handleSync(updateProfile),\n\t\t} as {[key: string]: () => void}\n\t}, [updateProfile]);\n\n\treturn (<>\n\t\t<SectionBreak name='VERIFIED ACCOUNTS' />\n\t\t{verified.map(([meta, entry], i) => {\n\t\t\treturn <section key={['section', i].join(' ')} className={['container', styles.accountSection].join(' ')}>\n\t\t\t\t<div className={['optionsContainer', styles.optionsContainer].join(' ')}>\n\t\t\t\t\t<a\n\t\t\t\t\t\tid={meta.id}\n\t\t\t\t\t\thref={(meta.idLink || meta.link as string).replace('|', entry.username || entry.id as string)}\n\t\t\t\t\t\tclassName={['button', 'link', styles.account, styles.inline].join(' ')}\n\t\t\t\t\t\trel='noopener noreferrer'\n\t\t\t\t\t\ttarget='_blank'\n\t\t\t\t\t>\n\t\t\t\t\t\t{typeof meta.icon[1] === 'string' ? <img src={meta.icon[1]} alt={meta.id} className={styles.icon} /> : React.cloneElement(meta.icon[1], {\n\t\t\t\t\t\t\tclassName: styles.icon\n\t\t\t\t\t\t})}\n\t\t\t\t\t\t{meta.name || capitalise(meta.id as string)}\n\t\t\t\t\t\t<FaCheckCircle className='verified' />\n\t\t\t\t\t</a>\n\t\t\t\t\t<ToggleSwitch\n\t\t\t\t\t\ton={entry.public !== false}\n\t\t\t\t\t\tonSwitch={(newState) => updateAccount(meta.id as string, { public: newState })}\n\t\t\t\t\t\tmain={{\n\t\t\t\t\t\t\ton: 'Public',\n\t\t\t\t\t\t\toff: 'Hidden'\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tsub={{\n\t\t\t\t\t\t\ton: 'Switch to hide your account from public view',\n\t\t\t\t\t\t\toff: 'Switch on to make visible to all signed-in users'\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t\t{(meta.id as string) in sync ? <div className={['header-button', styles.accountButton].join(' ')} onClick={sync[meta.id as string]}>\n\t\t\t\t\t\t<div><FaSyncAlt />Sync data</div>\n\t\t\t\t\t</div> : null}\n\t\t\t\t\t{!meta.permanent ? <div className={['header-button', styles.accountButton, styles.remove].join(' ')} onClick={() => POST({ url: '/profile/removeAccount', data: { account: meta.id} }).then(setAccounts)}>\n\t\t\t\t\t\t<div><FaSkullCrossbones />Remove integration</div>\n\t\t\t\t\t</div> : null}\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t})}\n\t\t<SectionBreak name='PENDING VERIFICATION' />\n\t\t{pending.map(([meta, entry], i) => {\n\t\t\treturn <section key={['section', i].join(' ')} className={['container', styles.accountSection].join(' ')}>\n\t\t\t\t<div className={['optionsContainer', styles.pendingContainer].join(' ')}>\n\t\t\t\t\t<div\n\t\t\t\t\t\tid={meta.id}\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tif (!meta.id) return;\n\t\t\t\t\t\t\tif (!(meta.id in verify)) return;\n\t\t\t\t\t\t\tif (entry.sent) return;\n\t\t\t\t\t\t\tlet action = verify[meta.id as string];\n\t\t\t\t\t\t\taction();\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tclassName={['button', 'link', styles.account, styles.inline, entry.sent ? 'sent' : ''].join(' ')}\n\t\t\t\t\t>\n\t\t\t\t\t\t{typeof meta.icon[1] === 'string' ? <img src={meta.icon[1]} alt={meta.id} className={styles.icon} /> : React.cloneElement(meta.icon[1], { className: styles.icon })}\n\t\t\t\t\t\t{!entry.sent ? 'Verify' : ''} {entry.username || meta.name || capitalise(meta.id as string)}\n\t\t\t\t\t\t{!entry.sent ? <FaAngleRight /> : null}\n\t\t\t\t\t</div>\n\t\t\t\t\t{entry.sent ? <div className={['header-button', styles.accountButton].join(' ')} onClick={() => {\n\t\t\t\t\t\t\tif (!meta.id) return;\n\t\t\t\t\t\t\tif (!(meta.id in verify)) return;\n\t\t\t\t\t\t\tlet action = verify[meta.id as string];\n\t\t\t\t\t\t\taction(true);\n\t\t\t\t\t\t}}>\n\t\t\t\t\t\t<div><FaPaperPlane />Resend email</div>\n\t\t\t\t\t</div> : null}\n\t\t\t\t\t{!meta.permanent ? <div className={['header-button', styles.accountButton, styles.remove].join(' ')} onClick={() => POST({ url: '/profile/removeAccount', data: { account: meta.id} }).then(setAccounts)}>\n\t\t\t\t\t\t<div><FaTimes />Cancel</div>\n\t\t\t\t\t</div> : null}\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t})}\n\t\t<SectionBreak name='AVAILABLE' />\n\t\t{!available.length ? <section /> : <section className={['container', styles.accountSection].join(' ')}>\n\t\t\t<div className={['optionsContainer', styles.availableContainer].join(' ')}>\n\t\t\t\t{available.map(([meta, entry], i) => {\n\t\t\t\t\tif (meta.id && meta.id === 'facebook') {\n\t\t\t\t\t\tlet rProps = {\n\t\t\t\t\t\t\trender: (renderProps: any) => {\n\t\t\t\t\t\t\t\treturn <div\n\t\t\t\t\t\t\t\t\tkey={['entry', i].join(' ')}\n\t\t\t\t\t\t\t\t\tid={meta.id}\n\t\t\t\t\t\t\t\t\tonClick={renderProps.onClick}\n\t\t\t\t\t\t\t\t\tclassName={['button', 'link', styles.account, styles.inline].join(' ')}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{typeof meta.icon[1] === 'string' ? <img src={meta.icon[1]} alt={meta.id} className={styles.icon} /> : React.cloneElement(meta.icon[1], { className: styles.icon })}\n\t\t\t\t\t\t\t\t\tLink {meta.name || capitalise(meta.id as string)}\n\t\t\t\t\t\t\t\t\t<FaAngleRight />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} as any;\n\t\t\t\t\t\treturn <div\n\t\t\t\t\t\t\tkey={['entry', i].join(' ')}\n\t\t\t\t\t\t\tid={meta.id}\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tif (!meta.id) return;\n\t\t\t\t\t\t\t\tif (!(meta.id in links)) return;\n\t\t\t\t\t\t\t\tlet action = links[meta.id as string];\n\t\t\t\t\t\t\t\tlet { href, setWindow } = action;\n\t\t\t\t\t\t\t\tif (typeof href === 'function') (href as () => void)();\n\t\t\t\t\t\t\t\telse setWindow(window.open(href, '_blank'));\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tclassName={['button', 'link', styles.account, styles.inline].join(' ')}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{typeof meta.icon[1] === 'string' ? <img src={meta.icon[1]} alt={meta.id} className={styles.icon} /> : React.cloneElement(meta.icon[1], { className: styles.icon })}\n\t\t\t\t\t\t\t<FacebookLogin\n\t\t\t\t\t\t\t\tappId='3423958477620478'\n\t\t\t\t\t\t\t\tfields='name,email'\n\t\t\t\t\t\t\t\tscope='public_profile'\n\t\t\t\t\t\t\t\tcssClass={styles.facebookLink}\n\t\t\t\t\t\t\t\tcallback={links.facebook.href}\n\t\t\t\t\t\t\t\t{...rProps as any}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<FaAngleRight />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t}\n\t\t\t\t\treturn <div\n\t\t\t\t\t\tkey={['entry', i].join(' ')}\n\t\t\t\t\t\tid={meta.id}\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tif (!meta.id) return;\n\t\t\t\t\t\t\tif (!(meta.id in links)) return;\n\t\t\t\t\t\t\tlet action = links[meta.id as string];\n\t\t\t\t\t\t\tlet { href, setWindow } = action;\n\t\t\t\t\t\t\tif (typeof href === 'function') (href as () => void)();\n\t\t\t\t\t\t\telse setWindow(window.open(href, '_blank'));\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tclassName={['button', 'link', styles.account, styles.inline].join(' ')}\n\t\t\t\t\t>\n\t\t\t\t\t\t{typeof meta.icon[1] === 'string' ? <img src={meta.icon[1]} alt={meta.id} className={styles.icon} /> : React.cloneElement(meta.icon[1], { className: styles.icon })}\n\t\t\t\t\t\tLink {meta.name || capitalise(meta.id as string)}\n\t\t\t\t\t\t<FaAngleRight />\n\t\t\t\t\t</div>\n\t\t\t\t})}\n\t\t\t</div>\n\t\t</section>}\n\t</>)\n\n}","import React, { useCallback, useContext } from 'react';\r\nimport { StaticContext } from 'react-router';\r\nimport { RouteComponentProps } from 'react-router-dom';\r\nimport styles from './css/user.module.css';\r\nimport { ProfileData } from '../interfaces';\r\nimport { FaToggleOn, FaToggleOff } from 'react-icons/fa';\r\nimport { POST } from '../utils/requests';\r\nimport { AlertContext } from '../Contexts';\r\nimport * as regexes from '../utils/regexes';\r\n\r\nexport default function Accounts(props: RouteComponentProps<any, StaticContext, any> & {\r\n\tdirection: string\r\n\tuser: ProfileData\r\n\tupdateProfile: () => void\r\n}) {\r\n\r\n\tconst toggleTheme = useCallback(() => POST({\r\n\t\turl: '/profile/updateSetting',\r\n\t\tdata: {\r\n\t\t\ttheme: props.user.theme === 'light' ? 'dark' : 'light'\r\n\t\t}\r\n\t}).then(props.updateProfile), [props.user.theme, props.updateProfile]);\r\n\r\n\tconst updateBackground = useCallback((url: string) => POST({\r\n\t\turl: '/profile/updateSetting',\r\n\t\tdata: {\r\n\t\t\tbackgroundURL: url\r\n\t\t}\r\n\t}).then(props.updateProfile), [props.updateProfile]);\r\n\r\n\tconst setAlert = useContext(AlertContext);\r\n\r\n\treturn (\r\n\t\t<section className={['container', styles.container].join(' ')}>\r\n\t\t\t<div className={['header-button', styles.darkMode, 'switchContainer'].join(' ')}>\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t{props.user.theme === 'light' ? \r\n\t\t\t\t\t\t\t'Light Mode' :\r\n\t\t\t\t\t\t\t'Dark Mode'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</label>\r\n\t\t\t\t<div className='toggleSwitch' onClick={toggleTheme}>\r\n\t\t\t\t\t{props.user.theme === 'light' ? \r\n\t\t\t\t\t\t<FaToggleOn /> :\r\n\t\t\t\t\t\t<FaToggleOff />\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div className={['header-button', styles.darkMode, 'switchContainer'].join(' ')} onClick={() => {\r\n\t\t\t\tsetAlert({\r\n\t\t\t\t\ttitle: 'Add background image',\r\n\t\t\t\t\tmessage: 'Add a link to the background image you want to use. Leave empty to clear.',\r\n\t\t\t\t\ttype: 'prompt',\r\n\t\t\t\t\tresolve: updateBackground,\r\n\t\t\t\t\tprompt: {\r\n\t\t\t\t\t\tvalidate: (v: string | undefined) => v ? regexes.link.test(v) : true,\r\n\t\t\t\t\t\terrorMessage: 'Must be a valid link to an image',\r\n\t\t\t\t\t\tallowNull: true,\r\n\t\t\t\t\t\tdefaultValue: props.user.backgroundURL\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}}>\r\n\t\t\t\t{props.user.backgroundURL ?\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<a href={props.user.backgroundURL} target='_blank' rel='noopener noreferrer'>\r\n\t\t\t\t\t\t\tBackground set\r\n\t\t\t\t\t\t</a>{'\\u200b'} | Change\r\n\t\t\t\t\t</> :\r\n\t\t\t\t\t'Add background image'\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t</section>\r\n\t)\r\n}","import React, { ReactElement, useCallback, useState, createContext, useEffect, useMemo } from 'react';\nimport { BrowserRouter as Router, Route, Switch, Redirect } from 'react-router-dom';\nimport Tournament from './Tournament';\nimport './App.scss';\nimport NotFound from './404';\nimport { socket, GET, cookies, POST, setErrorCallback, isDev } from './utils/requests';\nimport Home from './Home';\nimport { Community } from './pages';\nimport Header from './components/Header';\nimport { isMobile } from './utils/auth';\nimport { Login } from './tournament/';\nimport { Team, User } from './user';\nimport { ProfileData, Notif } from './interfaces';\nimport { AxiosError } from 'axios';\nimport NotifBox, { AlertBox, AlertProps } from './components/NotifBox';\nimport { NotifContext, AlertContext } from './Contexts';\nimport { FaExclamationTriangle } from 'react-icons/fa';\nimport * as regexes from './utils/regexes';\n\nlet lastTime = Date.now();\n\nconst slide = ['/', 'pairings', 'standings', 'stats', 'tv', 'community', 'team','player', '@', 'login'];\nfunction handleEnter(referrer: string) {\n\tlet index = findPageIndex(referrer);\n\tlet section;\n\tif (index === 0.5) section = 'home';\n\telse if (index === 0.5) section = 'tournament';\n\telse section = slide[index];\n\tif (socket.connected) socket.emit('public_page', {\n\t\tsection,\n\t\ttournament: index > 0 && index < 5 ? referrer.split('/')[1] : referrer.split('/')[2],\n\t\ttime: (Date.now() - lastTime) / 60000,\n\t\tmobile: isMobile()\n\t});\n\tlastTime = Date.now();\n}\n\nexport const LoginContext = createContext(undefined as boolean | undefined);\n\nfunction findPageIndex(pathname: string): number {\n\tfor (let i = 0; i < slide.length; i++) {\n\t\tif (slide[i] === pathname) return i;\n\t}\n\tfor (let i = slide.length; i > 0; i--) {\n\t\tif (pathname.includes(slide[i])) return i;\n\t}\n\treturn 0.5;\n}\nfunction findIndex(pathname: string): number {\n\treturn 0;\n\tfor (let i = 0; i < slide.length; i++) {\n\t\tif (slide[i] === pathname) return i;\n\t}\n\tfor (let i = slide.length; i > 0; i--) {\n\t\tif (pathname.includes(slide[i])) return i;\n\t}\n\treturn 0.5;\n}\nfunction direction(_from: string, _to: string): string {\n\tlet res = '';\n\tlet from = findIndex(_from)\n\tlet to = findIndex(_to);\n\tif (to > from) res = 'right';\n\telse if (to < from) res = 'left';\n\tlet [nFrom, nTo] = [_from, _to].map(p => Number(p.split('/').pop() as string));\n\tif (nFrom && nTo && !isNaN(nFrom) && !isNaN(nTo)) {\n\t\tif (nTo > nFrom) res = 'right';\n\t\telse if (nFrom > nTo) res = 'left';\n\t}\n\tif (res && to >= 1 && to <= 4 && from >= 1 && to <= 4) res = 'small-' + res;\n\treturn res;\n}\n\ninterface State {\n\tdirection: string\n\treferrer: string\n\tcurrentPath: string\n}\n\nlet state: State = {\n\tdirection: '',\n\treferrer: '',\n\tcurrentPath: ''\n};\n\nfunction App(): ReactElement {\n\n\tconst [selected, select] = useState({} as Notif);\n\tconst [profile, setProfile] = useState({} as ProfileData);\n\n\tconst [session, setSession] = useState(undefined as undefined | string);\n\tconst loggedIn = useMemo(() => session === undefined ? undefined : !!session, [session]);\n\tconst endSession = useCallback(async (): Promise<void> => {\n\t\ttry {\n\t\t\tawait POST({ url: '/endSession' })\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t} finally {\n\t\t\tawait cookies.remove('sessionID');\n\t\t\tsetSession('');\n\t\t}\n\t}, [setSession]);\n\n\tuseEffect(() => {\n\t\tlet root = document.getElementById('root');\n\t\tif (!root) return;\n\t\tconsole.log(profile);\n\t\tif (profile.theme === 'dark' || profile.backgroundURL) root.className += ' dark';\n\t\telse root.className = root.className.replace(regexes.dark, '');\n\t\tif (profile.backgroundURL) root.style.backgroundImage = `url(${profile.backgroundURL})`;\n\t\telse root.style.backgroundImage = '';\n\t}, [profile]);\n\n\tconst updateProfile = useCallback(() => GET({ url: '/profile', timeout: isDev ? 50000 : 5000 })\n\t\t.then(setProfile)\n\t\t.catch(async (e: AxiosError) => {\n\t\t\tconsole.log(e, e.response);\n\t\t\tif (e.response?.status === 404) endSession();\n\t\t\telse await cookies.remove('sessionID');\n\t\t})\n\t, [setProfile, endSession]);\n\n\tconst checkSession = useCallback(async () => {\n\t\tlet c = await cookies.getAll();\n\t\tlet sessionID = c.sessionID;\n\t\t/* eslint-disable-next-line no-throw-literal */\n\t\tif (!sessionID) throw c;\n\t\tsetSession(sessionID);\n\t}, [setSession]);\n\tuseEffect(() => {\n\t\tcheckSession().catch(() => setSession(''));\n\t}, [checkSession]);\n\n\tuseEffect(() => {\n\t\tif (session) updateProfile().catch(console.error);\n\t}, [session, updateProfile]);\n\n\tconst [alertProps, setAlert] = useState({\n\t\ttitle: '',\n\t\tmessage: '' as string | JSX.Element\n\t} as AlertProps);\n\n\tuseEffect(() => {\n\t\tsetErrorCallback((title: string, message: string) => {\n\t\t\tsetAlert({\n\t\t\t\ticon: <FaExclamationTriangle />,\n\t\t\t\ttitle,\n\t\t\t\tmessage: typeof message === 'string' ? message.startsWith('<!DOCTYPE html>') ? <div dangerouslySetInnerHTML={{__html: message }} /> : message : JSON.stringify(message, null, 4),\n\t\t\t\ttype: 'error'\n\t\t\t});\n\t\t});\n\t}, [setAlert]);\n\n  \treturn <>\n      \t<Router basename={process.env.PUBLIC_URL}>\n            <Route render={({location, history}) => {\n\t\t\t\tif (state.currentPath.split('?').shift() !== location.pathname) state = Object.assign(state || {}, {\n\t\t\t\t\tdirection: direction(state.currentPath || location.pathname + location.search, location.pathname + location.search) || state.direction,\n\t\t\t\t\treferrer: state.currentPath || location.pathname + location.search,\n\t\t\t\t\tcurrentPath: location.pathname + location.search\n\t\t\t\t}) as State || {};\n\t\t\t\tlocation.state = state;\n\t\t\t\thandleEnter(state.referrer);\n                return (\n\t\t\t\t\t<AlertContext.Provider value={setAlert}>\n\t\t\t\t\t<NotifContext.Provider value={select}>\n\t\t\t\t\t<LoginContext.Provider value={loggedIn}>\n\t\t\t\t\t\t<Header setID={() => {}} profile={profile} referrer={state?.referrer} currentPath={location.pathname} />\n\t\t\t\t\t\t<Switch location={location}>\n\t\t\t\t\t\t\t<Route exact path='/' render={(props) => {\n\t\t\t\t\t\t\t\treturn <Home {...props} />\n\t\t\t\t\t\t\t}} />\n\t\t\t\t\t\t\t<Route exact path='/community' render={(props) => {\n\t\t\t\t\t\t\t\tif (loggedIn === false) return <Redirect to={{\n\t\t\t\t\t\t\t\t\tpathname: '/login',\n\t\t\t\t\t\t\t\t\tsearch: props.location.search,\n\t\t\t\t\t\t\t\t\tstate: props.history.location.state\n\t\t\t\t\t\t\t\t}}/>;\n\t\t\t\t\t\t\t\tif (!profile.username) return null;\n\t\t\t\t\t\t\t\treturn <Community {...props} />\n\t\t\t\t\t\t\t}} />\n\t\t\t\t\t\t\t<Route path='/me/' render={(props) => {\n\t\t\t\t\t\t\t\tif (loggedIn === false) return <Redirect to={{\n\t\t\t\t\t\t\t\t\tpathname: '/login',\n\t\t\t\t\t\t\t\t\tsearch: props.location.search,\n\t\t\t\t\t\t\t\t\tstate: props.history.location.state\n\t\t\t\t\t\t\t\t}}/>;\n\t\t\t\t\t\t\t\tif (!profile.username) return null;\n\t\t\t\t\t\t\t\treturn <Redirect push to={{\n\t\t\t\t\t\t\t\t\tpathname: props.location.pathname.replace('/me', '/@/' + profile.username),\n\t\t\t\t\t\t\t\t\tsearch: props.location.search,\n\t\t\t\t\t\t\t\t\tstate: props.history.location.state\n\t\t\t\t\t\t\t\t}} />;\n\t\t\t\t\t\t\t}} />\n\t\t\t\t\t\t\t<Route path='/@/:id' render={(props) => {\n\t\t\t\t\t\t\t\treturn <User {...props} id={props.match.params.id} profile={profile} updateProfile={updateProfile} endSession={endSession} />;\n\t\t\t\t\t\t\t}} />\n\t\t\t\t\t\t\t<Route path='/reset/password' render={(props) => {\n\t\t\t\t\t\t\t\treturn <Login {...props} loggedIn={loggedIn} mode='reset/password' setSession={setSession} updateProfile={updateProfile}/>;\n\t\t\t\t\t\t\t}} />\n\t\t\t\t\t\t\t<Route path='/login' render={(props) => {\n\t\t\t\t\t\t\t\tlet [pathname, search] = state.referrer.split('?');\n\t\t\t\t\t\t\t\treturn loggedIn ?\n\t\t\t\t\t\t\t\t\t<Redirect push to={{\n\t\t\t\t\t\t\t\t\t\tpathname: pathname === '/login' ? '/me' : pathname,\n\t\t\t\t\t\t\t\t\t\tsearch,\n\t\t\t\t\t\t\t\t\t\tstate: props.history.location.state\n\t\t\t\t\t\t\t\t\t}}/> :\n\t\t\t\t\t\t\t\t\t<Login {...props} loggedIn={loggedIn} mode='login' setSession={setSession} updateProfile={updateProfile}/>;\n\t\t\t\t\t\t\t}} />\n\t\t\t\t\t\t\t<Route path='/register' render={(props) => {\n\t\t\t\t\t\t\t\tlet [pathname, search] = state.referrer.split('?');\n\t\t\t\t\t\t\t\treturn loggedIn ?\n\t\t\t\t\t\t\t\t\t<Redirect push to={{\n\t\t\t\t\t\t\t\t\t\tpathname: pathname === '/login' ? '/me' : pathname,\n\t\t\t\t\t\t\t\t\t\tsearch,\n\t\t\t\t\t\t\t\t\t\tstate: props.history.location.state\n\t\t\t\t\t\t\t\t\t}}/> :\n\t\t\t\t\t\t\t\t\t<Login {...props} loggedIn={loggedIn} mode='register' setSession={setSession} updateProfile={updateProfile}/>;\n\t\t\t\t\t\t\t}} />\n\t\t\t\t\t\t\t<Route path='/player/:id/' render={(props) => {\n\t\t\t\t\t\t\t\treturn <Team {...props} id={props.match.params.id} profile={profile} type='player' />\n\t\t\t\t\t\t\t}} />\n\t\t\t\t\t\t\t<Route path='/team/:id/' render={(props) => {\n\t\t\t\t\t\t\t\treturn <Team {...props} id={props.match.params.id} profile={profile} type='team' />\n\t\t\t\t\t\t\t}} />\n\t\t\t\t\t\t\t<Route path='/tournament/:id/' render={(props) => {\n\t\t\t\t\t\t\t\treturn <Redirect push to={{\n\t\t\t\t\t\t\t\t\tpathname: state.referrer.slice('/tournament'.length).split('?')[0],\n\t\t\t\t\t\t\t\t\tsearch: state.referrer.split('?')[1],\n\t\t\t\t\t\t\t\t\tstate: props.history.location.state\n\t\t\t\t\t\t\t\t}}/>\n\t\t\t\t\t\t\t}} />\n\t\t\t\t\t\t\t<Route path='/:id/' render={(props) => {\n\t\t\t\t\t\t\t\tif (['me', '@', 'login', 'register', 'player', 'team', 'tournament', 'community'].includes(props.match.params.id)) return <Route path='*' component={NotFound} status={404} />;\n\t\t\t\t\t\t\t\treturn <Tournament {...props} />;\n\t\t\t\t\t\t\t}} />\n\t\t\t\t\t\t\t<Route path='*' component={NotFound} status={404} />\n\t\t\t\t\t\t</Switch>\t\t\t\t\t\n\t\t\t\t\t</LoginContext.Provider>\n\t\t\t\t\t</NotifContext.Provider>\n\t\t\t\t\t</AlertContext.Provider>\n                );\n            }}/>\n\t\t\t<NotifBox notif={selected} select={select}/>\n\t\t\t<AlertContext.Provider value={setAlert}>\n\t\t\t\t<AlertBox {...alertProps} />\n\t\t\t</AlertContext.Provider>\n        </Router>\n  \t</>;\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"tableAnnounce\":\"tournaments_tableAnnounce__2MLQm\",\"rowLink\":\"tournaments_rowLink__1OayQ\",\"tournamentLink\":\"tournaments_tournamentLink__3mGz7\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"canvas\":\"login_canvas__1qibW\",\"column\":\"login_column__14Kgt\",\"foreground\":\"login_foreground__2Cqo8\",\"frame\":\"login_frame__3ssmQ\",\"loginSection\":\"login_loginSection__1BBMn\",\"forgottenContainer\":\"login_forgottenContainer__2yR4y\",\"fade-in\":\"login_fade-in__3QsyL\",\"forgotten\":\"login_forgotten__3VFQz\",\"form\":\"login_form__1ieaR\",\"input\":\"login_input__3ze1R\",\"back\":\"login_back__1oP5T\",\"text\":\"login_text__WDlWF\",\"submit\":\"login_submit__2qxJT\",\"flip\":\"login_flip__2KG2q\",\"loginButton\":\"login_loginButton__1XTHr\",\"registerButton\":\"login_registerButton__1vv8o\",\"loginForeground\":\"login_loginForeground__lnGgY\",\"registerForeground\":\"login_registerForeground__3D6jX\",\"messageBar\":\"login_messageBar__6TM4O\",\"logo\":\"login_logo__UJ7Qe\",\"staticLogo\":\"login_staticLogo__Z0jZQ\",\"loadingGif\":\"login_loadingGif__WfBMg\",\"crownOutline\":\"login_crownOutline__2mObX\",\"loadingLine\":\"login_loadingLine__1iXG0\",\"grow-right\":\"login_grow-right__2HxVz\"};"],"sourceRoot":""}